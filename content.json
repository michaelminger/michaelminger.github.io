{"meta":{"title":"Michaelming's Blog","subtitle":"ä¸è§ä½ å¦‚æˆ‘ä¸€èˆ¬","description":"å¤§åœ°èŒ«èŒ«ä¸€ç‰‡çœŸå¹²å‡€","author":"Michaelming","url":"http://ailous.top"},"pages":[{"title":"about","date":"2018-09-30T09:25:30.000Z","updated":"2020-05-26T03:28:07.582Z","comments":true,"path":"about/index.html","permalink":"http://ailous.top/about/index.html","excerpt":"","text":""},{"title":"categories","date":"2020-05-12T01:56:21.000Z","updated":"2020-05-12T01:56:57.012Z","comments":false,"path":"categories/index.html","permalink":"http://ailous.top/categories/index.html","excerpt":"","text":"","keywords":null},{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2020-05-12T03:58:57.602Z","comments":false,"path":"bangumi/index.html","permalink":"http://ailous.top/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"comment/index.html","permalink":"http://ailous.top/comment/index.html","excerpt":"","text":"å¿µä¸¤å¥è¯— å™åˆ«æ¢¦ã€æ‰¬å·ä¸€è§‰ã€‚ ã€å®‹ä»£ã€‘å´æ–‡è‹±ã€Šå¤œæ¸¸å®«Â·äººå»è¥¿æ¥¼é›æ³ã€‹","keywords":"ç•™è¨€æ¿"},{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"client/index.html","permalink":"http://ailous.top/client/index.html","excerpt":"","text":"ç›´æ¥ä¸‹è½½ or æ‰«ç ä¸‹è½½ï¼š","keywords":"Androidå®¢æˆ·ç«¯"},{"title":"donate","date":"2018-12-20T15:13:05.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"donate/index.html","permalink":"http://ailous.top/donate/index.html","excerpt":"","text":"","keywords":"è°¢è°¢é¥²ä¸»äº†å–µ~"},{"title":"lab","date":"2019-01-05T13:47:59.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"lab/index.html","permalink":"http://ailous.top/lab/index.html","excerpt":"","text":"sakuraä¸»é¢˜balabala","keywords":"Labå®éªŒå®¤"},{"title":"links","date":"2018-12-19T15:11:06.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"links/index.html","permalink":"http://ailous.top/links/index.html","excerpt":"","text":"","keywords":"å‹äººå¸"},{"title":"music","date":"2018-12-20T15:14:28.000Z","updated":"2020-05-26T04:44:35.196Z","comments":false,"path":"music/index.html","permalink":"http://ailous.top/music/index.html","excerpt":"","text":"","keywords":"å–œæ¬¢çš„éŸ³ä¹"},{"title":"tags","date":"2018-12-12T14:14:16.000Z","updated":"2020-05-12T01:50:55.687Z","comments":true,"path":"tags/index.html","permalink":"http://ailous.top/tags/index.html","excerpt":"","text":""},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"rss/index.html","permalink":"http://ailous.top/rss/index.html","excerpt":"","text":""},{"title":"theme-sakura","date":"2019-01-04T14:53:25.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"theme-sakura/index.html","permalink":"http://ailous.top/theme-sakura/index.html","excerpt":"","text":"Hexoä¸»é¢˜Sakuraä¿®æ”¹è‡ªWordPressä¸»é¢˜Sakuraï¼Œæ„Ÿè°¢åŸä½œè€…Mashiro","keywords":"Hexo ä¸»é¢˜ Sakura ğŸŒ¸"},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"video/index.html","permalink":"http://ailous.top/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: 'æ”¾é€æ—¶é—´: 2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: '2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} ç•ªç»„è®¡åˆ’ è¿™é‡Œå°†æ˜¯æ°¸è¿œçš„å›å¿† window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} æ”¾é€æ—¶é—´: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"Bç«™"}],"posts":[{"title":"ç½‘ç»œçˆ¬è™«â€”â€”è¶…çº§é¹°æºç ä¸‹è½½","slug":"ç½‘ç»œçˆ¬è™«â€”â€”è¶…çº§é¹°æºç ä¸‹è½½","date":"2020-04-27T05:47:40.000Z","updated":"2020-05-27T07:45:10.095Z","comments":true,"path":"2020/04/27/wang-luo-pa-chong-chao-ji-ying-yuan-ma-xia-zai/","link":"","permalink":"http://ailous.top/2020/04/27/wang-luo-pa-chong-chao-ji-ying-yuan-ma-xia-zai/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”è¶…çº§é¹°æºç ä¸‹è½½è¶…çº§é¹°å®˜æ–¹ç½‘å€ï¼šhttps://www.chaojiying.com/å°†æ–‡ä»¶ä¸‹è½½å†è§£å‹ï¼Œè¿™é‡Œä½¿ç”¨æºç ï¼š æºç ï¼š#!/usr/bin/env python # coding:utf-8 import requests from hashlib import md5 class Chaojiying_Client(object): def __init__(self, username, password, soft_id): self.username = username password = password.encode('utf8') self.password = md5(password).hexdigest() self.soft_id = soft_id self.base_params = { 'user': self.username, 'pass2': self.password, 'softid': self.soft_id, } self.headers = { 'Connection': 'Keep-Alive', 'User-Agent': 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)', } def PostPic(self, im, codetype): \"\"\" im: å›¾ç‰‡å­—èŠ‚ codetype: é¢˜ç›®ç±»å‹ å‚è€ƒ http://www.chaojiying.com/price.html \"\"\" params = { 'codetype': codetype, } params.update(self.base_params) files = {'userfile': ('ccc.jpg', im)} r = requests.post('http://upload.chaojiying.net/Upload/Processing.php', data=params, files=files, headers=self.headers) return r.json() def ReportError(self, im_id): \"\"\" im_id:æŠ¥é”™é¢˜ç›®çš„å›¾ç‰‡ID \"\"\" params = { 'id': im_id, } params.update(self.base_params) r = requests.post('http://upload.chaojiying.net/Upload/ReportError.php', data=params, headers=self.headers) return r.json() if __name__ == '__main__': chaojiying = Chaojiying_Client('è¶…çº§é¹°ç”¨æˆ·å', 'è¶…çº§é¹°ç”¨æˆ·åçš„å¯†ç ', '96001') #ç”¨æˆ·ä¸­å¿ƒ>>è½¯ä»¶ID ç”Ÿæˆä¸€ä¸ªæ›¿æ¢ 96001 im = open('a.jpg', 'rb').read() #æœ¬åœ°å›¾ç‰‡æ–‡ä»¶è·¯å¾„ æ¥æ›¿æ¢ a.jpg æœ‰æ—¶WINç³»ç»Ÿé¡»è¦// print chaojiying.PostPic(im, 1902) #1902 éªŒè¯ç ç±»å‹ å®˜æ–¹ç½‘ç«™>>ä»·æ ¼ä½“ç³» 3.4+ç‰ˆ print åè¦åŠ () a.jpg ä¸ºè‡ªå·±ç›®æ ‡å›¾ç‰‡ è¶…çº§é¹°ç”¨æˆ·ååŠå¯†ç ã€‚éœ€è¦è‡ªå·±å»å®˜ç½‘æ³¨å†Œä½¿ç”¨ã€‚ å…·ä½“ä½¿ç”¨æ–¹æ³•åˆ°æˆ‘çš„åç»§åšå®¢ä¸­æŸ¥æ‰¾ã€‚","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"è¶…çº§é¹°","slug":"è¶…çº§é¹°","permalink":"http://ailous.top/tags/è¶…çº§é¹°/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"æ±‡ç¼–é¢˜â€”â€”CJNE","slug":"æ±‡ç¼–é¢˜â€”â€”CJNE","date":"2020-02-20T05:47:40.000Z","updated":"2020-05-26T03:50:23.413Z","comments":true,"path":"2020/02/20/hui-bian-ti-cjne/","link":"","permalink":"http://ailous.top/2020/02/20/hui-bian-ti-cjne/","excerpt":"","text":"æ±‡ç¼–é¢˜â€”â€”CJNE","categories":[{"name":"æ±‡ç¼–","slug":"æ±‡ç¼–","permalink":"http://ailous.top/categories/æ±‡ç¼–/"}],"tags":[{"name":"CJNE","slug":"CJNE","permalink":"http://ailous.top/tags/CJNE/"},{"name":"DJNE","slug":"DJNE","permalink":"http://ailous.top/tags/DJNE/"}],"keywords":[{"name":"æ±‡ç¼–","slug":"æ±‡ç¼–","permalink":"http://ailous.top/categories/æ±‡ç¼–/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”å‰ç¨‹æ— å¿§ç½‘æ•°æ®è·å–åŠå­˜å‚¨ï¼ˆé«˜çº§ï¼‰","slug":"ç½‘ç»œçˆ¬è™«â€”â€”å‰ç¨‹æ— å¿§ç½‘æ•°æ®è·å–åŠå­˜å‚¨(é«˜çº§)","date":"2019-09-03T05:47:40.000Z","updated":"2020-05-27T07:44:29.765Z","comments":true,"path":"2019/09/03/wang-luo-pa-chong-qian-cheng-wu-you-wang-shu-ju-huo-qu-ji-cun-chu-gao-ji/","link":"","permalink":"http://ailous.top/2019/09/03/wang-luo-pa-chong-qian-cheng-wu-you-wang-shu-ju-huo-qu-ji-cun-chu-gao-ji/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”å‰ç¨‹æ— å¿§ç½‘æ•°æ®è·å–åŠå­˜å‚¨ï¼ˆé«˜çº§ï¼‰å®éªŒå†…å®¹1ç›®æ ‡ç½‘ç«™ï¼šå‰ç¨‹æ— å¿§æ‹›è˜ç½‘ ç›®æ ‡ç½‘å€ï¼šhttps://search.51job.com/list/120000,000000,0000,00,9,99,Python,2,1.html ç›®æ ‡æ•°æ®ï¼šï¼ˆ1ï¼‰èŒä½åï¼ˆ2ï¼‰å…¬å¸åï¼ˆ3ï¼‰å·¥ä½œåœ°ç‚¹ï¼ˆ4ï¼‰è–ªèµ„ ï¼ˆ5ï¼‰å‘å¸ƒæ—¶é—´ è¦æ±‚ ï¼ˆ1ï¼‰ä½¿ç”¨urllibæˆ–requestsåº“å®ç°è¯¥ç½‘ç«™ç½‘é¡µæºä»£ç çš„è·å–ï¼Œå¹¶å°†æºä»£ç è¿›è¡Œä¿å­˜ï¼› ï¼ˆ2ï¼‰è‡ªä¸»é€‰æ‹©reã€bs4ã€lxmlä¸­çš„ä¸€ç§è§£ææ–¹æ³•å¯¹ä¿å­˜çš„çš„æºä»£ç è¯»å–å¹¶è¿›è¡Œè§£æï¼ŒæˆåŠŸæ‰¾åˆ°ç›®æ ‡æ•°æ®æ‰€åœ¨çš„ç‰¹å®šæ ‡ç­¾ï¼Œè¿›è¡Œç½‘é¡µç»“æ„çš„è§£æï¼› ï¼ˆ3ï¼‰å®šä¹‰å‡½æ•°ï¼Œå°†è·å–çš„ç›®æ ‡æ•°æ®ä¿å­˜åˆ°txtï¼Œcsvæ–‡ä»¶ä¸­ã€‚ ï¼ˆ4ï¼‰ä½¿ç”¨æ¡†æ¶å¼ç»“æ„ï¼Œé€šè¿‡å‚æ•°ä¼ é€’å®ç°æ•´ä¸ªç‰¹å®šæ•°æ®çš„çˆ¬å–ã€‚ æºç import requests import json import csv from requests.exceptions import RequestException from lxml import etree def getHtmlText(url): headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return \"\" def parsePage(html): ulist = [] clist = [] rlist = [] newhtml =etree.HTML(html,etree.HTMLParser()) result=newhtml.xpath('//*[@id=\"resultList\"]/div[@class=\"el\"]//text()') for i in range(len(result)): ulist.append(result[i].replace(\" \",\"\").replace('\\r',\"\").replace(\"\\n\",'')) while '' in ulist: ulist.remove('') length = len(ulist) weight = int(length / 5 ) for i in range(weight): for j in range(5): clist.append(ulist[i*5+j]) rlist.append(clist) clist = [] return rlist # def txtdata(data): # with open('top20.txt','w')as file: # for i in data: # for j in i: # print(j) # print('successful') def storedata(data): with open('top20.txt','w',encoding = 'utf-8')as file: for i in data: file.write(json.dumps(i,ensure_ascii=False)+'\\n') print('ok') def csvdata(data): with open('top20.csv','w',encoding = 'utf-8',newline='')as csvfile: fieldnames = ['èŒä½å','å…¬å¸å','å·¥ä½œåœ°ç‚¹','è–ªèµ„','å·¥ä½œæ—¶é—´'] writer = csv.DictWriter(csvfile,fieldnames=fieldnames) writer.writeheader() for i in data: writer.writerow({'èŒä½å':i[0],'å…¬å¸å':i[1],'å·¥ä½œåœ°ç‚¹':i[2],'è–ªèµ„':i[3],'å·¥ä½œæ—¶é—´':i[4]}) print('ok') def main(): url=\"https://search.51job.com/list/120000,000000,0000,00,9,99,Python,2,1.html\" html=getHtmlText(url) rlist=parsePage(html) # txtdata(data) storedata(rlist) csvdata(rlist) main() ç»“æœè¾“å‡ºï¼š","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"Xpath","slug":"Xpath","permalink":"http://ailous.top/tags/Xpath/"},{"name":"CSV","slug":"CSV","permalink":"http://ailous.top/tags/CSV/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ç½‘ç»œçˆ¬è™«å¸¸è§é—®é¢˜æ±‡æ€»","slug":"ç½‘ç»œçˆ¬è™«å¸¸è§é—®é¢˜æ±‡æ€»","date":"2019-06-02T05:47:40.000Z","updated":"2020-05-26T03:51:28.641Z","comments":true,"path":"2019/06/02/wang-luo-pa-chong-chang-jian-wen-ti-hui-zong/","link":"","permalink":"http://ailous.top/2019/06/02/wang-luo-pa-chong-chang-jian-wen-ti-hui-zong/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«å¸¸è§é—®é¢˜æ±‡æ€»é—®é¢˜ä¸€ï¼šä½¿ç”¨requestsåº“æˆ–è€…urllibåº“è·å–æºä»£ç æ—¶æ— æ³•æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡è§£å†³æ–¹æ³•ï¼š ï¼ˆ1ï¼‰requestsåº“çš„æ–‡æœ¬ä¸­æœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ç§æ˜¯æ–‡æœ¬ç±»å‹ï¼Œä½¿ç”¨textå±æ€§ï¼Œä¸€ç§æ˜¯é’ˆå¯¹éŸ³é¢‘ã€è§†é¢‘ã€å›¾ç‰‡ç­‰äºŒè¿›åˆ¶æ•°æ®ç±»å‹ï¼Œä½¿ç”¨contentå±æ€§ï¼›ä¸€èˆ¬è¿”å›çš„æ˜¯textå±æ€§æ—¶ä¼šå‡ºç°ä¸­æ–‡ä¹±ç ç°è±¡ï¼Œå› æ­¤åœ¨è¾“å‡ºè¿”å›ä¹‹å‰éœ€è¦æ˜¾ç¤ºçš„ä¿®æ”¹å±æ€§encodingï¼Œå°†å…¶èµ‹å€¼ä¸ºâ€œutf-8â€æˆ–è€…æ˜¯apparent_encodingå³å¯ã€‚ ï¼ˆ2ï¼‰urllibåº“çš„æ–‡æœ¬åªæœ‰ä¸€ç§å°±æ˜¯ä½¿ç”¨read()æ–¹æ³•è¿›è¡Œè¯»å–ã€‚å› æ­¤è¦è§£å†³ä¸­æ–‡é—®é¢˜ï¼Œä¸€å®šè¦åœ¨è¯»å–ååŠ å…¥.decode(â€œutf-8â€)ï¼Œè¿›è¡Œæ˜¾ç¤ºçš„è½¬ç ä¹‹åä¾¿ä¸ä¼šå‡ºç°ä¹±ç é—®é¢˜äº†ã€‚ é—®é¢˜äºŒï¼šæ–‡æœ¬èŠ‚ç‚¹é¦–å…ˆçœ‹ä¸¤ä¸ªHTMLä»£ç : è¿™æ˜¯ä½ çœ¼ä¸­çš„HTMLä»£ç è¿™æ˜¯è®¡ç®—æœºçœ¼ä¸­çš„HTMLä»£ç :è§£å†³æ–¹æ³•ï¼š åœ¨BS4ä¸­, æˆ‘ä»¬åœ¨HTMLä¸­çœ‹åˆ°çš„æ¢è¡Œç¬¦ä»¥åŠç©ºæ ¼éƒ½æ˜¯NavigableString ä¹Ÿå°±æ˜¯æ–‡æœ¬èŠ‚ç‚¹. é—®é¢˜ä¸‰ï¼šæ»¥ç”¨éå†æ–‡æ¡£æ ‘çš„æ–¹æ³•å¸¸è§çš„æ–¹æ³•æœ‰: contentsdescendantsparentnext_siblingnext_element è¿™äº›æ–¹æ³•éƒ½ä¼šéå†æ–‡æ¡£æ ‘ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹, åŒ…æ‹¬æ–‡æœ¬èŠ‚ç‚¹. ä¹Ÿå°±æ˜¯è¯´: åªè¦ä½ ä½¿ç”¨è¿™äº›æ–¹æ³•, ä½ å°±ä¸€å®šä¼šé€‰æ‹©å‡ºè®¸å¤šæ–‡æœ¬èŠ‚ç‚¹, å› ä¸ºæ–‡æœ¬èŠ‚ç‚¹æ— å¤„ä¸åœ¨: æ¢è¡Œ, ç©ºæ ¼ç­‰. è§£å†³æ–¹æ³•ï¼š ä½¿ç”¨è¿‡æ»¤å™¨findç­‰æ–¹æ³•: soup.find(name=â€™tagnameâ€™)å½“æˆ‘ä»¬ä¸€æ—¦åœ¨è¿‡æ»¤å™¨ä¸­æŒ‡å®šäº†nameå…³é”®å­—, é‚£ä¹ˆè¿”å›çš„ç»“æœå°±ä¸€å®šæ˜¯tagå¯¹è±¡, å› ä¸ºæ–‡æ¡£èŠ‚ç‚¹æ²¡æœ‰nameå±æ€§. ç»“è®º: å¤§å¤šæ•°æƒ…å†µä¸‹, ä½ éœ€è¦çš„æ˜¯find è¿™ä¸€ç±»è¿‡æ»¤å™¨, è€Œä¸æ˜¯éå†æ‰€æœ‰èŠ‚ç‚¹. é—®é¢˜å››ï¼šhtml.parserhtml.parseræ˜¯ä¸ªä»¤äººåˆæ¨åˆçˆ±çš„è§£æå™¨, å®ƒæ˜¯Pythonå†…ç½®çš„è§£æå™¨, å¼€ç®±å³ç”¨. ä½†æ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹, å®ƒè§£æå‡ºæ¥çš„æ–‡æ¡£ä¼šä¸¢å¤±ä¿¡æ¯. è§£å†³æ–¹æ³•ï¼š å¦‚æœä½ å‘ç°ä½ çš„æ–‡æ¡£ä¿¡æ¯ç¼ºå°‘äº†, é‚£ä¹ˆè¯•ç€æ¢å…¶ä»–è§£æå™¨,ä¾‹å¦‚: lxml","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"é—®é¢˜","slug":"é—®é¢˜","permalink":"http://ailous.top/tags/é—®é¢˜/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”å‰ç¨‹æ— å¿§ç½‘æ•°æ®è·å–åŠMYSQLå­˜å‚¨","slug":"ç½‘ç»œçˆ¬è™«â€”â€”å‰ç¨‹æ— å¿§ç½‘æ•°æ®è·å–åŠMYSQLå­˜å‚¨","date":"2019-05-27T05:47:40.000Z","updated":"2020-05-27T07:44:27.164Z","comments":true,"path":"2019/05/27/wang-luo-pa-chong-qian-cheng-wu-you-wang-shu-ju-huo-qu-ji-mysql-cun-chu/","link":"","permalink":"http://ailous.top/2019/05/27/wang-luo-pa-chong-qian-cheng-wu-you-wang-shu-ju-huo-qu-ji-mysql-cun-chu/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”å‰ç¨‹æ— å¿§ç½‘æ•°æ®è·å–åŠMYSQLå­˜å‚¨å®éªŒå†…å®¹1ç›®æ ‡ç½‘ç«™ï¼šå‰ç¨‹æ— å¿§æ‹›è˜ç½‘ ç›®æ ‡ç½‘å€ï¼šhttps://search.51job.com/list/120000,000000,0000,00,9,99,Python,2,1.html ç›®æ ‡æ•°æ®ï¼šï¼ˆ1ï¼‰èŒä½åï¼ˆ2ï¼‰å…¬å¸åï¼ˆ3ï¼‰å·¥ä½œåœ°ç‚¹ï¼ˆ4ï¼‰è–ªèµ„ ï¼ˆ5ï¼‰å‘å¸ƒæ—¶é—´ è¦æ±‚ ï¼ˆ1ï¼‰ä½¿ç”¨urllibæˆ–requestsåº“å®ç°è¯¥ç½‘ç«™ç½‘é¡µæºä»£ç çš„è·å–ï¼Œå¹¶å°†æºä»£ç è¿›è¡Œä¿å­˜ï¼› ï¼ˆ2ï¼‰è‡ªä¸»é€‰æ‹©reã€bs4ã€lxmlä¸­çš„ä¸€ç§è§£ææ–¹æ³•å¯¹ä¿å­˜çš„çš„æºä»£ç è¯»å–å¹¶è¿›è¡Œè§£æï¼ŒæˆåŠŸæ‰¾åˆ°ç›®æ ‡æ•°æ®æ‰€åœ¨çš„ç‰¹å®šæ ‡ç­¾ï¼Œè¿›è¡Œç½‘é¡µç»“æ„çš„è§£æï¼› ï¼ˆ3ï¼‰å®šä¹‰å‡½æ•°ï¼Œå°†è·å–çš„ç›®æ ‡æ•°æ®ä¿å­˜åˆ°MYSQLåº“æ–‡ä»¶ä¸­ã€‚ ï¼ˆ4ï¼‰ä½¿ç”¨æ¡†æ¶å¼ç»“æ„ï¼Œé€šè¿‡å‚æ•°ä¼ é€’å®ç°æ•´ä¸ªç‰¹å®šæ•°æ®çš„çˆ¬å–ã€‚ æºç import requests import json import csv from requests.exceptions import RequestException from lxml import etree import pymysql from PIL import Image import pytesseract import traceback def connectMysql(): return pymysql.connect(host='localhost',user='root',password='123456',port=3306,db='spiders') def createMysqlTable(): db = connectMysql() cursor = db.cursor() # ï¼ˆ1ï¼‰èŒä½åï¼ˆ2ï¼‰å…¬å¸åï¼ˆ3ï¼‰å·¥ä½œåœ°ç‚¹ï¼ˆ4ï¼‰è–ªèµ„ ï¼ˆ5ï¼‰å‘å¸ƒæ—¶é—´ sql = 'create table if not exists proStr (\\ èŒä½å varchar(255) not null ,\\ å…¬å¸å varchar(255) not null,\\ å·¥ä½œåœ°ç‚¹ varchar(255) not null,\\ è–ªèµ„ varchar(255) not null,\\ å‘å¸ƒæ—¶é—´ varchar(255) not null,\\ primary key(èŒä½å))' cursor.execute(sql) print('ok') db.close() def getHtmlText(url): headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return \"\" def parsePage(html): ulist = [] clist = [] rlist = [] ilist = [] newhtml =etree.HTML(html,etree.HTMLParser()) result=newhtml.xpath('//*[@id=\"content\"]/div[2]/table/tbody/tr/td//text()') imgs = newhtml.xpath('//*[@id=\"content\"]/div[2]/table/tbody/tr/td/a/img/@src', stream=True) j = 0 for img in imgs: j=j+1 with open(str(j)+'.png', 'wb') as fd: picture=requests.get(img).content fd.write(picture) for i in range(len(imgs)): str_ = str(i+1)+'.png' text = pytesseract.image_to_string(Image.open(str_)) ilist.append(text.replace(\" \",\".\").replace(\"M\",\"äº¿\").replace(\"a\",\"äº¿\")) # print(ilist) for i in range(len(result)): ulist.append(result[i].replace(\" \",\"\").replace('\\r',\"\").replace(\"\\n\",'')) while '' in ulist: ulist.remove('') length = len(ulist) weight = int(length / 8 ) for i in range(weight): for j in range(8): clist.append(ulist[i*8+j]) clist.append(ilist[i]) rlist.append(clist) clist = [] return rlist def mysqlData(datas): table = 'movies' keys = 'åæ¬¡,ç”µå½±åç§°,æ—¥æœŸ,æ€»åœºæ¬¡,åºŸåœº,äººæ¬¡,ä¸Šåº§ç‡,ç¥¨ä»·,ç¥¨æˆ¿' db = connectMysql() cursor = db.cursor() for data in datas: values = ','.join(['%s']*len(data)) sql = 'INSERT INTO {table}({keys}) VALUES({values})'.format(table=table,keys = keys ,values = values) print(sql) print(tuple(data)) try : if cursor.execute(sql, tuple(data)): print(\"Succcessful\") db.commit() except: traceback.print_exc() print(\"Failed\") db.rollback() db.close() def main(): createMysqlTable() url=\"http://58921.com/daily/wangpiao\" html=getHtmlText(url) rlist=parsePage(html) mysqlData(rlist) main() ç»“æœè¾“å‡ºæ•ˆæœï¼š","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"å‰ç¨‹æ— å¿§","slug":"å‰ç¨‹æ— å¿§","permalink":"http://ailous.top/tags/å‰ç¨‹æ— å¿§/"},{"name":"MYSQL","slug":"MYSQL","permalink":"http://ailous.top/tags/MYSQL/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”äºŒæ‰‹æˆ¿æ•°æ®æŠ“å–åŠMYSQLå­˜å‚¨","slug":"ç½‘ç»œçˆ¬è™«â€”â€”äºŒæ‰‹æˆ¿æ•°æ®æŠ“å–åŠMYSQLå­˜å‚¨","date":"2019-05-27T05:47:40.000Z","updated":"2020-05-27T07:44:23.872Z","comments":true,"path":"2019/05/27/wang-luo-pa-chong-er-shou-fang-shu-ju-zhua-qu-ji-mysql-cun-chu/","link":"","permalink":"http://ailous.top/2019/05/27/wang-luo-pa-chong-er-shou-fang-shu-ju-zhua-qu-ji-mysql-cun-chu/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”äºŒæ‰‹æˆ¿æ•°æ®æŠ“å–åŠMYSQLå­˜å‚¨ç›®æ ‡ç½‘å€ï¼šhttps://qd.anjuke.com/sale/jiaozhoushi/?from=SearchBar ç›®æ ‡æ•°æ®ï¼š æ ‡é¢˜ + é“¾æ¥åœ°å€ + å…å®¤+ é¢ç§¯+ å±‚æ•°+å»ºé€ æ—¶é—´ + åœ°å€ + å•ä»·ï¼ˆæˆ–æ€»ä»·ï¼‰ è¦æ±‚ï¼š ï¼ˆ1ï¼‰è‡ªé€‰è¯·æ±‚åº“å’Œè§£æåº“è·å–ç›®æ ‡æ•°æ®ï¼› ï¼ˆ2ï¼‰ç¬¬ä¸€ä¸ªå­˜å‚¨è‡³txtæˆ–è€…csvä¸­ï¼Œç¬¬äºŒä¸ªæºç å­˜å‚¨è‡³Mysqlä¸­ã€‚ æºç ï¼ˆ1ï¼‰ï¼šcsv,txtimport requests import json import csv from requests.exceptions import RequestException from lxml import etree def getHtmlText(url): headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return \"\" def cleanData(clist): olist = [] for i in range(len(clist)): olist.append(clist[i].replace(\" \",\"\").replace('\\r',\"\").replace(\"\\n\",'').replace(\"\\xa0\\xa0\",',')) return olist def parsePage(html): ulist = [] clist = [] newhtml =etree.HTML(html,etree.HTMLParser()) titles =cleanData(newhtml.xpath('//*[@id=\"houselist-mod-new\"]/li/div[2]/div/a//text()')) hrefs = cleanData(newhtml.xpath('//*[@id=\"houselist-mod-new\"]/li/div[2]/div/a//@href', stream=True)) others =cleanData(newhtml.xpath('//*[@id=\"houselist-mod-new\"]/li/div[2]/div[2]/span//text()')) addresss =cleanData(newhtml.xpath('//*[@id=\"houselist-mod-new\"]/li/div[2]/div[3]/span//text()')) prices =cleanData(newhtml.xpath('//*[@id=\"houselist-mod-new\"]/li/div[3]/span[2]//text()')) length = len(titles) for i in range(length): ulist.append(titles[i]) ulist.append(hrefs[i]) ulist.append(others[i*4+0]) ulist.append(others[i*4+1]) ulist.append(others[i*4+2]) ulist.append(others[i*4+3]) ulist.append(addresss[i]) ulist.append(prices[i]) clist.append(ulist) ulist = [] return clist def txtdata(data): with open('data.txt','w')as file: for i in data: for j in i: print(j) print('successful') def storedata(data): with open('data.txt','w',encoding = 'utf-8')as file: for i in data: file.write(json.dumps(i,ensure_ascii=False)+'\\n') print('ok') def csvdata(data): with open('data.csv','w',encoding = 'utf-8',newline='')as csvfile: fieldnames = ['æ ‡é¢˜','é“¾æ¥åœ°å€','å…å®¤','é¢ç§¯','å±‚æ•°','å»ºé€ æ—¶é—´','åœ°å€','å•ä»·'] writer = csv.DictWriter(csvfile,fieldnames=fieldnames) writer.writeheader() for i in data: writer.writerow({'æ ‡é¢˜':i[0],'é“¾æ¥åœ°å€':i[1],'å…å®¤':i[2],'é¢ç§¯':i[3],'å±‚æ•°':i[4],'å»ºé€ æ—¶é—´':i[5],'åœ°å€':i[6],'å•ä»·':i[7]}) print('ok') def main(): url=\"https://qd.anjuke.com/sale/jiaozhoushi/?from=SearchBar\" html=getHtmlText(url) rlist=parsePage(html) txtdata(rlist) storedata(rlist) csvdata(rlist) main() æºç ï¼ˆ1ï¼‰ï¼šMYSQLimport requests import json import csv from requests.exceptions import RequestException from lxml import etree import pymysql import pytesseract import traceback def connectMysql(): return pymysql.connect(host=&#39;localhost&#39;,user=&#39;root&#39;,password=&#39;123456&#39;,port=3306,db=&#39;spiders&#39;) def createMysqlTable(): db = connectMysql() cursor = db.cursor() sql = &#39;create table if not exists data (\\ æ ‡é¢˜ varchar(255) not null ,\\ é“¾æ¥åœ°å€ varchar(255) not null ,\\ å…å®¤ varchar(255) not null,\\ é¢ç§¯ varchar(255) not null,\\ å±‚æ•° varchar(255) not null,\\ å»ºé€ æ—¶é—´ varchar(255) not null,\\ åœ°å€ varchar(255) not null,\\ å•ä»· varchar(255) not null,\\ primary key(æ ‡é¢˜))&#39; cursor.execute(sql) print(&#39;ok&#39;) db.close() def getHtmlText(url): headers = { &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69&#39; } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return &quot;&quot; def cleanData(clist): olist = [] for i in range(len(clist)): olist.append(clist[i].replace(&quot; &quot;,&quot;&quot;).replace(&#39;\\r&#39;,&quot;&quot;).replace(&quot;\\n&quot;,&#39;&#39;).replace(&quot;\\xa0\\xa0&quot;,&#39;,&#39;)) return olist def parsePage(html): ulist = [] clist = [] newhtml =etree.HTML(html,etree.HTMLParser()) titles =cleanData(newhtml.xpath(&#39;//*[@id=&quot;houselist-mod-new&quot;]/li/div[2]/div/a//text()&#39;)) hrefs = cleanData(newhtml.xpath(&#39;//*[@id=&quot;houselist-mod-new&quot;]/li/div[2]/div/a//@href&#39;, stream=True)) others =cleanData(newhtml.xpath(&#39;//*[@id=&quot;houselist-mod-new&quot;]/li/div[2]/div[2]/span//text()&#39;)) addresss =cleanData(newhtml.xpath(&#39;//*[@id=&quot;houselist-mod-new&quot;]/li/div[2]/div[3]/span//text()&#39;)) prices =cleanData(newhtml.xpath(&#39;//*[@id=&quot;houselist-mod-new&quot;]/li/div[3]/span[2]//text()&#39;)) length = len(titles) for i in range(length): ulist.append(titles[i]) ulist.append(hrefs[i][0:100]) ulist.append(others[i*4+0]) ulist.append(others[i*4+1]) ulist.append(others[i*4+2]) ulist.append(others[i*4+3]) ulist.append(addresss[i]) ulist.append(prices[i]) clist.append(ulist) ulist = [] return clist def txtdata(data): with open(&#39;data.txt&#39;,&#39;w&#39;)as file: for i in data: for j in i: print(j) print(&#39;successful&#39;) def storedata(data): with open(&#39;data.txt&#39;,&#39;w&#39;,encoding = &#39;utf-8&#39;)as file: for i in data: file.write(json.dumps(i,ensure_ascii=False)+&#39;\\n&#39;) print(&#39;ok&#39;) def csvdata(data): with open(&#39;data.csv&#39;,&#39;w&#39;,encoding = &#39;utf-8&#39;,newline=&#39;&#39;)as csvfile: fieldnames = [&#39;æ ‡é¢˜&#39;,&#39;é“¾æ¥åœ°å€&#39;,&#39;å…å®¤&#39;,&#39;é¢ç§¯&#39;,&#39;å±‚æ•°&#39;,&#39;å»ºé€ æ—¶é—´&#39;,&#39;åœ°å€&#39;,&#39;å•ä»·&#39;] writer = csv.DictWriter(csvfile,fieldnames=fieldnames) writer.writeheader() for i in data: writer.writerow({&#39;æ ‡é¢˜&#39;:i[0],&#39;é“¾æ¥åœ°å€&#39;:i[1],&#39;å…å®¤&#39;:i[2],&#39;é¢ç§¯&#39;:i[3],&#39;å±‚æ•°&#39;:i[4],&#39;å»ºé€ æ—¶é—´&#39;:i[5],&#39;åœ°å€&#39;:i[6],&#39;å•ä»·&#39;:i[7]}) print(&#39;ok&#39;) def mysqlData(datas): table = &#39;data&#39; keys = &#39;æ ‡é¢˜,é“¾æ¥åœ°å€,å…å®¤,é¢ç§¯,å±‚æ•°,å»ºé€ æ—¶é—´,åœ°å€,å•ä»·&#39; db = connectMysql() cursor = db.cursor() for data in datas: values = &#39;,&#39;.join([&#39;%s&#39;]*len(data)) sql = &#39;INSERT INTO {table}({keys}) VALUES({values})&#39;.format(table=table,keys = keys ,values = values) print(sql) print(tuple(data)) try : if cursor.execute(sql, tuple(data)): print(&quot;Succcessful&quot;) db.commit() except: traceback.print_exc() print(&quot;Failed&quot;) db.rollback() db.close() def main(): # createMysqlTable() url=&quot;https://qd.anjuke.com/sale/jiaozhoushi/?from=SearchBar&quot; html=getHtmlText(url) rlist=parsePage(html) # txtdata(rlist) storedata(rlist) csvdata(rlist) mysqlData(rlist) main()","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"MYSQL","slug":"MYSQL","permalink":"http://ailous.top/tags/MYSQL/"},{"name":"äºŒæ‰‹æˆ¿","slug":"äºŒæ‰‹æˆ¿","permalink":"http://ailous.top/tags/äºŒæ‰‹æˆ¿/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”ç¥¨æˆ¿ç½‘æ•°æ®æŠ“å–åŠå­˜å‚¨ï¼ˆåˆçº§ï¼‰","slug":"ç½‘ç»œçˆ¬è™«â€”â€”ç¥¨æˆ¿ç½‘æ•°æ®æŠ“å–åŠå­˜å‚¨","date":"2019-05-27T05:47:40.000Z","updated":"2020-05-27T07:44:49.326Z","comments":true,"path":"2019/05/27/wang-luo-pa-chong-piao-fang-wang-shu-ju-zhua-qu-ji-cun-chu/","link":"","permalink":"http://ailous.top/2019/05/27/wang-luo-pa-chong-piao-fang-wang-shu-ju-zhua-qu-ji-cun-chu/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”ç¥¨æˆ¿ç½‘æ•°æ®æŠ“å–åŠå­˜å‚¨å®éªŒå†…å®¹ç›®æ ‡ç½‘ç«™ï¼šç”µå½±ç¥¨æˆ¿ç½‘ ç›®æ ‡ç½‘å€ï¼šhttp://58921.com/daily/wangpiao ä»»åŠ¡è¦æ±‚ç›®æ ‡æ•°æ®ï¼šï¼ˆ1ï¼‰åæ¬¡ï¼ˆ2ï¼‰ç”µå½±åç§° ï¼ˆ3ï¼‰æ—¥æœŸï¼ˆ4ï¼‰ç¥¨æˆ¿ ï¼ˆ5ï¼‰æ€»åœºæ¬¡ï¼ˆ6ï¼‰åºŸåœºï¼ˆ7ï¼‰äººæ¬¡ï¼ˆ8ï¼‰ä¸Šåº§ç‡ï¼ˆ9ï¼‰ç¥¨ä»· ï¼ˆ1ï¼‰ä½¿ç”¨urllibæˆ–requestsåº“å®ç°è¯¥ç½‘ç«™ç½‘é¡µæºä»£ç çš„è·å–ï¼Œå¹¶å°†æºä»£ç è¿›è¡Œä¿å­˜ï¼› ï¼ˆ2ï¼‰è‡ªä¸»é€‰æ‹©reã€bs4ã€lxmlä¸­çš„ä¸€ç§è§£ææ–¹æ³•å¯¹ä¿å­˜çš„çš„æºä»£ç è¯»å–å¹¶è¿›è¡Œè§£æï¼ŒæˆåŠŸæ‰¾åˆ°ç›®æ ‡æ•°æ®æ‰€åœ¨çš„ç‰¹å®šæ ‡ç­¾ï¼Œè¿›è¡Œç½‘é¡µç»“æ„çš„è§£æï¼› ï¼ˆ3ï¼‰å®šä¹‰å‡½æ•°ï¼Œå°†è·å–çš„ç›®æ ‡æ•°æ®ä¿å­˜åˆ°csvæ–‡ä»¶ä¸­ã€‚ ï¼ˆ4ï¼‰ä½¿ç”¨æ¡†æ¶å¼ç»“æ„ï¼Œé€šè¿‡å‚æ•°ä¼ é€’å®ç°æ•´ä¸ªç‰¹å®šæ•°æ®çš„çˆ¬å–ã€‚ æºç import requests import json import csv from requests.exceptions import RequestException from lxml import etree def getHtmlText(url): headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return \"\" def parsePage(html): ulist = [] clist = [] rlist = [] ilist = [] newhtml =etree.HTML(html,etree.HTMLParser()) result=newhtml.xpath('//*[@id=\"content\"]/div[2]/table/tbody/tr/td//text()') imgs = newhtml.xpath('//*[@id=\"content\"]/div[2]/table/tbody/tr/td/a/img/@src', stream=True) j = 0 for img in imgs: j=j+1 with open(str(j)+'.png', 'wb') as fd: picture=requests.get(img).content fd.write(picture) for i in range(len(imgs)): str_ = str(i+1)+'.png' text = pytesseract.image_to_string(Image.open(str_)) ilist.append(text.replace(\" \",\".\").replace(\"M\",\"äº¿\").replace(\"a\",\"äº¿\")) # print(ilist) for i in range(len(result)): ulist.append(result[i].replace(\" \",\"\").replace('\\r',\"\").replace(\"\\n\",'')) while '' in ulist: ulist.remove('') length = len(ulist) weight = int(length / 8 ) for i in range(weight): for j in range(8): clist.append(ulist[i*8+j]) clist.append(ilist[i]) rlist.append(clist) clist = [] return rlist # def txtdata(data): # with open('top20.txt','w')as file: # for i in data: # for j in i: # print(j) # print('successful') def storedata(data): with open('top20.txt','w',encoding = 'utf-8')as file: for i in data: file.write(json.dumps(i,ensure_ascii=False)+'\\n') print('ok') def csvdata(data): with open('top20.csv','w',encoding = 'utf-8',newline='')as csvfile: fieldnames = ['åæ¬¡','ç”µå½±åç§°','æ—¥æœŸ','ç¥¨æˆ¿','æ€»åœºæ¬¡','åºŸåœº','äººæ¬¡','ä¸Šåº§ç‡','ç¥¨ä»·ï¼ˆå…ƒï¼‰'] writer = csv.DictWriter(csvfile,fieldnames=fieldnames) writer.writeheader() for i in data: writer.writerow({'åæ¬¡':i[0],'ç”µå½±åç§°':i[1],'æ—¥æœŸ':i[2],'ç¥¨æˆ¿':i[8],'æ€»åœºæ¬¡':i[3],'åºŸåœº':i[4],'äººæ¬¡':i[5],'ä¸Šåº§ç‡':i[6],'ç¥¨ä»·ï¼ˆå…ƒï¼‰':i[7]}) print('ok') def main(): url=\"http://58921.com/daily/wangpiao\" html=getHtmlText(url) rlist=parsePage(html) # txtdata(rlist) storedata(rlist) csvdata(rlist) main() ç»“æœè¾“å‡ºï¼š","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"ç¥¨æˆ¿","slug":"ç¥¨æˆ¿","permalink":"http://ailous.top/tags/ç¥¨æˆ¿/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”ç¥¨æˆ¿ç½‘æ•°æ®æŠ“å–åŠMYSQLå­˜å‚¨","slug":"ç½‘ç»œçˆ¬è™«â€”â€”ç¥¨æˆ¿ç½‘æ•°æ®æŠ“å–åŠMYSQLå­˜å‚¨","date":"2019-05-27T05:47:40.000Z","updated":"2020-05-27T07:44:46.488Z","comments":true,"path":"2019/05/27/wang-luo-pa-chong-piao-fang-wang-shu-ju-zhua-qu-ji-mysql-cun-chu/","link":"","permalink":"http://ailous.top/2019/05/27/wang-luo-pa-chong-piao-fang-wang-shu-ju-zhua-qu-ji-mysql-cun-chu/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”ç¥¨æˆ¿ç½‘æ•°æ®æŠ“å–åŠMYSQLå­˜å‚¨å®éªŒå†…å®¹ç›®æ ‡ç½‘ç«™ï¼šç”µå½±ç¥¨æˆ¿ç½‘ ç›®æ ‡ç½‘å€ï¼šhttp://58921.com/daily/wangpiao ä»»åŠ¡è¦æ±‚ç›®æ ‡æ•°æ®ï¼šï¼ˆ1ï¼‰åæ¬¡ï¼ˆ2ï¼‰ç”µå½±åç§° ï¼ˆ3ï¼‰æ—¥æœŸï¼ˆ4ï¼‰ç¥¨æˆ¿ ï¼ˆ5ï¼‰æ€»åœºæ¬¡ï¼ˆ6ï¼‰åºŸåœºï¼ˆ7ï¼‰äººæ¬¡ï¼ˆ8ï¼‰ä¸Šåº§ç‡ï¼ˆ9ï¼‰ç¥¨ä»· è¦æ±‚ ï¼ˆ1ï¼‰ä½¿ç”¨urllibæˆ–requestsåº“å®ç°è¯¥ç½‘ç«™ç½‘é¡µæºä»£ç çš„è·å–ï¼Œå¹¶å°†æºä»£ç è¿›è¡Œä¿å­˜ï¼› ï¼ˆ2ï¼‰è‡ªä¸»é€‰æ‹©reã€bs4ã€lxmlä¸­çš„ä¸€ç§è§£ææ–¹æ³•å¯¹ä¿å­˜çš„çš„æºä»£ç è¯»å–å¹¶è¿›è¡Œè§£æï¼ŒæˆåŠŸæ‰¾åˆ°ç›®æ ‡æ•°æ®æ‰€åœ¨çš„ç‰¹å®šæ ‡ç­¾ï¼Œè¿›è¡Œç½‘é¡µç»“æ„çš„è§£æï¼› ï¼ˆ3ï¼‰å®šä¹‰å‡½æ•°ï¼Œå°†è·å–çš„ç›®æ ‡æ•°æ®ä¿å­˜åˆ°MYSQLåº“æ–‡ä»¶ä¸­ã€‚ ï¼ˆ4ï¼‰ä½¿ç”¨æ¡†æ¶å¼ç»“æ„ï¼Œé€šè¿‡å‚æ•°ä¼ é€’å®ç°æ•´ä¸ªç‰¹å®šæ•°æ®çš„çˆ¬å–ã€‚ æºç import requests import json import csv from requests.exceptions import RequestException from lxml import etree import pymysql from PIL import Image import pytesseract import traceback def connectMysql(): return pymysql.connect(host='localhost',user='root',password='123456',port=3306,db='spiders') def createMysqlTable(): db = connectMysql() cursor = db.cursor() # fieldnames = ['åæ¬¡','ç”µå½±åç§°','æ—¥æœŸ','ç¥¨æˆ¿','æ€»åœºæ¬¡','åºŸåœº','äººæ¬¡','ä¸Šåº§ç‡','ç¥¨ä»·'] sql = 'create table if not exists movies (\\ åæ¬¡ int not null ,\\ ç”µå½±åç§° varchar(255) not null ,\\ æ—¥æœŸ varchar(255) not null,\\ æ€»åœºæ¬¡ varchar(255) not null,\\ åºŸåœº varchar(255) not null,\\ äººæ¬¡ varchar(255) not null,\\ ä¸Šåº§ç‡ varchar(255) not null,\\ ç¥¨ä»· varchar(255) not null,\\ ç¥¨æˆ¿ varchar(255) not null,\\ primary key(åæ¬¡))' cursor.execute(sql) print('ok') db.close() def getHtmlText(url): headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return \"\" def parsePage(html): ulist = [] clist = [] rlist = [] ilist = [] newhtml =etree.HTML(html,etree.HTMLParser()) result=newhtml.xpath('//*[@id=\"content\"]/div[2]/table/tbody/tr/td//text()') imgs = newhtml.xpath('//*[@id=\"content\"]/div[2]/table/tbody/tr/td/a/img/@src', stream=True) j = 0 for img in imgs: j=j+1 with open(str(j)+'.png', 'wb') as fd: picture=requests.get(img).content fd.write(picture) for i in range(len(imgs)): str_ = str(i+1)+'.png' text = pytesseract.image_to_string(Image.open(str_)) ilist.append(text.replace(\" \",\".\").replace(\"M\",\"äº¿\").replace(\"a\",\"äº¿\")) # print(ilist) for i in range(len(result)): ulist.append(result[i].replace(\" \",\"\").replace('\\r',\"\").replace(\"\\n\",'')) while '' in ulist: ulist.remove('') length = len(ulist) weight = int(length / 8 ) for i in range(weight): for j in range(8): clist.append(ulist[i*8+j]) clist.append(ilist[i]) rlist.append(clist) clist = [] return rlist def mysqlData(datas): table = 'movies' keys = 'åæ¬¡,ç”µå½±åç§°,æ—¥æœŸ,æ€»åœºæ¬¡,åºŸåœº,äººæ¬¡,ä¸Šåº§ç‡,ç¥¨ä»·,ç¥¨æˆ¿' db = connectMysql() cursor = db.cursor() for data in datas: values = ','.join(['%s']*len(data)) sql = 'INSERT INTO {table}({keys}) VALUES({values})'.format(table=table,keys = keys ,values = values) print(sql) print(tuple(data)) try : if cursor.execute(sql, tuple(data)): print(\"Succcessful\") db.commit() except: traceback.print_exc() print(\"Failed\") db.rollback() db.close() def main(): createMysqlTable() url=\"http://58921.com/daily/wangpiao\" html=getHtmlText(url) rlist=parsePage(html) mysqlData(rlist) main() ç»“æœè¾“å‡ºæ•ˆæœï¼š","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"MYSQL","slug":"MYSQL","permalink":"http://ailous.top/tags/MYSQL/"},{"name":"ç¥¨æˆ¿","slug":"ç¥¨æˆ¿","permalink":"http://ailous.top/tags/ç¥¨æˆ¿/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”æœç‹æœ€æ–°æ—¶æ”¿æ–°é—»æ•°æ®çˆ¬å–â€”â€”BS4","slug":"ç½‘ç»œçˆ¬è™«â€”â€”æœç‹æœ€æ–°æ—¶æ”¿æ–°é—»æ•°æ®çˆ¬å–","date":"2019-05-21T05:47:40.000Z","updated":"2020-05-27T07:44:40.206Z","comments":true,"path":"2019/05/21/wang-luo-pa-chong-sou-hu-zui-xin-shi-zheng-xin-wen-shu-ju-pa-qu/","link":"","permalink":"http://ailous.top/2019/05/21/wang-luo-pa-chong-sou-hu-zui-xin-shi-zheng-xin-wen-shu-ju-pa-qu/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”æœç‹æœ€æ–°æ—¶æ”¿æ–°é—»æ•°æ®çˆ¬å–ç›®æ ‡ç½‘å€ï¼šhttps://www.sohu.com/c/8/1460?spm=smpc.null.side-nav.14.1584869506422WxyU9iK ç›®æ ‡æ•°æ®æè¿°ï¼šï¼ˆ1ï¼‰æ ‡é¢˜ ï¼ˆ2ï¼‰é“¾æ¥åœ°å€è¦æ±‚ï¼š ï¼ˆ1ï¼‰ä½¿ç”¨urllibåº“æˆ–è€…requestsæŠ“å–ç½‘é¡µæºä»£ç ï¼› ï¼ˆ2ï¼‰ä½¿ç”¨BeautifulSoupçš„CSSé€‰æ‹©å™¨æ–¹æ³•å¯¹è·å–çš„æºä»£ç è¿›è¡Œè§£æï¼Œå¹¶æˆåŠŸæ‰¾åˆ°ç›®æ ‡æ•°æ®æ‰€åœ¨çš„ç‰¹å®šæ ‡ç­¾ï¼Œè¿›è¡Œç½‘é¡µç»“æ„çš„è§£æï¼› ï¼ˆ3ï¼‰åˆ©ç”¨æ¡†æ¶ç»“æ„ï¼Œé€šè¿‡å‡½æ•°è°ƒç”¨ï¼Œå‚æ•°ä¼ é€’ï¼Œå®ç°ç›®æ ‡æ•°æ®æŠ“å–ï¼Œå¹¶å°è¯•å°†ç»“æœå†™å…¥æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚ æºç import requests from bs4 import BeautifulSoup import bs4 def getHtmlText(url): headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: print(\"A\") return \"\" def findUniverse(ulist , html): soup = BeautifulSoup(html,\"html.parser\") for div in soup.find(attrs=['class','news-list clearfix']).children: if isinstance(div ,bs4.element.Tag): list_0 = div.find('h4').find('a').get('href') list_1 = div.find('h4').string.replace(\" \",'').replace(\"\\n\",'') ulist.append([list_0,list_1]) def findSame(ulist,html): soup = BeautifulSoup(html,\"html.parser\") for div in soup.find(attrs=['class','second-nav']).children: if isinstance(div ,bs4.element.Tag): ulist.append(div.find('a').get('href')) return ulist def printUniverse(ulist): tplt = '{0:30}\\t{1:18}' print(tplt.format(\"ç½‘å€\",\"åç§°\",chr(12288))) for i in range(len(ulist)): u = ulist[i] print(tplt.format(u[0],u[1],chr(12288))) def main(): ulist = [] ulist_Same = [] url = 'https://www.sohu.com/c/8/1460?spm=smpc.null.side-nav.14.1585491604691ZcX26aI' html = getHtmlText(url) ulist_Same = findSame(ulist_Same,html) for i in range(len(ulist_Same) - 2 ): url = 'https://www.sohu.com' + ulist_Same[i+1] html = getHtmlText(url) findUniverse(ulist,html) printUniverse(ulist) main() è¾“å‡ºå¦‚ä¸‹ï¼š","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"BS4","slug":"BS4","permalink":"http://ailous.top/tags/BS4/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"è±†ç“£ç”µå½±æ’è¡Œæ¦œæ•°æ®æŠ“å–ï¼ˆé«˜çº§ï¼‰â€”â€”BS4","slug":"ç½‘ç»œçˆ¬è™«â€”â€”è±†ç“£ç”µå½±æ’è¡Œæ¦œæ•°æ®æŠ“å–ï¼ˆé«˜çº§ï¼‰","date":"2019-05-04T05:47:40.000Z","updated":"2020-05-27T07:45:05.368Z","comments":true,"path":"2019/05/04/wang-luo-pa-chong-dou-ban-dian-ying-pai-xing-bang-shu-ju-zhua-qu-gao-ji/","link":"","permalink":"http://ailous.top/2019/05/04/wang-luo-pa-chong-dou-ban-dian-ying-pai-xing-bang-shu-ju-zhua-qu-gao-ji/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”è±†ç“£ç”µå½±æ’è¡Œæ¦œæ•°æ®æŠ“å–ï¼ˆé«˜çº§ï¼‰ç›®æ ‡ç½‘å€ï¼šè±†ç“£ç”µå½±æ’è¡Œï¼šhttps://movie.douban.com/top250?start= ç›®æ ‡æ•°æ®æè¿°ï¼šæ’åã€ç”µå½±åç§°ã€å¯¼æ¼”ã€ä¸»æ¼”ã€è¯„ä»·äººæ•°ç­‰ä¿¡æ¯ï¼Œå°†å°½å¯èƒ½å¤šçš„æ•°æ®æŠ“å–ä¿å­˜ä»»åŠ¡æ˜ç»†ï¼š ï¼ˆ1ï¼‰ä½¿ç”¨requestsåº“å®ç°è¯¥ç½‘ç«™ç½‘é¡µæºä»£ç çš„è·å–ï¼› ï¼ˆ2ï¼‰ä½¿ç”¨BeautifulSoupå¯¹è·å–çš„æºä»£ç è¿›è¡Œè§£æï¼Œå¹¶æˆåŠŸæ‰¾åˆ°ç›®æ ‡æ•°æ®æ‰€åœ¨çš„ç‰¹å®šæ ‡ç­¾ï¼Œè¿›è¡Œç½‘é¡µç»“æ„çš„è§£æï¼› ï¼ˆ3ï¼‰å®šä¹‰å‡½æ•°ï¼Œå°†è·å–çš„ç›®æ ‡æ•°æ®æ‰“å°è¾“å‡ºï¼Œæœ‰èƒ½åŠ›çš„åŒå­¦å¯ä»¥è¯•ç€å°†ç»“æœå†™å…¥æ–‡ä»¶ä¸­ã€‚ ï¼ˆ4ï¼‰ä½¿ç”¨æ¡†æ¶å¼ç»“æ„ï¼Œé€šè¿‡å‚æ•°ä¼ é€’å®ç°æ•´ä¸ªç‰¹å®šæ•°æ®çš„çˆ¬å–ã€‚ å¯ä»¥é€‰æ‹©å®šä¹‰å…¨å±€åˆ—è¡¨ï¼Œå°†ç›®æ ‡æ•°æ®è·å–åæ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼ŒåŒæ—¶ï¼Œæ³¨æ„è§‚å¯Ÿåˆ†é¡µæ—¶urlçš„å˜åŒ–ï¼Œä»¥ä¾¿è·å–æ•´ä¸ªçš„æ’è¡Œæ¦œæ•°æ®ã€‚å»ºè®®é€šè¿‡forå¾ªç¯ä¼ é€’å˜åŒ–å‚æ•°å®ç°ã€‚ æºç import requests from bs4 import BeautifulSoup import bs4 def getHtmlText(url): headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding result=(result.text.replace('','')).replace('','') return result except: return \"\" def findUniverse(ulist , html): soup = BeautifulSoup(html,\"html.parser\") list_ = [0,0,0,0,0,0,0] for li in soup.find(attrs=['class','grid_view']).children: if isinstance(li ,bs4.element.Tag): list_[0] = li.find('em').string list_[1] = li.find(attrs=['class','title']).string list_[2] = li.find(attrs=['class','bd']).find(attrs=['class','']).string.strip().split(\" \")[1].replace(\" \",'') list_[3] = li.find(attrs=['class','bd']).find(attrs=['class','']).string.strip().split(\" \")[4].replace(\" \",'') list_[4] = li.find(attrs=['class','star']).span.find_next_sibling().string.strip() list_[5] = li.find(attrs=['class','star']).span.find_next_sibling().find_next_sibling().find_next_sibling().string.strip() if li.find(attrs=['class','quote']) is not None: list_[6] = li.find(attrs=['class','quote']).span.string else: list_[6] = None ulist.append([list_[0],list_[1],list_[2],list_[3],list_[4],list_[5],list_[6]]) def printUniverse(ulist): tplt = '{0:^4}\\t{1:^10}\\t{2:10}\\t{3:10}\\t{4:10}\\t{5:10}' print(tplt.format(\"æ’å\",\"ç”µå½±åç§°\",\"å¯¼æ¼”\",\"ä¸»æ¼”\",\"è¯„åˆ†\",\"è¯„ä»·äººæ•°\",chr(12288))) for i in range(len(ulist)): u = ulist[i] print(tplt.format(u[0],u[1],u[2],u[3],u[4],u[5],chr(12288))) def main(): ulist = [] for i in range(10): url = 'https://movie.douban.com/top250?start=' + str( 25 * i ) html = getHtmlText(url) findUniverse(ulist,html) printUniverse(ulist) main() è¾“å‡ºå¦‚ä¸‹ï¼š","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"BS4","slug":"BS4","permalink":"http://ailous.top/tags/BS4/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"åŸºäºBilibiliçƒ­é—¨è§†é¢‘Top100æœ€çƒ­åˆ†åŒºçˆ¬å–ä¸åˆ†æ","slug":"åŸºäºBilibiliçƒ­é—¨è§†é¢‘Top100æœ€çƒ­åˆ†åŒºçˆ¬å–ä¸åˆ†æ","date":"2019-05-03T05:47:40.000Z","updated":"2020-05-27T07:43:57.645Z","comments":true,"path":"2019/05/03/ji-yu-bilibili-re-men-shi-pin-top100-zui-re-fen-qu-pa-qu-yu-fen-xi/","link":"","permalink":"http://ailous.top/2019/05/03/ji-yu-bilibili-re-men-shi-pin-top100-zui-re-fen-qu-pa-qu-yu-fen-xi/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”åŸºäºBilibiliçƒ­é—¨è§†é¢‘Top100æœ€çƒ­åˆ†åŒºçˆ¬å–ä¸åˆ†æè¿™ä¸ªä¸»è¦æ˜¯é…åˆä¹‹å‰æŠ¥å‘Šä½¿ç”¨çš„ï¼Œè¿™é‡Œå°±ä¸å¤šèµ˜è¿°äº†ã€‚å…ˆçˆ¬åœ°å€ï¼Œå†çˆ¬å–åœ°å€é‡Œçš„åˆ†åŒºï¼Œæœ€åæ•´åˆã€‚csvå­˜å‚¨ã€‚ å®éªŒå†…å®¹ç›®æ ‡ç½‘ç«™ï¼šBilibiliçƒ­é—¨è§†é¢‘Top100 ç›®æ ‡ç½‘å€ï¼šhttps://www.bilibili.com/ranking?ï¼ˆæ¯è¿‡å‡ å¤©éƒ½ä¼šå˜çš„å“¦ï¼‰ from lxml import etree import time import jieba import numpy as np from PIL import Image import requests import re from requests.exceptions import RequestException from wordcloud import WordCloud as wc import csv class getUrl (): def __init__(self,url): self.url = url def getTxt(self): self.headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(self.url,headers=self.headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return \"\" def parsePage(self): res = self.getTxt() newhtml =etree.HTML(res,etree.HTMLParser()) result=newhtml.xpath('//*[@id=\"app\"]/div[1]/div/div[1]/div[2]/div[3]/ul/li/div[2]/div[1]/a//@href') return result class getAvNum(): def __init__(self,url): self.url = url def getTxt(self): self.headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(self.url,headers=self.headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return \"\" def parsePage(self): res = self.getTxt() newhtml =etree.HTML(res,etree.HTMLParser()) rlist=newhtml.xpath('//*[@id=\"viewbox_report\"]/div[1]/span[1]/a[1]//text()') return rlist class Bilibili(): def __init__(self,oid): self.headers={ 'Host': 'api.bilibili.com', 'Connection': 'keep-alive', 'Cache-Control': 'max-age=0', 'Upgrade-Insecure-Requests': '1', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.92 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', 'Accept-Encoding': 'gzip, deflate, br', 'Accept-Language': 'zh-CN,zh;q=0.9', 'Cookie': 'finger=edc6ecda; LIVE_BUVID=AUTO1415378023816310; stardustvideo=1; CURRENT_FNVAL=8; buvid3=0D8F3D74-987D-442D-99CF-42BC9A967709149017infoc; rpdid=olwimklsiidoskmqwipww; fts=1537803390' } self.url='https://api.bilibili.com/x/v1/dm/list.so?oid='+str(oid) self.barrage_reault=self.get_page() def get_page(self): try: time.sleep(0.5) response=requests.get(self.url,headers=self.headers) except Exception as e: print('è·å–xmlå†…å®¹å¤±è´¥,%s' % e) return False else: if response.status_code == 200: with open('bilibili.xml','wb') as f: f.write(response.content) return True else: return False def param_page(self): time.sleep(1) if self.barrage_reault: html=etree.parse('bilibili.xml',etree.HTMLParser()) results=html.xpath('//d//text()') return results def remove_double_barrage(resultlist): double_barrage=[] results=[] barrage=set() for result in resultlist: if result not in results: results.append(result) else: double_barrage.append(result) barrage.add(result) return double_barrage,results,barrage def make_wordCould(resultlist): double_barrages,results,barrages=remove_double_barrage(resultlist) with open('barrages.txt','w', -1, 'utf-8', None, None) as f: for barrage in barrages: amount=double_barrages.count(barrage) stt = barrage+':'+str(amount+1)+'\\n' f.write(stt) stop_words=['ã€','ã€‘',',','.','?','!','ã€‚'] words=[] if results: for result in results: for stop in stop_words: result=''.join(result.split(stop)) words.append(result) # åˆ—è¡¨æ‹¼æ¥æˆå­—ç¬¦ä¸² words=''.join(words) words=jieba.cut(words) words=''.join(words) luo=np.array(Image.open('æ´›å¤©ä¾.jpg')) w=wc(font_path='â€ªC:/Windows/Fonts/SIMYOU.TTF',background_color='white',width=1600,height=1600,max_words=2000,mask=luo) w.generate(words) w.to_file('luo.jpg') def csvdata(data): with open('top20.csv','w',encoding = 'utf-8',newline='')as csvfile: fieldnames = ['åˆ†ç±»'] writer = csv.DictWriter(csvfile,fieldnames=fieldnames) writer.writeheader() for i in data: writer.writerow({'åˆ†ç±»':i[0]}) print('ok') def main(): url=\"https://www.bilibili.com/ranking?spm_id_from=333.851.b_7072696d61727950616765546162.3\" urls = getUrl(url) strUrl = urls.parsePage() ress = [] for i in strUrl: AV = getAvNum(i) oid = AV.parsePage() ress.append(oid) csvdata(ress) if __name__ == '__main__': main()","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"xpath","slug":"xpath","permalink":"http://ailous.top/tags/xpath/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"åŸºäºBilibiliçƒ­é—¨è§†é¢‘Top100å¼¹å¹•çš„æ•°æ®çˆ¬å–ä¸åˆ†æï¼ˆæºä»£ç ï¼‰","slug":"åŸºäºBilibiliçƒ­é—¨è§†é¢‘Top100å¼¹å¹•çš„æ•°æ®çˆ¬å–ä¸åˆ†æï¼ˆæºä»£ç ï¼‰","date":"2019-05-03T05:47:40.000Z","updated":"2020-05-26T03:53:04.984Z","comments":true,"path":"2019/05/03/ji-yu-bilibili-re-men-shi-pin-top100-dan-mu-de-shu-ju-pa-qu-yu-fen-xi-yuan-dai-ma/","link":"","permalink":"http://ailous.top/2019/05/03/ji-yu-bilibili-re-men-shi-pin-top100-dan-mu-de-shu-ju-pa-qu-yu-fen-xi-yuan-dai-ma/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”åŸºäºBilibiliçƒ­é—¨è§†é¢‘Top100å¼¹å¹•çš„æ•°æ®çˆ¬å–ä¸åˆ†æå®éªŒå†…å®¹ç›®æ ‡ç½‘ç«™ï¼šBilibiliçƒ­é—¨è§†é¢‘Top100 ç›®æ ‡ç½‘å€ï¼šhttps://www.bilibili.com/ranking?ï¼ˆæ¯è¿‡å‡ å¤©éƒ½ä¼šå˜çš„å“¦ï¼‰ ä»»åŠ¡è¦æ±‚å®ç°å¯¹äºBilibiliçƒ­é—¨è§†é¢‘Top100å¼¹å¹•çš„æ•°æ®çˆ¬å–ä¸åˆ†æ æºç from lxml import etree import time import jieba import numpy as np from PIL import Image import requests import re from requests.exceptions import RequestException from wordcloud import WordCloud as wc class getUrl (): def __init__(self,url): self.url = url def getTxt(self): self.headers = { &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69&#39; } try: result = requests.get(self.url,headers=self.headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return &quot;&quot; def parsePage(self): res = self.getTxt() newhtml =etree.HTML(res,etree.HTMLParser()) result=newhtml.xpath(&#39;//*[@id=&quot;app&quot;]/div[1]/div/div[1]/div[2]/div[3]/ul/li/div[2]/div[1]/a//@href&#39;) return result class getAvNum(): def __init__(self,url): self.url = url def getTxt(self): self.headers = { &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69&#39; } try: result = requests.get(self.url,headers=self.headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return &quot;&quot; def parsePage(self): res = self.getTxt() newhtml =etree.HTML(res,etree.HTMLParser()) rlist=newhtml.xpath(&#39;/html/head/meta[10]//@content&#39;) resp = requests.get(rlist[0],headers=self.headers) match_rule = r&#39;cid=(.*?)&amp;aid&#39; oid = re.search(match_rule,resp.text).group().replace(&#39;cid=&#39;,&#39;&#39;).replace(&#39;&amp;aid&#39;,&#39;&#39;) return oid class Bilibili(): def __init__(self,oid): self.headers={ &#39;Host&#39;: &#39;api.bilibili.com&#39;, &#39;Connection&#39;: &#39;keep-alive&#39;, &#39;Cache-Control&#39;: &#39;max-age=0&#39;, &#39;Upgrade-Insecure-Requests&#39;: &#39;1&#39;, &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.92 Safari/537.36&#39;, &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&#39;, &#39;Accept-Encoding&#39;: &#39;gzip, deflate, br&#39;, &#39;Accept-Language&#39;: &#39;zh-CN,zh;q=0.9&#39;, &#39;Cookie&#39;: &#39;finger=edc6ecda; LIVE_BUVID=AUTO1415378023816310; stardustvideo=1; CURRENT_FNVAL=8; buvid3=0D8F3D74-987D-442D-99CF-42BC9A967709149017infoc; rpdid=olwimklsiidoskmqwipww; fts=1537803390&#39; } self.url=&#39;https://api.bilibili.com/x/v1/dm/list.so?oid=&#39;+str(oid) self.barrage_reault=self.get_page() def get_page(self): try: time.sleep(0.5) response=requests.get(self.url,headers=self.headers) except Exception as e: print(&#39;è·å–xmlå†…å®¹å¤±è´¥,%s&#39; % e) return False else: if response.status_code == 200: with open(&#39;bilibili.xml&#39;,&#39;wb&#39;) as f: f.write(response.content) return True else: return False def param_page(self): time.sleep(1) if self.barrage_reault: html=etree.parse(&#39;bilibili.xml&#39;,etree.HTMLParser()) results=html.xpath(&#39;//d//text()&#39;) return results def remove_double_barrage(resultlist): double_barrage=[] results=[] barrage=set() for result in resultlist: if result not in results: results.append(result) else: double_barrage.append(result) barrage.add(result) return double_barrage,results,barrage def make_wordCould(resultlist): double_barrages,results,barrages=remove_double_barrage(resultlist) # é‡è¯è®¡æ•° with open(&#39;barrages.txt&#39;,&#39;w&#39;, -1, &#39;utf-8&#39;, None, None) as f: for barrage in barrages: amount=double_barrages.count(barrage) stt = barrage+&#39;:&#39;+str(amount+1)+&#39;\\n&#39; f.write(stt) # è®¾ç½®åœç”¨è¯ stop_words=[&#39;ã€&#39;,&#39;ã€‘&#39;,&#39;,&#39;,&#39;.&#39;,&#39;?&#39;,&#39;!&#39;,&#39;ã€‚&#39;] words=[] if results: for result in results: for stop in stop_words: result=&#39;&#39;.join(result.split(stop)) words.append(result) # åˆ—è¡¨æ‹¼æ¥æˆå­—ç¬¦ä¸² words=&#39;&#39;.join(words) words=jieba.cut(words) words=&#39;&#39;.join(words) luo=np.array(Image.open(&#39;æ´›å¤©ä¾.jpg&#39;)) w=wc(font_path=&#39;â€ªC:/Windows/Fonts/SIMYOU.TTF&#39;,background_color=&#39;white&#39;,width=1600,height=1600,max_words=2000,mask=luo) w.generate(words) w.to_file(&#39;luo.jpg&#39;) def main(): url=&quot;https://www.bilibili.com/ranking?spm_id_from=333.851.b_7072696d61727950616765546162.3&quot; urls = getUrl(url) strUrl = urls.parsePage() ress = [] for i in strUrl: AV = getAvNum(i) oid = AV.parsePage() b=Bilibili(oid) for j in b.param_page(): ress.append(j) make_wordCould(ress) if __name__ == &#39;__main__&#39;: main() å…·ä½“æ–‡ä»¶å¯ä»¥åˆ°æˆ‘çš„githubä¸Šé¢ä¸‹è½½","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"xpath","slug":"xpath","permalink":"http://ailous.top/tags/xpath/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"åŸºäºBilibiliçƒ­é—¨è§†é¢‘Top100æœ€çƒ­åˆ†åŒºçˆ¬å–ä¸åˆ†æï¼ˆæŠ¥å‘Šï¼‰","slug":"åŸºäºBilibiliçƒ­é—¨è§†é¢‘Top100å¼¹å¹•çš„æ•°æ®çˆ¬å–ä¸åˆ†æï¼ˆæŠ¥å‘Šç‰ˆï¼‰","date":"2019-05-03T05:47:40.000Z","updated":"2020-05-26T03:50:14.229Z","comments":true,"path":"2019/05/03/ji-yu-bilibili-re-men-shi-pin-top100-dan-mu-de-shu-ju-pa-qu-yu-fen-xi-bao-gao-ban/","link":"","permalink":"http://ailous.top/2019/05/03/ji-yu-bilibili-re-men-shi-pin-top100-dan-mu-de-shu-ju-pa-qu-yu-fen-xi-bao-gao-ban/","excerpt":"","text":"ä¸€ã€ç ”ç©¶èƒŒæ™¯èƒ½å¤Ÿåœ¨è§‚çœ‹è§†é¢‘çš„è¿‡ç¨‹ä¸­å‘è¡¨è‡ªå·±çš„è¯„è®ºï¼Œå¹¶ä¸”è¯„è®ºå¯ä»¥åœ¨ä½ æ‰€å¸Œæœ›çš„æ—¶é—´ç‚¹ã€ä½ç½®ä»¥æ»‘è¡Œæˆ–åœç•™çš„æ–¹å¼å‡ºç°åœ¨è§†é¢‘ä¸­ï¼Œæ‰€æœ‰è§‚çœ‹è§†é¢‘çš„äººéƒ½å¯ä»¥çœ‹è§è¯„è®ºï¼Œè¿™æ ·ä¸€ç±»çš„è¯„è®ºå«åšå¼¹å¹•ï¼Œæ­¤ç±»ç½‘ç«™å«å¼¹å¹•ç½‘ç«™ã€‚å¼¹å¹•è§†é¢‘ç³»ç»Ÿæºè‡ªæ—¥æœ¬å¼¹å¹•è§†é¢‘åˆ†äº«ç½‘ç«™ï¼ˆniconicoåŠ¨ç”»ï¼‰ï¼Œå›½å†…é¦–å…ˆå¼•è¿›ä¸ºAcFunä»¥åŠåæ¥çš„bilibiliã€‚å¤§é‡åæ§½è¯„è®ºä»å±å¹•é£˜è¿‡æ—¶æ•ˆæœçœ‹ä¸Šå»åƒæ˜¯é£è¡Œå°„å‡»æ¸¸æˆé‡Œçš„å¼¹å¹•ï¼Œæ‰€ä»¥NICOç½‘æ°‘å°†è¿™ç§æœ‰å¤§é‡çš„åæ§½è¯„è®ºå‡ºç°æ—¶çš„æ•ˆæœåšå¼¹å¹•ã€‚åœ¨ä¸­å›½ï¼Œæœ¬æ¥åªæœ‰å¤§é‡è¯„è®ºåŒæ—¶å‡ºç°æ‰èƒ½å«å¼¹å¹•ï¼Œä½†æ˜¯éšç€è¯¯ç”¨å•æ¡è¯„è®ºä¹Ÿèƒ½å«å¼¹å¹•äº†ã€‚åœ¨å›½å†…é€šå¸¸è¢«è®¤ä¸ºæœ¬æ„æ˜¯å†›äº‹ç”¨è¯­ä¸­å¯†é›†çš„ç‚®ç«å°„å‡»ï¼Œè¿‡äºå¯†é›†ä»¥è‡³äºåƒä¸€å¼ å¹•å¸ƒä¸€æ ·ã€‚è‹±æ–‡ç§°â€œBullet Hellâ€ï¼ˆå­å¼¹åœ°ç‹±ï¼‰æˆ–â€œBullet Curtainâ€ï¼ˆå¼¹å¹•ï¼‰å¼¹å¹•å¯ä»¥ç»™è§‚ä¼—ä¸€ç§â€œå®æ—¶äº’åŠ¨â€çš„é”™è§‰ï¼Œè™½ç„¶ä¸åŒå¼¹å¹•çš„å‘é€æ—¶é—´æœ‰æ‰€åŒºåˆ«ï¼Œä½†æ˜¯å…¶åªä¼šåœ¨è§†é¢‘ä¸­ç‰¹å®šçš„ä¸€ä¸ªæ—¶é—´ç‚¹å‡ºç°ï¼Œå› æ­¤åœ¨ç›¸åŒæ—¶åˆ»å‘é€çš„å¼¹å¹•åŸºæœ¬ä¸Šä¹Ÿå…·æœ‰ç›¸åŒçš„ä¸»é¢˜ï¼Œåœ¨å‚ä¸è¯„è®ºæ—¶å°±ä¼šæœ‰ä¸å…¶ä»–è§‚ä¼—åŒæ—¶è¯„è®ºçš„é”™è§‰ã€‚è€Œä¼ ç»Ÿçš„æ’­æ”¾å™¨è¯„è®ºç³»ç»Ÿæ˜¯ç‹¬ç«‹äºæ’­æ”¾å™¨ä¹‹å¤–çš„ï¼Œå› æ­¤è¯„è®ºçš„å†…å®¹å¤§å¤šå›´ç»•åœ¨æ•´ä¸ªè§†é¢‘ä¸Šï¼Œè¯é¢˜æ€§ä¸å¼ºï¼Œä¹Ÿæ²¡æœ‰â€œå®æ—¶äº’åŠ¨â€çš„æ„Ÿè§‰ã€‚ äºŒã€ç ”ç©¶ç›®çš„åŠæ„ä¹‰åœ¨è§†é¢‘è½¯ä»¶å±‚å‡ºä¸ç©·çš„å½“ä¸‹ã€‚é™¤äº†ä¼˜è´¨çš„è§†é¢‘å†…å®¹ï¼Œå¯¹äºç¤¾åŒºæ–‡åŒ–å¦‚ä½•æ¢ç´¢æˆä¸ºå½“ä¸‹å„ä¸ªå…¬å¸æåŠ›æ¢ç´¢çš„ç›®æ ‡ã€‚æ–°æ—¶æœŸè‡ªåª’ä½“ç››è¡Œï¼ŒBiliBiliç›¸è¾ƒäºåŒç±»è½¯ä»¶ï¼Œå…¶ç¤¾åŒºæ–‡åŒ–å‘ˆç°æ¬£æ¬£å‘è£ä¹‹åŠ¿ï¼Œæ‹¥æœ‰è¾ƒé«˜çš„æ—¥æ´»è·ƒé‡ã€‚è€Œå¼¹å¹•æ–‡åŒ–ä¿¨ç„¶æˆä¸ºå…¶ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚2019å¹´å¹´æœ«ï¼ŒBilibiliæ›¾å‘å¸ƒå¹´åº¦åå¤§çƒ­è¯ï¼Œâ€˜AWSLâ€™å¤ºå¾—å¤´ç­¹ã€‚ç´§éšå…¶åçš„æ˜¯â€˜ååœºé¢â€™ï¼Œâ€˜é€®è™¾æˆ·â€™â€¦â€¦ï¼Œè¿™äº›æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­è€³ç†Ÿèƒ½è¯¦çš„â€˜æ–°è¯æ±‡â€™ã€‚ç”±äºäº’è”ç½‘å±è”½äº†ç”¨æˆ·çš„è®¾å¤‡å·®å¼‚ï¼Œå› æ­¤ç½‘ç»œè§†é¢‘æœåŠ¡å•†å¯ä»¥è·å¾—æ ¼å¼ç»Ÿä¸€ã€æ›´åŠ è§„èŒƒçš„ç”¨æˆ·ä½¿ç”¨æ•°æ®ï¼Œæ ¹æ®ä¸åŒç”¨æˆ·çš„ä½¿ç”¨æ•°æ®å®Œæˆè§†é¢‘æ¨èã€‚ç¾å›½è‘—åç”µå­å•†åŠ¡ä¼ä¸šäºšé©¬é€Šå¾ˆæ—©å°±å¼€å§‹æ¢ç´¢æ¨èç®—æ³•åœ¨ç”µå­å•†åŠ¡ä¸­çš„åº”ç”¨ï¼Œå¹¶å·²ç»å–å¾—äº†æ˜¾è‘—çš„æˆæœã€‚å‘è¡¨å¼¹å¹•ã€è§‚çœ‹å¼¹å¹•ï¼Œæœ¬èº«å°±æœ‰ä¸€ç§å®æ—¶äº’åŠ¨çš„é”™è§‰ï¼Œå®Œæˆç€å®å®åœ¨åœ¨çš„ã€ç›´æ¥çš„äº’åŠ¨ã€‚ç½‘ç«™ä¼šæ ¹æ®ç”¨æˆ·çš„ç‚¹å‡»é‡è¿›è¡Œè§†é¢‘æ¨èï¼Œå‚ä¸çƒ­çƒˆè®¨è®ºçš„è§†é¢‘ä¼šå‡ºç°åœ¨ä¸»é¡µï¼Œå—ä¼—èƒ½æœ€å¿«æ—¶é—´åœ°çœ‹åˆ°é¡µé¢ã€‚å°†æ¥ä¹Ÿè®¸è¿˜å¯ä»¥é€šè¿‡æœç´¢å¼•æ“çš„ä¼˜åŒ–ï¼ŒæŠŠçƒ­é—¨è¯é¢˜ï¼Œçƒ­é—¨è¯è¯­ï¼Œçƒ­é—¨æœç´¢ç­‰ä½œä¸ºè§†é¢‘æ¨èçš„ä¾æ®ï¼Œè®©å—ä¼—è§‚çœ‹åˆ°ä¸è‡ªå·±å…´è¶£æœ€ç›¸ç¬¦çš„è§†é¢‘ã€‚é€šè¿‡å¯¹äºå½“å‰æ—¶é—´æ®µçƒ­é—¨æ’åTOP100ä¸­å¼¹å¹•è¿›è¡Œåˆ†æï¼Œå°†æ•°æ®è¿›è¡Œå¯è§†åŒ–å¤„ç†ï¼Œå¾—åˆ°æœ€çƒ­è¯æ±‡ï¼Œæ—¢å¯ä»¥çŸ¥é“åœ¨è¿™ä¸€æ—¶é—´æ®µç½‘ç»œèˆ†è®ºæµè¡Œçš„å¤§ä½“è¶‹åŠ¿ï¼ŒæŠŠæ¡ç”¨æˆ·å¿ƒé‡Œæ€åº¦ï¼ŒåŠ å¼ºå—ä¼—çš„äº’åŠ¨åé¦ˆã€‚è¿˜å¯ä»¥æ¿€å‘ç”¨æˆ·å¯¹äºå¼¹å¹•æ–‡åŒ–çš„æ¢ç´¢çš„å…´è¶£ã€‚ä½¿å¾—ç”¨æˆ·ä¿æŒæ–°é²œåº¦ï¼Œå»¶é•¿è½¯ä»¶å¯¿å‘½ã€‚ä¸‰ã€å®éªŒç¯å¢ƒåŠæŠ€æœ¯ä»‹ç»1.çˆ¬è™«æŠ€æœ¯ç®€ä»‹ç½‘ç»œçˆ¬è™«æ˜¯ä¸€ç§æŒ‰ç…§ä¸€å®šçš„è§„åˆ™ï¼Œè‡ªåŠ¨åœ°æŠ“å–ä¸‡ç»´ç½‘ä¿¡æ¯çš„ç¨‹åºæˆ–è€…è„šæœ¬ï¼Œå…¶å®é€šä¿—çš„è®²å°±æ˜¯é€šè¿‡ç¨‹åºå»è·å–webé¡µé¢ä¸Šè‡ªå·±æƒ³è¦çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è‡ªåŠ¨æŠ“å–æ•°æ®ã€‚çˆ¬è™«çš„ç›®åœ°åœ¨äºå°†ç›®æ ‡ç½‘é¡µæ•°æ®ä¸‹è½½è‡³æœ¬åœ°ï¼Œä»¥ä¾¿è¿›è¡Œåç»­çš„æ•°æ®åˆ†æ.çˆ¬è™«æŠ€æœ¯çš„å…´èµ·æºäºæµ·é‡ç½‘ç»œæ•°æ®çš„å¯ç”¨æ€§,é€šè¿‡çˆ¬è™«æŠ€æœ¯,èƒ½å¤Ÿè¾ƒä¸ºå®¹æ˜“çš„è·å–ç½‘ç»œæ•°æ®ï¼Œå¹¶é€šè¿‡å¯¹æ•°æ®çš„åˆ†æ,å¾—å‡ºæœ‰å…·æœ‰ä»·å€¼çš„ç»“è®ºã€‚Pythonè¯­è¨€ç®€å•æ˜“ç”¨,ç°æˆçš„çˆ¬è™«æ¡†æ¶å’Œå·¥å…·åŒ…é™ä½äº†ä½¿ç”¨é—¨æ§›,å…·ä½“ä½¿ç”¨æ—¶é…åˆæ­£åˆ™è¡¨è¾¾å¼çš„è¿ç”¨,ä½¿å¾—æ•°æ®æŠ“å–å·¥ä½œå˜å¾—ç”ŸåŠ¨æœ‰è¶£ã€‚2.æ‰€ç”¨åˆ°çš„pythonåº“2.1requestsRequests æ˜¯ç”¨Pythonè¯­è¨€ç¼–å†™ï¼ŒåŸºäº urllibï¼Œé‡‡ç”¨Apache2 Licensed å¼€æºåè®®çš„HTTPåº“ã€‚Requests ç»§æ‰¿äº†urllibçš„æ‰€æœ‰ç‰¹æ€§ã€‚Requestsæ”¯æŒHTTPè¿æ¥ä¿æŒå’Œè¿æ¥æ± ï¼Œæ”¯æŒä½¿ç”¨cookieä¿æŒä¼šè¯ï¼Œæ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼Œæ”¯æŒè‡ªåŠ¨ç¡®å®šå“åº”å†…å®¹çš„ç¼–ç ï¼Œæ”¯æŒå›½é™…åŒ–çš„URLå’ŒPOST æ•°æ®è‡ªåŠ¨ç¼–ç ã€‚ä¸»è¦ç”¨äºè¯·æ±‚URLï¼Œè·å–è¿”å›ä¿¡æ¯ï¼Œæ‰“å°è¾“å‡ºå“åº”å¤´ï¼Œå’Œé‡å®šå‘ç­‰ã€‚åœ¨çˆ¬å–æ•°æ®è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨äº†requeståº“çš„getæ–¹æ³•æ¥å‘é€è¯·æ±‚ã€‚Requestè¯·æ±‚æ–¹å¼æœ‰ï¼šGET:è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“ã€‚HEAD:åªè¯·æ±‚é¡µé¢çš„é¦–éƒ¨ã€‚POST:è¯·æ±‚æœåŠ¡å™¨æ¥å—æ‰€æŒ‡å®šçš„æ–‡æ¡£ä½œä¸ºå¯¹æ‰€æ ‡è¯†çš„URIçš„æ–°çš„ä»å±å®ä½“ã€‚PUT:ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ã€‚DELETE:è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ã€‚getå’Œpostæ¯”è¾ƒå¸¸è§GETè¯·æ±‚å°†æäº¤çš„æ•°æ®æ”¾ç½®åœ¨HTTPè¯·æ±‚åè®®å¤´ä¸­POSTæäº¤çš„æ•°æ®åˆ™æ”¾åœ¨å®ä½“æ•°æ®ä¸­2.2XPathXPath æ˜¯ä¸€é—¨åœ¨ XMLæ–‡æ¡£ä¸­æŸ¥æ‰¾ä¿¡æ¯çš„è¯­è¨€ã€‚ç”¨äºåœ¨ XMLæ–‡æ¡£ä¸­é€šè¿‡å…ƒç´ å’Œå±æ€§è¿›è¡Œå¯¼èˆªï¼Œé€‰å–XMLæ–‡æ¡£ä¸­çš„èŠ‚ç‚¹æˆ–è€…èŠ‚ç‚¹é›†ã€‚è¿™äº›è·¯å¾„è¡¨è¾¾å¼å’Œåœ¨å¸¸è§„çš„ç”µè„‘æ–‡ä»¶ç³»ç»Ÿä¸­çœ‹åˆ°çš„è¡¨è¾¾å¼éå¸¸ç›¸ä¼¼ã€‚åœ¨çˆ¬å–è±†ç“£TOP250çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨xpathæŸ¥æ‰¾æ­Œæ›²åã€æ­Œæ‰‹ã€è¯„åˆ†ç­‰ä¿¡æ¯ã€‚å›¾2-2 Xpathè·¯å¾„è¡¨è¾¾å¼å›¾2.3lxmllxml æ˜¯ä¸€ä¸ªHTML/XMLçš„è§£æå™¨ï¼Œä¸»è¦çš„åŠŸèƒ½æ˜¯å¦‚ä½•è§£æå’Œæå– HTML /XMLæ•°æ®ã€‚lxmlå’Œæ­£åˆ™ä¸€æ ·ï¼Œä¹Ÿæ˜¯ç”¨Cå®ç°çš„ï¼Œæ˜¯ä¸€æ¬¾é«˜æ€§èƒ½çš„Python HTML /XML è§£æå™¨ï¼Œå¯ä»¥åˆ©ç”¨ä¹‹å‰å­¦ä¹ çš„XPathè¯­æ³•ï¼Œæ¥å¿«é€Ÿçš„å®šä½ç‰¹å®šå…ƒç´ ä»¥åŠèŠ‚ç‚¹ä¿¡æ¯ã€‚ä½¿ç”¨lxml.etreeå¤„ç†XMLæ–‡æ¡£ã€‚ç®€è¦è®²è¿°ElementTree APIçš„ä¸»è¦è¦æ¦‚å¿µï¼Œå’Œä¸€äº›ç®€å•çš„å¢å¼ºï¼Œè®©å¤„ç†XMLæ›´ç®€å•ã€‚2.4Jieba jiebaæ˜¯ä¼˜ç§€çš„ä¸­æ–‡åˆ†è¯ç¬¬ä¸‰æ–¹åº“ã€‚é€šè¿‡åˆ†è¯çš„æ–¹å¼ä»ä¸­æ–‡æ–‡æœ¬è·å¾—å•ä¸ªçš„è¯è¯­ï¼Œä½†æ˜¯å±äºæ‹“å±•åº“ï¼Œéœ€è¦é¢å¤–å®‰è£…ã€‚å…¶æ‹¥æœ‰ä¸‰ç§åˆ†è¯æ¨¡å¼ï¼Œæœ€ç®€å•åªéœ€æŒæ¡ä¸€ä¸ªå‡½æ•°ã€‚jiebaåˆ†è¯çš„åŸç†ï¼š å…¶ä¾é ä¸­æ–‡è¯åº“ï¼Œåˆ©ç”¨ä¸€ä¸ªä¸­æ–‡è¯åº“ï¼Œç¡®å®šæ±‰å­—ä¹‹é—´çš„å…³è”æ¦‚ç‡ï¼Œ å°†æ±‰å­—é—´ç›¸é‚»æ¦‚ç‡å¤§çš„ç»„æˆè¯ç»„ï¼Œå½¢æˆåˆ†è¯ç»“æœï¼Œ é™¤äº†åˆ†è¯ï¼Œç”¨æˆ·è¿˜å¯ä»¥æ·»åŠ è‡ªå®šä¹‰çš„è¯ç»„ã€‚2.5WordCloudwordcloudåº“ï¼Œå¯ä»¥è¯´æ˜¯pythonéå¸¸ä¼˜ç§€çš„è¯äº‘å±•ç¤ºç¬¬ä¸‰æ–¹åº“ã€‚è¯äº‘ä»¥è¯è¯­ä¸ºåŸºæœ¬å•ä½æ›´åŠ ç›´è§‚å’Œè‰ºæœ¯çš„å±•ç¤ºæ–‡æœ¬ï¼Œä¹Ÿå«æ–‡å­—äº‘ï¼Œå¯¹æ–‡æœ¬ä¸­å‡ºç°é¢‘ç‡è¾ƒé«˜çš„â€œå…³é”®è¯â€äºˆä»¥è§†è§‰åŒ–çš„å±•ç°ï¼Œè¿‡æ»¤æ‰å¤§é‡çš„ä½é¢‘ä½è´¨çš„æ–‡æœ¬ä¿¡æ¯ï¼Œä½¿å¾—æµè§ˆè€…åªè¦ä¸€çœ¼æ‰«è¿‡æ–‡æœ¬å°±å¯é¢†ç•¥æ–‡æœ¬çš„ä¸»æ—¨ã€‚3.æ•°æ®åˆ†æå·¥å…·3.1Jupyter NotebookNotebooksæ˜¯Donald Knuth 1984å¹´æå‡ºçš„æ–‡æœ¬åŒ–ç¼–ç¨‹çš„ä¸€ç§å½¢å¼ã€‚Jupyter Notebook çš„æœ¬è´¨æ˜¯ä¸€ä¸ª Web åº”ç”¨ç¨‹åºï¼Œç»“åˆæ–‡æœ¬åŒ–ç¼–ç¨‹ï¼Œæ–‡æœ¬å’Œä»£ç äº¤é”™åœ¨ä¸€èµ·ï¼Œè€Œä¸æ˜¯åˆ†æˆä¸¤ä¸ªç‹¬ç«‹åœ°æœ¬åˆ†ã€‚æ˜¯ä¸ªé›†æˆæ–‡æœ¬ï¼Œæ•°å­¦å…¬å¼ï¼Œä»£ç å’Œå¯è§†åŒ–çš„å¯åˆ†äº«æ–‡æœ¬ã€‚ä¾¿äºåˆ›å»ºå’Œå…±äº«æ–‡å­¦åŒ–ç¨‹åºæ–‡æ¡£ï¼Œæ”¯æŒå®æ—¶ä»£ç ï¼Œæ•°å­¦æ–¹ç¨‹ï¼Œå¯è§†åŒ–å’Œ markdownã€‚ç”¨é€”åŒ…æ‹¬ï¼šæ•°æ®æ¸…ç†å’Œè½¬æ¢ï¼Œæ•°å€¼æ¨¡æ‹Ÿï¼Œç»Ÿè®¡å»ºæ¨¡ï¼Œæœºå™¨å­¦ä¹ ç­‰ç­‰ã€‚Notebooks å¾ˆå¿«å·²ç»æˆä¸ºäº†æ•°æ®æ“ä½œä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚å®ƒåœ¨ å¤§æ•°æ®æ¸…ç†å’Œæ¢ç©¶,å¯è§†åŒ–,æœºå™¨å­¦ä¹ , å’Œ å¤§æ•°æ®åˆ†æä¸­éƒ½æœ‰å¹¿æ³›è¿ç”¨ã€‚å¹¶ä¸”Notebooks å¯ä»¥ç›´æ¥åœ¨githubç›´æ¥è¢«è¯»å–. è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ†äº«ã€‚3.2ExcelExcelä¸ä»…æ˜¯ä¸€ä¸ªæ•°æ®å­˜å‚¨å·¥å…·ï¼Œè¿˜æ˜¯ä¸€ä¸ªç®€å•çš„æ•°æ®åˆ†æå·¥å…·ï¼Œæ·»åŠ EXCELæ•°æ®åˆ†ææ’ä»¶åï¼Œå¯ä»¥åšä¸€äº›ç®€å•ç›¸å…³ã€å›å½’ç­‰åˆ†æã€‚è€ŒExcelå¯ä»¥è¯´æ˜¯ä¸‡èƒ½ä½†åˆä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå­¦ä¹ Excelå°±æ˜¯ä¸ºäº†ç”¨æ¥ç»Ÿè®¡æ•°æ®åˆ†ææ•°æ®çš„ï¼Œå¤§è€Œå¤æ‚çš„æ•°æ®å’Œåˆ†ææœ‰æ—¶å€™ç”¨Excelå¤„ç†å¹¶ä¸æ˜¯æœ€ä½³é€‰æ‹©ã€‚Excelå’Œæ•°æ®åº“ä¹‹é—´å¯ä»¥è¿›è¡Œæ•°æ®è½¬æ¢ï¼Œä½†æ˜¯å½“Excelçš„æ•°æ®é‡è¿‡å¤§çš„æ—¶å€™ï¼Œå®ƒçš„æŸ¥è¯¢å’Œè®¡ç®—çš„é€Ÿåº¦ä¼šæ˜æ˜¾ä¸‹é™ã€‚Excelæä¾›äº†æœ‰é™çš„å®‰å…¨æ€§ï¼Œå®ƒåªèƒ½é™åˆ¶ç”¨æˆ·è®¿é—®å’Œä¿®æ”¹çš„æƒé™ï¼Œä½†æ˜¯æ— æ³•å¯¹ç”¨æˆ·è¿›è¡Œè§’è‰²çš„ç®¡ç†ï¼Œä¹Ÿä¸èƒ½å¯¹æ•°æ®è¿›è¡Œè¡Œçº§çš„è®¿é—®é™åˆ¶ã€‚å½“ç„¶Excelä¹Ÿæœ‰è‡ªèº«çš„çš„ä¼˜åŠ¿ä¹‹å¤„ï¼š1ã€æ•°æ®é€è§†åŠŸèƒ½ã€‚2ã€ç»Ÿè®¡åˆ†æï¼Œéå¸¸ç‹¬ç‰¹ï¼Œå¸¸ç”¨çš„æ£€éªŒæ–¹å¼ä¸€é”®æå®šã€‚3ã€å›¾è¡¨åŠŸèƒ½ï¼Œ Excelæ‹¥æœ‰å„ç§ä¸°å¯Œçš„å¯å¼€å‘çš„å›¾è¡¨å½¢å¼çš„ç‹¬é—¨æ­¦å·¥ã€‚4ã€è‡ªåŠ¨æ±‡æ€»åŠŸèƒ½ï¼Œè¿™ä¸ªåŠŸèƒ½å…¶ä»–ç¨‹åºéƒ½æœ‰ï¼Œä½†æ˜¯Excelç®€ä¾¿çµæ´»ã€‚æ€»åœ°æ¥è¯´ï¼ŒExcelé€‚åˆäºå¼€å‘å•æœºç‰ˆã€è®¿é—®é‡ä¸å¼€å‘ç»´æŠ¤é‡éƒ½ä¸æ˜¯å¾ˆå¤§ã€å¯¹æ•°æ®æœ‰åˆ†æå»ºæ¨¡åŠŸèƒ½çš„åº”ç”¨ç¨‹åºã€‚å››ã€æ•°æ®çˆ¬å–4.1æŠ“å–Bilibiliçƒ­é—¨è§†é¢‘Top100çš„ç½‘å€æœ¬å®éªŒåœ¨æµè§ˆå™¨æœç´¢Bilibiliçƒ­é—¨è§†é¢‘Top100çš„ç½‘å€,å°±èƒ½å¾—åˆ°è¦é‡‡é›†æ•°æ®çš„é¡µé¢ï¼Œå®ƒçš„URLä¸ºhttps://www.bilibili.com/rankingï¼Œé¡µé¢å¦‚ä¸‹å›¾4-1æ‰€ç¤ºã€‚å›¾4-1Bilibiliçƒ­é—¨è§†é¢‘Top100æ’è¡Œå›¾4.2å¯¹ç½‘å€è¿›è¡Œè½¬åŒ–ï¼Œè·å¾—Oidå·ç é€šè¿‡å¯¹ç½‘é¡µæºä»£ç çš„å¤„ç†ï¼Œå°†ç½‘é¡µæºåœ°å€ä¸­çš„åœ°å€æ•°æ®è½¬æ¢æˆAVåœ°å€æ ·å¼ï¼Œå†é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼â€™cid=(.*?)&amp;aidâ€™ï¼Œè·å–å…¶Cidç ï¼Œæœ€åå†è½¬åŒ–æˆOidç ã€‚è·å–Oidç çš„æºä»£ç å¦‚ä¸‹å›¾4-2æ‰€ç¤ºã€‚å›¾4-2 Oidç æºä»£ç è·å–å›¾è·å–Oidç çš„ä»£ç è¿è¡Œç»“æœå¦‚ä¸‹å›¾4-2æ‰€ç¤ºã€‚å›¾4-3ä»£ç è¿è¡Œç»“æœ4.3æŠ“å–å¼¹å¹•ä¿¡æ¯lxmlæ–‡ä»¶é¦–å…ˆï¼Œå¯¼å…¥requestsåŒ…ï¼Œåˆ©ç”¨requestsæ„å»ºä¸€ä¸ªç®€å•åœ°çš„GETè¯·æ±‚ï¼ŒæŠŠç½‘é¡µçš„headersï¼ˆå…¶ä¸­åŒ…å«äº†User-Agentå­—æ®µä¿¡æ¯ï¼Œæ˜¯æµè§ˆå™¨çš„æ ‡è¯†ä¿¡æ¯ï¼‰è¾“å…¥ï¼Œè¿™æ—¶ç½‘ç«™ä¼šåˆ¤æ–­å¦‚æœæ˜¯å®¢æˆ·ç«¯å‘èµ·çš„GETè¯·æ±‚ï¼Œå®ƒä¼šè¿”å›ç›¸åº”çš„è¯·æ±‚ä¿¡æ¯ã€‚é€šè¿‡Oidç æ‰èƒ½å¾—åˆ°å¼¹å¹•å­˜å‚¨æ‰€åœ¨çš„lxmlæ–‡ä»¶ã€‚Lxmlä»£ç å¦‚ä¸‹å›¾4-3æ‰€ç¤ºã€‚å›¾4-4 Lxmlè·å–ä»£ç å›¾4-5 Lxmlæ–‡ä»¶å›¾4.4æŠ“å–æ‰€æœ‰å¼¹å¹•ä¿¡æ¯å­˜å‚¨å¹¶å¤„ç†å°†æ‰€å¾—åˆ°çš„lxmlæ–‡ä»¶ï¼Œé€šè¿‡xpathè¿›è¡ŒæŠ“å–å¹¶ä¸”å­˜å‚¨åˆ°æ•°ç»„resultsä¸­ã€‚å›¾4-6 å¼¹å¹•ä¿¡æ¯çˆ¬å–ä»£ç é€šè¿‡appendæ–¹æ³•å°†æ‰€æœ‰å¼¹å¹•ä¿¡æ¯å­˜å‚¨ï¼Œä»¥å¾…å¤„ç†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šå›¾4-7 æ‰€æœ‰å¼¹å¹•æ•´åˆä»£ç é€šè¿‡è‡ªå®šä¹‰çš„remove_double_barrageï¼ˆï¼‰æ–¹æ³•å°†å¼¹å¹•ä¿¡æ¯è¿›è¡Œå»é‡å¤„ç†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šå›¾4-8 å¼¹å¹•ä¿¡æ¯å»é‡ä»£ç 4.5å­˜å‚¨æ•°æ®åˆ©ç”¨lxmlåº“é‡‡é›†è§†é¢‘çš„å¼¹å¹•å†…å®¹ä¿¡æ¯ã€‚å°†å¼¹å¹•å†…å®¹barrageï¼ŒåŠå¼¹å¹•å‡ºç°æ¬¡æ•°amountè¿›è¡Œå­˜å‚¨ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹å›¾4-3æ‰€ç¤ºã€‚å›¾4-9å­˜å‚¨æ•°æ®å›¾4.6æ•°æ®å±•ç¤ºå°†é‡‡é›†çš„æ•°æ®åˆå¹¶åœ¨ä¸€èµ·,å°†é‡‡é›†çš„æ•°æ®å­˜å…¥txtä¸­ï¼Œä»æ–‡ä»¶ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ”¶é›†çš„ä¿¡æ¯å­—æ®µä¸ºâ€˜å¼¹å¹•å†…å®¹â€™ï¼Œâ€˜å‡ºç°æ¬¡æ•°â€™ã€‚è¿›è¡Œæ•°æ®åˆ†æå°±æ˜¯å¯¹è¿™ä¸¤å­—æ®µè¿›è¡Œæ•°æ®åˆ†æå’Œå¯è§†åŒ–å±•ç¤ºã€‚éƒ¨åˆ†æ•°æ®å±•ç¤ºå¦‚ä¸‹å›¾4-4æ‰€ç¤ºï¼šå›¾4-10æ•°æ®å±•ç¤ºå›¾ äº”ã€æ•°æ®åˆ†æåˆ©ç”¨wordCloudå¯¹çˆ¬å–çš„æ•°æ®è¿›è¡Œåˆ†ææ¥è¿›ä¸€æ­¥å‘ˆç°ã€‚5.1æœ€çƒ­å¼¹å¹•åˆ†æå¯¹Bilibiliçƒ­é—¨è§†é¢‘Top100å¼¹å¹•è¿›è¡Œåˆ†æï¼Œé€‰å–æ¦œä¸Šæ‰€æœ‰å¼¹å¹•è¿›è¡Œé’ˆå¯¹æ€§åˆ†æï¼šä»å›¾ä¸­å¯ä»¥æ˜æ˜¾çœ‹å‡ºï¼Œç»Ÿè®¡æœŸé—´æœ€çƒ­çš„å¼¹å¹•è¦æ•°â€œå¥”æ¶Œå§ï¼Œåæµªâ€ã€‚å…¶åæ˜¯ï¼šâ€œç‹—å¤´â€â€œåæµªï¼Œå¥”æ¶Œå§â€â€œdogeâ€â€¦â€¦å›¾5-1 æœ€çƒ­å¼¹å¹•è¯äº‘5.2æœ€çƒ­åŒºåˆ†æBilibiliåŒ…æ‹¬æœ‰åŠ¨ç”»ã€ç•ªå‰§ã€éŸ³ä¹ã€èˆè¹ˆã€æ¸¸æˆã€ç§‘æŠ€ã€ç”Ÿæ´»ã€é¬¼ç•œã€æ—¶å°šã€å¹¿å‘Šã€å¨±ä¹ã€å½±è§†ç­‰å¤šä¸ªåˆ†åŒºï¼Œé€šè¿‡Top100ä¸Šæ¦œåˆ†åŒºå¤„ç†åˆ†æå¾—åˆ°å½“å‰æœ€çƒ­åˆ†åŒºã€‚å›¾5-2 æ•°æ®ç»Ÿè®¡æ ·æœ¬Â·å›¾5-3 æ ·æœ¬åˆ†æ å…­ã€æ€»ç»“ä»å®šä¹‰ä¸Šæ¥è¯´ï¼Œçˆ¬è™«å°±æ˜¯æ¨¡æ‹Ÿç”¨æˆ·è‡ªåŠ¨æµè§ˆå¹¶ä¸”ä¿å­˜ç½‘ç»œæ•°æ®çš„ç¨‹åºï¼Œå½“ç„¶ï¼Œå¤§éƒ¨åˆ†çš„çˆ¬è™«éƒ½æ˜¯çˆ¬å–ç½‘é¡µä¿¡æ¯ï¼ˆæ–‡æœ¬ï¼Œå›¾ç‰‡ï¼Œåª’ä½“æµï¼‰ã€‚æ— è®ºæ˜¯åŠ¨æ€è¿˜æ˜¯é™æ€ç½‘é¡µï¼Œæ‰€æœ‰çš„ç”¨æˆ·å¯ä»¥ç›´è§‚çœ‹åˆ°çš„ï¼Œéƒ½æœ‰çˆ¬å–ä¸‹æ¥çš„å¯èƒ½ã€‚æœ€ç®€å•çš„æµç¨‹ï¼šè·å–ç½‘é¡µæºä»£ç ï¼Œåˆ†ææºç ï¼Œå­˜å‚¨æ•°æ®ã€‚å³ä»åŠŸèƒ½ä¸Šæ¥è®²çš„ï¼Œæ•°æ®é‡‡é›†ï¼Œå¤„ç†ï¼Œå‚¨å­˜ä¸‰ä¸ªéƒ¨åˆ†ã€‚ä¼ ç»Ÿçˆ¬è™«ä»ä¸€ä¸ªæˆ–è‹¥å¹²åˆå§‹ç½‘é¡µçš„URLå¼€å§‹ï¼Œè·å¾—åˆå§‹ç½‘é¡µä¸Šçš„URLï¼Œåœ¨æŠ“å–ç½‘é¡µçš„è¿‡ç¨‹ä¸­ï¼Œä¸æ–­ä»å½“å‰é¡µé¢ä¸ŠæŠ½å–æ–°çš„URLæ”¾å…¥é˜Ÿåˆ—,ç›´åˆ°æ»¡è¶³ç³»ç»Ÿçš„ä¸€å®šåœæ­¢æ¡ä»¶ã€‚èšç„¦çˆ¬è™«çš„å·¥ä½œæµç¨‹è¾ƒä¸ºå¤æ‚ï¼Œéœ€è¦æ ¹æ®ä¸€å®šçš„ç½‘é¡µåˆ†æç®—æ³•è¿‡æ»¤ä¸ä¸»é¢˜æ— å…³çš„é“¾æ¥ï¼Œä¿ç•™æœ‰ç”¨çš„é“¾æ¥å¹¶å°†å…¶æ”¾å…¥ç­‰å¾…æŠ“å–çš„URLé˜Ÿåˆ—ã€‚ç„¶åï¼Œå®ƒå°†æ ¹æ®ä¸€å®šçš„æœç´¢ç­–ç•¥ä»é˜Ÿåˆ—ä¸­é€‰æ‹©ä¸‹ä¸€æ­¥è¦æŠ“å–çš„ç½‘é¡µURLï¼Œå¹¶é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°è¾¾åˆ°ç³»ç»Ÿçš„æŸä¸€æ¡ä»¶æ—¶åœæ­¢ã€‚å¦å¤–ï¼Œæ‰€æœ‰è¢«çˆ¬è™«æŠ“å–çš„ç½‘é¡µå°†ä¼šè¢«ç³»ç»Ÿå­˜è´®ï¼Œè¿›è¡Œä¸€å®šçš„åˆ†æã€è¿‡æ»¤ï¼Œå¹¶å»ºç«‹ç´¢å¼•ï¼Œä»¥ä¾¿ä¹‹åçš„æŸ¥è¯¢å’Œæ£€ç´¢ï¼›å¯¹äºèšç„¦çˆ¬è™«æ¥è¯´ï¼Œè¿™ä¸€è¿‡ç¨‹æ‰€å¾—åˆ°çš„åˆ†æç»“æœè¿˜å¯èƒ½å¯¹ä»¥åçš„æŠ“å–è¿‡ç¨‹ç»™å‡ºåé¦ˆå’ŒæŒ‡å¯¼ã€‚å‘èµ·è¯·æ±‚ï¼šé€šè¿‡HTTPåº“å‘ç›®æ ‡ç«™ç‚¹å‘èµ·è¯·æ±‚ï¼Œå³å‘é€ä¸€ä¸ªRequestï¼Œè¯·æ±‚å¯ä»¥åŒ…å«é¢å¤–çš„headersç­‰ä¿¡æ¯ï¼Œç­‰å¾…æœåŠ¡å™¨å“åº”ã€‚è·å–å“åº”å†…å®¹ï¼šå¦‚æœæœåŠ¡å™¨èƒ½æ­£å¸¸å“åº”ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªResponseï¼ŒResponseçš„å†…å®¹ä¾¿æ˜¯æ‰€è¦è·å–çš„é¡µé¢å†…å®¹ï¼Œç±»å‹å¯èƒ½æœ‰HTMLï¼ŒJsonå­—ç¬¦ä¸²ï¼ŒäºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚å›¾ç‰‡è§†é¢‘ï¼‰ç­‰ç±»å‹ã€‚è§£æå†…å®¹ï¼šå¾—åˆ°çš„å†…å®¹å¯èƒ½æ˜¯HTMLï¼Œå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€ç½‘é¡µè§£æåº“è¿›è¡Œè§£æã€‚å¯èƒ½æ˜¯Jsonï¼Œå¯ä»¥ç›´æ¥è½¬ä¸ºJsonå¯¹è±¡è§£æï¼Œå¯èƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œå¯ä»¥åšä¿å­˜æˆ–è€…è¿›ä¸€æ­¥çš„å¤„ç†ã€‚ä¿å­˜æ•°æ®ï¼šä¿å­˜å½¢å¼å¤šæ ·ï¼Œå¯ä»¥å­˜ä¸ºæ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥ä¿å­˜è‡³æ•°æ®åº“ï¼Œæˆ–è€…ä¿å­˜ç‰¹å®šæ ¼å¼çš„æ–‡ä»¶ã€‚ä¸ƒã€é™„å½•æºä»£ç è¯·çœ‹ä¸‹ä¸€ç¯‡","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"æ–‡ç« ","slug":"æ–‡ç« ","permalink":"http://ailous.top/tags/æ–‡ç« /"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"è±†ç“£ç”µå½±æ’è¡Œæ¦œæ•°æ®æŠ“å–ï¼ˆåˆçº§ï¼‰â€”â€”BS4","slug":"ç½‘ç»œçˆ¬è™«â€”â€”è±†ç“£ç”µå½±æ’è¡Œæ¦œæ•°æ®æŠ“å–ï¼ˆåˆçº§ï¼‰","date":"2019-05-03T05:47:40.000Z","updated":"2020-05-27T07:45:02.050Z","comments":true,"path":"2019/05/03/wang-luo-pa-chong-dou-ban-dian-ying-pai-xing-bang-shu-ju-zhua-qu-chu-ji/","link":"","permalink":"http://ailous.top/2019/05/03/wang-luo-pa-chong-dou-ban-dian-ying-pai-xing-bang-shu-ju-zhua-qu-chu-ji/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”è±†ç“£ç”µå½±æ’è¡Œæ¦œæ•°æ®æŠ“å–ï¼ˆåˆçº§ï¼‰ç›®æ ‡ç½‘å€ï¼šè±†ç“£ç”µå½±æ’è¡Œï¼šhttps://movie.douban.com/top250?start= ç›®æ ‡æ•°æ®æè¿°ï¼šï¼ˆ1ï¼‰æ’åï¼ˆ2ï¼‰ç”µå½±åç§°ä»»åŠ¡æ˜ç»†ï¼š ï¼ˆ1ï¼‰ä½¿ç”¨requestsåº“å®ç°è¯¥ç½‘ç«™ç½‘é¡µæºä»£ç çš„è·å–ï¼› ï¼ˆ2ï¼‰ä½¿ç”¨BeautifulSoupå¯¹è·å–çš„æºä»£ç è¿›è¡Œè§£æï¼Œå¹¶æˆåŠŸæ‰¾åˆ°ç›®æ ‡æ•°æ®æ‰€åœ¨çš„ç‰¹å®šæ ‡ç­¾ï¼Œè¿›è¡Œç½‘é¡µç»“æ„çš„è§£æï¼› ï¼ˆ3ï¼‰å®šä¹‰å‡½æ•°ï¼Œå°†è·å–çš„ç›®æ ‡æ•°æ®æ‰“å°è¾“å‡ºï¼Œæœ‰èƒ½åŠ›çš„åŒå­¦å¯ä»¥è¯•ç€å°†ç»“æœå†™å…¥æ–‡ä»¶ä¸­ã€‚ ï¼ˆ4ï¼‰ä½¿ç”¨æ¡†æ¶å¼ç»“æ„ï¼Œé€šè¿‡å‚æ•°ä¼ é€’å®ç°æ•´ä¸ªç‰¹å®šæ•°æ®çš„çˆ¬å–ã€‚ å¯ä»¥é€‰æ‹©å®šä¹‰å…¨å±€åˆ—è¡¨ï¼Œå°†ç›®æ ‡æ•°æ®è·å–åæ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼ŒåŒæ—¶ï¼Œæ³¨æ„è§‚å¯Ÿåˆ†é¡µæ—¶urlçš„å˜åŒ–ï¼Œä»¥ä¾¿è·å–æ•´ä¸ªçš„æ’è¡Œæ¦œæ•°æ®ã€‚å»ºè®®é€šè¿‡forå¾ªç¯ä¼ é€’å˜åŒ–å‚æ•°å®ç°ã€‚ ä¸‹ä¸€é˜¶æ®µï¼Œç›®æ ‡æ•°æ®å¢åŠ å¯¼æ¼”ã€ä¸»æ¼”ã€è¯„ä»·äººæ•°ç­‰ä¿¡æ¯ï¼Œå°†å°½å¯èƒ½å¤šçš„æ•°æ®æŠ“å–ä¿å­˜ã€‚ æºç import requests from bs4 import BeautifulSoup import bs4 def getHtmlText(url): headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding result=(result.text.replace('','')).replace('','') return result except: return \"\" def findUniverse(ulist , html): soup = BeautifulSoup(html,\"html.parser\") list = [0,0] for li in soup.find(attrs=['class','grid_view']).children: if isinstance(li ,bs4.element.Tag): list[0] = li.find('em').string list[1] = li.find(attrs=['class','title']).string ulist.append([list[0],list[1]]) def printUniverse(ulist): tplt = '{0:^10}\\t{1:^10}' print(tplt.format(\"æ’å\",\"ç”µå½±åç§°\",chr(12288))) for i in range(len(ulist)): u = ulist[i] print(tplt.format(u[0],u[1],chr(12288))) def main(): ulist = [] url = 'https://movie.douban.com/top250?start=' html = getHtmlText(url) findUniverse(ulist,html) printUniverse(ulist) main() è¾“å‡ºå¦‚ä¸‹ï¼š","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"BS4","slug":"BS4","permalink":"http://ailous.top/tags/BS4/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”æŠ“å–TIOBEæŒ‡æ•°å‰20åæ’è¡Œå¼€å‘è¯­è¨€","slug":"ç½‘ç»œçˆ¬è™«â€”â€”æŠ“å–TIOBEæŒ‡æ•°å‰20åæ’è¡Œå¼€å‘è¯­è¨€","date":"2019-04-27T05:47:40.000Z","updated":"2020-05-27T07:44:38.010Z","comments":true,"path":"2019/04/27/wang-luo-pa-chong-zhua-qu-tiobe-zhi-shu-qian-20-ming-pai-xing-kai-fa-yu-yan/","link":"","permalink":"http://ailous.top/2019/04/27/wang-luo-pa-chong-zhua-qu-tiobe-zhi-shu-qian-20-ming-pai-xing-kai-fa-yu-yan/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”æŠ“å–TIOBEæŒ‡æ•°å‰20åæ’è¡Œå¼€å‘è¯­è¨€ç›®æ ‡ç½‘å€TIOBEæŒ‡æ•°å‰20åæ’è¡Œå¼€å‘è¯­è¨€ï¼šhttps://www.tiobe.com/tiobe-index/ è¯´æ˜ TIOBEæ’è¡Œæ¦œæ˜¯æ ¹æ®äº’è”ç½‘ä¸Šæœ‰ç»éªŒçš„ç¨‹åºå‘˜ã€è¯¾ç¨‹å’Œç¬¬ä¸‰æ–¹å‚å•†çš„æ•°é‡ï¼Œå¹¶ä½¿ç”¨æœç´¢å¼•æ“ï¼ˆå¦‚Googleã€Bingã€Yahoo!ï¼‰ä»¥åŠWikipediaã€Amazonã€YouTubeç»Ÿè®¡å‡ºæ’åæ•°æ®ï¼Œåªæ˜¯åæ˜ æŸä¸ªç¼–ç¨‹è¯­è¨€çš„çƒ­é—¨ç¨‹åº¦ï¼Œå¹¶ä¸èƒ½è¯´æ˜ä¸€é—¨ç¼–ç¨‹è¯­è¨€å¥½ä¸å¥½ï¼Œæˆ–è€…ä¸€é—¨è¯­è¨€æ‰€ç¼–å†™çš„ä»£ç æ•°é‡å¤šå°‘ã€‚ è¯¥æŒ‡æ•°å¯ä»¥ç”¨æ¥æ£€é˜…å¼€å‘è€…çš„ç¼–ç¨‹æŠ€èƒ½èƒ½å¦è·Ÿä¸Šè¶‹åŠ¿ï¼Œæˆ–æ˜¯å¦æœ‰å¿…è¦ä½œå‡ºæˆ˜ç•¥æ”¹å˜ï¼Œä»¥åŠä»€ä¹ˆç¼–ç¨‹è¯­è¨€æ˜¯åº”è¯¥åŠæ—¶æŒæ¡çš„ã€‚è§‚å¯Ÿè®¤ä¸ºï¼Œè¯¥æŒ‡æ•°ååº”çš„è™½å¹¶éå½“å‰æœ€æµè¡Œæˆ–åº”ç”¨æœ€å¹¿çš„è¯­è¨€ï¼Œä½†å¯¹ä¸–ç•ŒèŒƒå›´å†…å¼€å‘è¯­è¨€çš„èµ°åŠ¿ä»å…·æœ‰é‡è¦å‚è€ƒæ„ä¹‰ã€‚ ç›®æ ‡æ•°æ®ï¼šï¼ˆå¦‚ä¸Šè¡¨æ‰€ç¤ºï¼‰ ï¼ˆ1ï¼‰2020å¹´3æœˆçš„æ’åï¼ˆ2ï¼‰2019å¹´3æœˆæ’åï¼ˆ3ï¼‰ç¼–ç¨‹è¯­è¨€ï¼ˆ4ï¼‰è¯„åˆ†ï¼ˆ5ï¼‰å˜åŒ–ç‡ æ˜ç»†ï¼šï¼ˆ1ï¼‰ä½¿ç”¨urllibæˆ–è€…requestsåº“æŠ“å–ç›®æ ‡ç½‘é¡µä¸­çš„ç½‘é¡µæºä»£ç ï¼› ï¼ˆ2ï¼‰ä½¿ç”¨lxmlåº“ä¸­çš„xpathæ–¹æ³•è§£ææºä»£ç ï¼Œæå–ä¸Šé¢æ‰€ç¤ºçš„ç›®æ ‡æ•°æ®ï¼Œå¹¶æ‰“å°è¾“å‡ºï¼› ï¼ˆ3ï¼‰å°è¯•ç€ä½¿ç”¨try..exceptæ–¹æ³•åŠæ—¶æ•è·å¼‚å¸¸ã€‚ ï¼ˆ4ï¼‰å¯ä»¥å°è¯•å°†è·å–çš„æ•°æ®ä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚ æºç import requests from requests.exceptions import RequestException from lxml import etree def one_to_page(url): headers={ 'user-agent':'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.25 Safari/537.36 Core/1.70.3756.400 QQBrowser/10.5.4039.400' } try: response=requests.get(url,headers=headers) body=response.text return body except RequestException as e: print('request is error!',e) def parsePage(html): htmlNew = etree.HTML(html,etree.HTMLParser()) result = htmlNew.xpath('//table[contains(@class,\"table-top20\")]/tbody/tr//text()') pos = 0 for i in range(20): if i == 0: yield result[i:5] else: yield result[pos:pos+5] pos += 5 def printRank(data): for i in data: rank = { \"2020å¹´3æœˆ\":i[0], \"2019å¹´3æœˆ\":i[1], \"ç¼–ç¨‹è¯­è¨€\":i[2], \"è¯„åˆ†\":i[3], \"å˜åŒ–ç‡\":i[4], } print(rank) def printRankEasy(data): tplt = \"{0:^10}\\t{1:^10}\\t{2:^20}\\t{3:^10}\\t{4:^10}\" print(tplt.format(\"2020å¹´3æœˆ\",\"2019å¹´3æœˆ\",\"ç¼–ç¨‹è¯­è¨€\",\"è¯„åˆ†\",\"å˜åŒ–ç‡\",chr(12288))) for i in data: print(tplt.format(i[0],i[1],i[2],i[3],i[4],chr(12288))) def main(): url = 'https://www.tiobe.com/tiobe-index/' html = one_to_page(url) data = parsePage(html) printRankEasy(data) main() è¾“å‡ºå¦‚ä¸‹","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"Xpath","slug":"Xpath","permalink":"http://ailous.top/tags/Xpath/"},{"name":"TIOBEæŒ‡æ•°","slug":"TIOBEæŒ‡æ•°","permalink":"http://ailous.top/tags/TIOBEæŒ‡æ•°/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ä¸­å›½å¤§å­¦æ’åæ•°æ®æŠ“å–","slug":"ç½‘ç»œçˆ¬è™«â€”â€”ä¸­å›½å¤§å­¦æ’åæ•°æ®æŠ“å–","date":"2019-04-20T05:47:40.000Z","updated":"2020-05-27T07:44:20.249Z","comments":true,"path":"2019/04/20/wang-luo-pa-chong-zhong-guo-da-xue-pai-ming-shu-ju-zhua-qu/","link":"","permalink":"http://ailous.top/2019/04/20/wang-luo-pa-chong-zhong-guo-da-xue-pai-ming-shu-ju-zhua-qu/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”ä¸­å›½å¤§å­¦æ’åæ•°æ®æŠ“å–ç›®æ ‡ç½‘å€ä¸­å›½å¤§å­¦æ’åç½‘ï¼šhttp://www.zuihaodaxue.com/zuihaodaxuepaiming2019.html å…¨çƒæœ‰å¾ˆå¤šä»½å¤§å­¦æ’åï¼Œè¿™é‡Œä»¥ä¸Šæµ·äº¤é€šå¤§å­¦ç ”å‘çš„â€œè½¯ç§‘ä¸­å›½æœ€å¥½å¤§å­¦æ’å2019â€ä¸ºä¾‹ï¼Œï¼Œç¼–å†™â€œå¤§å­¦æ’åçˆ¬è™«â€ï¼Œä»ç½‘ç»œä¸Šè·å–æ•°æ® ã€‚æ‹Ÿä»è¯¥ç½‘å€çˆ¬å–è¯¥åå•ä¸Š310 æ‰€å›½å†…å¤§å­¦çš„æ’åæ•°æ®ï¼Œå¹¶å°†å®ƒä»¬æ‰“å°å‡ºæ¥ã€‚ å¤§å­¦æ’åçˆ¬è™«çš„æ„å»ºéœ€è¦ä¸‰ä¸ªé‡è¦æ­¥éª¤ï¼š ç¬¬ä¸€ï¼Œä»ç½‘ç»œä¸Šè·å–ç½‘é¡µå†…å®¹ï¼› ç¬¬äºŒï¼Œåˆ†æç½‘é¡µå†…å®¹å¹¶æå–æœ‰ç”¨æ•°æ®åˆ°æ°å½“çš„æ•°æ®ç»“æ„ä¸­ï¼› ç¬¬ä¸‰ï¼Œåˆ©ç”¨æ•°æ®ç»“æ„å±•ç¤ºæˆ–è¿›ä¸€æ­¥å¤„ç†æ•°æ®ã€‚ ç”±äºå¤§å­¦æ’åæ˜¯ä¸€ä¸ªå…¸å‹çš„äºŒç»´æ•°æ®ï¼Œå› æ­¤ï¼Œé‡‡ç”¨äºŒç»´åˆ—è¡¨å­˜å‚¨è¯¥æ’åæ‰€æ¶‰åŠçš„è¡¨å•æ•°æ®ã€‚å…·ä½“æ¥è¯´ï¼Œé‡‡ç”¨requests åº“çˆ¬å–ç½‘é¡µå†…å®¹ï¼Œä½¿ç”¨beautifulsoup4 åº“åˆ†æç½‘é¡µä¸­æ•°æ®ï¼Œæå–310 ä¸ªå­¦æ ¡çš„æ’ååŠç›¸å…³æ•°æ®ï¼Œå­˜å‚¨åˆ°äºŒç»´åˆ—è¡¨ä¸­ï¼Œæœ€åé‡‡ç”¨ç”¨æˆ·åå¥½çš„æ–¹å¼æ‰“å°å‡ºæ¥ã€‚ æºç import requests from bs4 import BeautifulSoup import bs4 def getHtmlText(url): try: result = requests.get(url,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return \"\" def findUniverse(ulist , html): soup = BeautifulSoup(html,\"html.parser\") for tr in soup.find(attrs=['class','hidden_zhpm']).children: if isinstance(tr ,bs4.element.Tag): tds = tr('td') ulist.append([tds[0].string, tds[1].string,tds[3].string ]) def printUniverse(ulist): tplt = '{0:^10}\\t{1:{3}^10}\\t{2:^10}' print(tplt.format(\"æ’å\",\"å­¦æ ¡åç§°\",\"æ€»åˆ†\",chr(12288))) for i in range(len(ulist)): u = ulist[i] print(tplt.format(u[0],u[1],u[2],chr(12288))) def main(): ulist = [] url = 'http://www.zuihaodaxue.com/zuihaodaxuepaiming2019.html' html = getHtmlText(url) findUniverse(ulist,html) printUniverse(ulist) main() ç»“æœè¾“å‡ºå¦‚ä¸‹ï¼š","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"BS4","slug":"BS4","permalink":"http://ailous.top/tags/BS4/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”å‰ç¨‹æ— å¿§ç½‘æ•°æ®è·å–åŠå­˜å‚¨ï¼ˆä½çº§ï¼‰","slug":"ç½‘ç»œçˆ¬è™«â€”â€”å‰ç¨‹æ— å¿§ç½‘æ•°æ®è·å–åŠå­˜å‚¨ï¼ˆä½çº§ï¼‰","date":"2019-04-10T05:47:40.000Z","updated":"2020-05-27T07:44:32.329Z","comments":true,"path":"2019/04/10/wang-luo-pa-chong-qian-cheng-wu-you-wang-shu-ju-huo-qu-ji-cun-chu-di-ji/","link":"","permalink":"http://ailous.top/2019/04/10/wang-luo-pa-chong-qian-cheng-wu-you-wang-shu-ju-huo-qu-ji-cun-chu-di-ji/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”å‰ç¨‹æ— å¿§ç½‘æ•°æ®è·å–åŠå­˜å‚¨ï¼ˆä½çº§ï¼‰ç›®æ ‡ç½‘ç«™ï¼šå‰ç¨‹æ— å¿§æ‹›è˜ç½‘ç›®æ ‡ç½‘å€ï¼šhttps://search.51job.com/list/120000,000000,0000,00,9,99,Python,2,1.html ç›®æ ‡æ•°æ®ï¼šï¼ˆ1ï¼‰èŒä½åï¼ˆ2ï¼‰å…¬å¸åï¼ˆ3ï¼‰å·¥ä½œåœ°ç‚¹ï¼ˆ4ï¼‰è–ªèµ„ ï¼ˆ5ï¼‰å‘å¸ƒæ—¶é—´ ä»»åŠ¡è¦æ±‚ ï¼ˆ1ï¼‰ä½¿ç”¨urllibæˆ–requestsåº“å®ç°è¯¥ç½‘ç«™ç½‘é¡µæºä»£ç çš„è·å–ï¼Œå¹¶å°†æºä»£ç è¿›è¡Œä¿å­˜ï¼› ï¼ˆ2ï¼‰é€šè¿‡Xpathè§£ææ–¹æ³•å¯¹ä¿å­˜çš„çš„æºä»£ç è¯»å–å¹¶è¿›è¡Œè§£æï¼ŒæˆåŠŸæ‰¾åˆ°ç›®æ ‡æ•°æ®æ‰€åœ¨çš„ç‰¹å®šæ ‡ç­¾ï¼Œè¿›è¡Œç½‘é¡µç»“æ„çš„è§£æï¼› ï¼ˆ3ï¼‰å®šä¹‰å‡½æ•°ï¼Œå°†è·å–çš„ç›®æ ‡æ•°æ®ä¿å­˜åˆ°txtæ–‡æœ¬æ–‡ä»¶ä¸­ã€‚ è¿™é‡Œä½¿ç”¨çš„æ˜¯Xpathï¼Œç›¸å¯¹äºä¹‹å‰çŒ«çœ¼ç”µå½±ä½¿ç”¨çš„ï¼Œè¿™ä¸ªè¾ƒä¸ºç®€å•ï¼Œä½†æ˜¯æ•°æ®å¤„ç†ä¸Šè¾ƒä¸ºå¤æ‚ã€‚ æºç import requests import json import csv from requests.exceptions import RequestException from lxml import etree def getHtmlText(url): headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 Edg/80.0.361.69' } try: result = requests.get(url,headers=headers,timeout=30) result.raise_for_status() result.encoding = result.apparent_encoding return result.text except: return \"\" def parsePage(html): ulist = [] clist = [] rlist = [] newhtml =etree.HTML(html,etree.HTMLParser()) result=newhtml.xpath('//*[@id=\"resultList\"]/div[@class=\"el\"]//text()') for i in range(len(result)): ulist.append(result[i].replace(\" \",\"\").replace('\\r',\"\").replace(\"\\n\",'')) while '' in ulist: ulist.remove('') length = len(ulist) weight = int(length / 5 ) for i in range(weight): for j in range(5): clist.append(ulist[i*5+j]) rlist.append(clist) clist = [] return rlist # def txtdata(data): # with open('top20.txt','w')as file: # for i in data: # for j in i: # print(j) # print('successful') def storedata(data): with open('top20.txt','w',encoding = 'utf-8')as file: for i in data: file.write(json.dumps(i,ensure_ascii=False)+'\\n') print('ok') def csvdata(data): with open('top20.csv','w',encoding = 'utf-8',newline='')as csvfile: fieldnames = ['èŒä½å','å…¬å¸å','å·¥ä½œåœ°ç‚¹','è–ªèµ„','å·¥ä½œæ—¶é—´'] writer = csv.DictWriter(csvfile,fieldnames=fieldnames) writer.writeheader() for i in data: writer.writerow({'èŒä½å':i[0],'å…¬å¸å':i[1],'å·¥ä½œåœ°ç‚¹':i[2],'è–ªèµ„':i[3],'å·¥ä½œæ—¶é—´':i[4]}) print('ok') def main(): url=\"https://search.51job.com/list/120000,000000,0000,00,9,99,Python,2,1.html\" html=getHtmlText(url) rlist=parsePage(html) # txtdata(data) storedata(rlist) csvdata(rlist) main()","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"Xpath","slug":"Xpath","permalink":"http://ailous.top/tags/Xpath/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"äººå·¥æ™ºèƒ½â€”â€”mnistï¼ˆæ‰‹å†™è¯†åˆ«ï¼‰","slug":"äººå·¥æ™ºèƒ½â€”â€”mnistï¼ˆæ‰‹å†™è¯†åˆ«ï¼‰","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:35:59.218Z","comments":true,"path":"2018/12/09/ren-gong-zhi-neng-mnist-shou-xie-shi-bie/","link":"","permalink":"http://ailous.top/2018/12/09/ren-gong-zhi-neng-mnist-shou-xie-shi-bie/","excerpt":"","text":"äººå·¥æ™ºèƒ½â€”â€”mnistï¼ˆæ‰‹å†™è¯†åˆ«ï¼‰å› ä¸ºæ—¶é—´è¾ƒä¹…äº†ï¼Œå°±ä¸è¯¦ç»†ä»‹ç»äº†ã€‚ç®€å•çš„è¯´ï¼Œä¸€å¼€å§‹å¯¹å·²æœ‰çš„å¤§é‡æ•°å­—å›¾ç‰‡è¿›è¡Œè®­ç»ƒç”Ÿæˆæ¨¡å‹ã€‚ç„¶åé€šè¿‡å¯¹ä¸€å¼ æ‰‹å†™çš„æ•°å­—å›¾ç‰‡è¿›è¡Œè¯»å–ï¼Œè¿›å…¥æ¨¡å‹åŒ¹é…ï¼Œè¾“å‡ºç»“æœã€‚ æºç # Python3 # ä½¿ç”¨LeNet5çš„ä¸ƒå±‚å·ç§¯ç¥ç»ç½‘ç»œç”¨äºMNISTæ‰‹å†™æ•°å­—è¯†åˆ« import tensorflow as tf from tensorflow.examples.tutorials.mnist import input_data mnist = input_data.read_data_sets(\"MNIST_data\", one_hot=True) # ä¸ºè¾“å…¥å›¾åƒå’Œç›®æ ‡è¾“å‡ºç±»åˆ«åˆ›å»ºèŠ‚ç‚¹ x = tf.placeholder(tf.float32, shape=[None, 784]) # è®­ç»ƒæ‰€éœ€æ•°æ® å ä½ç¬¦ y_ = tf.placeholder(tf.float32, shape=[None, 10]) # è®­ç»ƒæ‰€éœ€æ ‡ç­¾æ•°æ® å ä½ç¬¦ # *************** æ„å»ºå¤šå±‚å·ç§¯ç½‘ç»œ *************** # # æƒé‡ã€åç½®ã€å·ç§¯åŠæ± åŒ–æ“ä½œåˆå§‹åŒ–,ä»¥é¿å…åœ¨å»ºç«‹æ¨¡å‹çš„æ—¶å€™åå¤åšåˆå§‹åŒ–æ“ä½œ def weight_variable(shape): initial = tf.truncated_normal(shape, stddev=0.1) # å–éšæœºå€¼ï¼Œç¬¦åˆå‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®stddevä¸º0.1 return tf.Variable(initial) def bias_variable(shape): initial = tf.constant(0.1, shape=shape) return tf.Variable(initial) # x çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå›¾ç‰‡çš„æ•°é‡ï¼Œç¬¬äºŒã€ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºå›¾ç‰‡é«˜åº¦å’Œå®½åº¦ï¼Œç¬¬å››ä¸ªå‚æ•°ä¸ºå›¾ç‰‡é€šé“æ•°ã€‚ # W çš„å‰ä¸¤ä¸ªå‚æ•°ä¸ºå·ç§¯æ ¸å°ºå¯¸ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºå›¾åƒé€šé“æ•°ï¼Œç¬¬å››ä¸ªå‚æ•°ä¸ºå·ç§¯æ ¸æ•°é‡ # stridesä¸ºå·ç§¯æ­¥é•¿ï¼Œå…¶ç¬¬ä¸€ã€å››ä¸ªå‚æ•°å¿…é¡»ä¸º1ï¼Œå› ä¸ºå·ç§¯å±‚çš„æ­¥é•¿åªå¯¹çŸ©é˜µçš„é•¿å’Œå®½æœ‰æ•ˆ # paddingè¡¨ç¤ºå·ç§¯çš„å½¢å¼ï¼Œå³æ˜¯å¦è€ƒè™‘è¾¹ç•Œã€‚\"SAME\"æ˜¯è€ƒè™‘è¾¹ç•Œï¼Œä¸è¶³çš„æ—¶å€™ç”¨0å»å¡«å……å‘¨å›´ï¼Œ\"VALID\"åˆ™ä¸è€ƒè™‘ def conv2d(x, W): return tf.nn.conv2d(x, W, strides=[1, 1, 1, 1], padding='SAME') # x å‚æ•°çš„æ ¼å¼åŒtf.nn.conv2dä¸­çš„xï¼Œksizeä¸ºæ± åŒ–å±‚è¿‡æ»¤å™¨çš„å°ºåº¦ï¼Œstridesä¸ºè¿‡æ»¤å™¨æ­¥é•¿ def max_pool_2x2(x): return tf.nn.max_pool(x, ksize=[1, 2, 2, 1], strides=[1, 2, 2, 1], padding='SAME') #æŠŠxæ›´æ”¹ä¸º4ç»´å¼ é‡ï¼Œç¬¬1ç»´ä»£è¡¨æ ·æœ¬æ•°é‡ï¼Œç¬¬2ç»´å’Œç¬¬3ç»´ä»£è¡¨å›¾åƒé•¿å®½ï¼Œ ç¬¬4ç»´ä»£è¡¨å›¾åƒé€šé“æ•° x_image = tf.reshape(x, [-1,28,28,1]) # -1è¡¨ç¤ºä»»æ„æ•°é‡çš„æ ·æœ¬æ•°,å¤§å°ä¸º28x28ï¼Œæ·±åº¦ä¸º1çš„å¼ é‡ # ç¬¬ä¸€å±‚ï¼šå·ç§¯ W_conv1 = weight_variable([5, 5, 1, 32]) # å·ç§¯åœ¨æ¯ä¸ª5x5çš„patchä¸­ç®—å‡º32ä¸ªç‰¹å¾ã€‚ b_conv1 = bias_variable([32]) h_conv1 = tf.nn.relu(conv2d(x_image, W_conv1) + b_conv1) # ç¬¬äºŒå±‚ï¼šæ± åŒ– h_pool1 = max_pool_2x2(h_conv1) # ç¬¬ä¸‰å±‚ï¼šå·ç§¯ W_conv2 = weight_variable([5, 5, 32, 64]) b_conv2 = bias_variable([64]) h_conv2 = tf.nn.relu(conv2d(h_pool1, W_conv2) + b_conv2) # ç¬¬å››å±‚ï¼šæ± åŒ– h_pool2 = max_pool_2x2(h_conv2) # ç¬¬äº”å±‚ï¼šå…¨è¿æ¥å±‚ W_fc1 = weight_variable([7 * 7 * 64, 1024]) b_fc1 = bias_variable([1024]) h_pool2_flat = tf.reshape(h_pool2, [-1, 7*7*64]) h_fc1 = tf.nn.relu(tf.matmul(h_pool2_flat, W_fc1) + b_fc1) # åœ¨è¾“å‡ºå±‚ä¹‹å‰åŠ å…¥dropoutä»¥å‡å°‘è¿‡æ‹Ÿåˆ keep_prob = tf.placeholder(\"float\") h_fc1_drop = tf.nn.dropout(h_fc1, keep_prob) # ç¬¬å…­å±‚ï¼šå…¨è¿æ¥å±‚ W_fc2 = weight_variable([1024, 10]) b_fc2 = bias_variable([10]) # ç¬¬ä¸ƒå±‚ï¼šè¾“å‡ºå±‚ y_conv=tf.nn.softmax(tf.matmul(h_fc1_drop, W_fc2) + b_fc2) # *************** è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹ *************** # # ä¸ºè®­ç»ƒè¿‡ç¨‹æŒ‡å®šæœ€å°åŒ–è¯¯å·®ç”¨çš„æŸå¤±å‡½æ•°ï¼Œå³ç›®æ ‡ç±»åˆ«å’Œé¢„æµ‹ç±»åˆ«ä¹‹é—´çš„äº¤å‰ç†µ cross_entropy = -tf.reduce_sum(y_*tf.log(y_conv)) # ä½¿ç”¨åå‘ä¼ æ’­ï¼Œåˆ©ç”¨ä¼˜åŒ–å™¨ä½¿æŸå¤±å‡½æ•°æœ€å°åŒ– train_step = tf.train.AdamOptimizer(1e-4).minimize(cross_entropy) # æ£€æµ‹æˆ‘ä»¬çš„é¢„æµ‹æ˜¯å¦çœŸå®æ ‡ç­¾åŒ¹é…(ç´¢å¼•ä½ç½®ä¸€æ ·è¡¨ç¤ºåŒ¹é…) # tf.argmax(y_conv,dimension), è¿”å›æœ€å¤§æ•°å€¼çš„ä¸‹æ ‡ é€šå¸¸å’Œtf.equal()ä¸€èµ·ä½¿ç”¨ï¼Œè®¡ç®—æ¨¡å‹å‡†ç¡®åº¦ # dimension=0 æŒ‰åˆ—æ‰¾ dimension=1 æŒ‰è¡Œæ‰¾ correct_prediction = tf.equal(tf.argmax(y_conv,1), tf.argmax(y_,1)) # ç»Ÿè®¡æµ‹è¯•å‡†ç¡®ç‡ï¼Œ å°†correct_predictionçš„å¸ƒå°”å€¼è½¬æ¢ä¸ºæµ®ç‚¹æ•°æ¥ä»£è¡¨å¯¹ã€é”™ï¼Œå¹¶å–å¹³å‡å€¼ã€‚ accuracy = tf.reduce_mean(tf.cast(correct_prediction, \"float\")) saver = tf.train.Saver() # å®šä¹‰saver # *************** å¼€å§‹è®­ç»ƒæ¨¡å‹ *************** # with tf.Session() as sess: sess.run(tf.global_variables_initializer()) for i in range(1000): batch = mnist.train.next_batch(50) if i%100 == 0: # è¯„ä¼°æ¨¡å‹å‡†ç¡®åº¦ï¼Œæ­¤é˜¶æ®µä¸ä½¿ç”¨Dropout train_accuracy = accuracy.eval(feed_dict={x:batch[0], y_: batch[1], keep_prob: 1.0}) print(\"step %d, training accuracy %g\"%(i, train_accuracy)) # è®­ç»ƒæ¨¡å‹ï¼Œæ­¤é˜¶æ®µä½¿ç”¨50%çš„Dropout train_step.run(feed_dict={x: batch[0], y_: batch[1], keep_prob: 0.5}) saver.save(sess, './save/model.ckpt') #æ¨¡å‹å‚¨å­˜ä½ç½® print(\"test accuracy %g\"%accuracy.eval(feed_dict={x: mnist.test.images [0:2000], y_: mnist.test.labels [0:2000], keep_prob: 1.0}))","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://ailous.top/categories/äººå·¥æ™ºèƒ½/"}],"tags":[{"name":"æ‰‹å†™è¯†åˆ«","slug":"æ‰‹å†™è¯†åˆ«","permalink":"http://ailous.top/tags/æ‰‹å†™è¯†åˆ«/"},{"name":"mnist","slug":"mnist","permalink":"http://ailous.top/tags/mnist/"}],"keywords":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://ailous.top/categories/äººå·¥æ™ºèƒ½/"}]},{"title":"åµŒå…¥å¼â€”LM3S1138ä»‹ç»","slug":"åµŒå…¥å¼â€”LM3S1138ä»‹ç»","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:31:17.598Z","comments":true,"path":"2018/12/09/qian-ru-shi-lm3s1138-jie-shao/","link":"","permalink":"http://ailous.top/2018/12/09/qian-ru-shi-lm3s1138-jie-shao/","excerpt":"","text":"åµŒå…¥å¼â€”LM3S1138ä»‹ç»è¿™æ˜¯æˆ‘ç”¨çš„è¾ƒä¹…çš„ä¸€æ¬¾èŠ¯ç‰‡ï¼Œæ— è®ºæ˜¯ç”µèµ›è¿˜æ˜¯è¯¾ç¨‹è®¾è®¡ï¼Œå…¼å®¹æ€§éƒ½å¾ˆå¥½ï¼Œç°åœ¨æƒ³æŠŠæ‰€æœ‰æ•°æ®æ•´ç†ä¸€ä¸‹ï¼Œè¿™æ˜¯å¼€å‘æ¿çš„ç›¸å…³æ–‡æ¡£ã€‚åé¢ä¼šæœ‰ç›¸å…³ä»£ç ä»‹ç»ï¼Œå’Œæ¡ˆä¾‹ä»‹ç»ã€‚ EasyARM1138â€”â€”å†…åµŒ USB ä»¿çœŸå™¨çš„ Cortex-M3 å¼€å‘æ¿ EasyARM1138 æ˜¯ä¸“é—¨é’ˆå¯¹å¹¿å¤§ç”µå­ä¿¡æ¯ä¸“ä¸šåœ¨æ ¡å¤§å­¦ç”Ÿè€Œè®¾è®¡çš„ä¸€æ¬¾åŸºäº ARMCortexâ„¢-M3 å…ˆè¿›å†…æ ¸çš„é«˜æ€§èƒ½ã€ä½ä»·æ ¼å¼€å‘æ¿ï¼Œç”¨äºæ•™å­¦ã€æ¯•ä¸šè®¾è®¡ã€ç”µå­ç«èµ›ï¼Œç­‰ç­‰ã€‚ä¹Ÿæ˜¯å¹¿å¤§å•ç‰‡æœºçˆ±å¥½è€…ã€å¼€å‘å·¥ç¨‹å¸ˆé¦–é€‰çš„ Cortexâ„¢-M3 å¼€å‘æ¿ã€‚ EasyARM1138 çš„æ ¸å¿ƒMCUæ˜¯ç¾å›½Luminary Microå…¬å¸çš„StellarisÂ®ï¼ˆç¾¤æ˜Ÿï¼‰ç³»åˆ—ARMä¹‹LM3S1138ã€‚è¯¥èŠ¯ç‰‡é‡‡ç”¨çš„æ˜¯å›½é™…ä¸Šæœ€ä¼˜ç§€çš„MCUå†…æ ¸è®¾è®¡å…¬å¸ARMæœ€æ–°æ¨å‡ºçš„å…ˆè¿›Cortexâ„¢-M3 å¤„ç†å™¨ï¼›ç”±å›½å†…æœ€å¤§ã€æŠ€æœ¯æœ€å¼ºçš„æ™¶åœ†åˆ¶é€ å…¬å¸å°ç§¯ç”µï¼ˆTSMCï¼‰ä»£å·¥ï¼›ç»ä¸–ç•Œä¸Šæœ€ä¸“ä¸šçš„å°è£…æµ‹è¯•å…¬å¸ï¼ˆOSEã€i2a/IPACï¼‰å±‚å±‚æŠŠå…³ï¼Œç¡®ä¿äº§å“çš„å¯é æ€§ã€‚StellarisÂ®ï¼ˆç¾¤æ˜Ÿï¼‰ ç³»åˆ—ARMèŠ¯ç‰‡åœ¨ç”µç£å…¼å®¹æ€§æ–¹é¢çš„ä¼˜åŠ¿æ˜æ˜¾ã€‚ ã€äº§å“å›¾ç‰‡ã€‘ ã€åŠŸèƒ½ç‰¹ç‚¹ã€‘â— å¼ºå¤§çš„ MCU å†…æ ¸ â—† 32 ä½ ARM Cortexâ„¢-M3 å†…æ ¸ï¼ˆARM v7M æ¶æ„ï¼‰ â—† å…¼å®¹ Thumb çš„ Thumb-2 æŒ‡ä»¤é›†ï¼Œæé«˜ä»£ç å¯†åº¦ 25%ä»¥ä¸Š â—† 50MHz è¿è¡Œé¢‘ç‡ï¼Œ1.25 DMIPS/MHzï¼ŒåŠ å¿« 35%ä»¥ä¸Š â—† å•å‘¨æœŸä¹˜æ³•æŒ‡ä»¤ï¼Œ2ï½12 å‘¨æœŸç¡¬ä»¶é™¤æ³•æŒ‡ä»¤ â—† å¿«é€Ÿå¯åµŒå¥—ä¸­æ–­ï¼Œ6ï½12 ä¸ªæ—¶é’Ÿå‘¨æœŸ â—† å…·æœ‰ MPU ä¿æŠ¤è®¾å®šè®¿é—®è§„åˆ™ â—† 64KB å•å‘¨æœŸ Flash, 16KB å•å‘¨æœŸ SRAM â—† å†…ç½®å¯ç¼–ç¨‹çš„ LDO è¾“å‡º 2.25Vï½2.75Vï¼Œæ­¥è¿› 50mV â—† æ”¯æŒéå¯¹é½æ•°æ®çš„è®¿é—®ï¼Œæœ‰æ•ˆåœ°å‹ç¼©æ•°æ®åˆ°å†…å­˜ â—† æ”¯æŒä½æ“ä½œï¼Œæœ€å¤§é™åº¦ä½¿ç”¨å†…å­˜ï¼Œå¹¶æä¾›åˆ›æ–°çš„å¤–è®¾æ§åˆ¶ â—† å†…ç½®ç³»ç»ŸèŠ‚æ‹å®šæ—¶å™¨ï¼ˆSysTickï¼‰ï¼Œæ–¹ä¾¿æ“ä½œç³»ç»Ÿç§»æ¤ â— ä¸°å¯Œçš„å¤–è®¾èµ„æº â—† 7 ç»„ GPIOï¼Œå¯é…ç½®ä¸ºè¾“å…¥ã€è¾“å‡ºã€å¼€æ¼ã€å¼±ä¸Šæ‹‰ç­‰æ¨¡å¼ â—† 4 ä¸ª 32 ä½ Timerï¼Œæ¯ä¸ªéƒ½å¯æ‹†åˆ†ä¸º 2 ä¸ªç‹¬ç«‹çš„ 16 ä½å­å®šæ—¶å™¨ï¼Œ å…·æœ‰å®šæ—¶ã€æ•è·ã€PWMã€RTC ç­‰ä¸°å¯ŒåŠŸèƒ½ â—† 3 è·¯å…¨åŒå·¥ UARTï¼Œä½é€Ÿç‡é«˜è¾¾ 3.125Mbpsï¼Œ16 å•å…ƒæ¥æ”¶ FIFO å’Œå‘é€ FIFOï¼Œæ”¯æŒä¸²è¡Œçº¢å¤–åè®®ï¼ˆIrDA SIRï¼‰ â—† 2 è·¯I2Cï¼Œæ”¯æŒ 100kbpsæ ‡å‡†æ¨¡å¼ã€400kbpså¿«é€Ÿæ¨¡å¼ â—† 2 è·¯ SSIï¼Œå…¼å®¹ Freescale SPIã€MICROWIREã€Texas Instruments ä¸²è¡Œé€šä¿¡åè®®ï¼Œä½é€Ÿç‡é«˜è¾¾ 25Mbps â—† 6 è·¯ 16 ä½ PWMï¼Œé€šè¿‡ CCP ç®¡è„šèƒ½äº§ç”Ÿé«˜è¾¾ 25MHz çš„æ–¹æ³¢ â—† 3 ä¸ªæ¨¡æ‹Ÿæ¯”è¾ƒå™¨ â—† 8 é€šé“ 10 ä½ ADCï¼Œé‡‡æ ·é€Ÿç‡å¯è¾¾ 1M/sï¼Œé™„å¸¦æ¸©åº¦ä¼ æ„Ÿå™¨ â—† å†…ç½®çœ‹é—¨ç‹—å®šæ—¶å™¨ï¼ˆWatchDog Timerï¼‰ï¼Œç¡®ä¿èŠ¯ç‰‡å¯é è¿è¡Œ â— å†…åµŒ USB æ¥å£çš„ä¸‹è½½ä»¿çœŸå™¨ â—† ä»…éœ€æ’å…¥ä¸€æ ¹ USB ç”µç¼†å°±èƒ½å®ç°â€œä¸‰åˆä¸€â€åŠŸèƒ½ï¼š 5V ä¾›ç”µã€ç¨‹åºä¸‹è½½ä¸åœ¨çº¿ä»¿çœŸã€UART ä¸²è¡Œé€šä¿¡ â—† ä¸å†è¦æ±‚ç”µè„‘å…·æœ‰ä¸²å£æˆ–å¹¶å£ï¼Œæ— è®ºå°å¼æœºè¿˜æ˜¯ç¬”è®°æœ¬ç”µè„‘ï¼Œ åªè¦æ‹¥æœ‰ USB 1.1 æˆ– USB 2.0 æ¥å£å°±èƒ½è¿ç”¨è‡ªå¦‚ â—† é™¤äº†èƒ½å¤Ÿä¸‹è½½ä»¿çœŸè‡ªèº«ä»¥å¤–ï¼Œä¿ç•™çš„ JTAG æ¥å£è¿˜å¯ä»¥ ç”¨æ¥ä»¿çœŸå…¶å®ƒ LM3S ç³»åˆ—å¼€å‘æ¿ï¼ŒçŸ­æ¥ JP2 çŸ­æ¥å™¨çš„GND å’Œ U-RSTï¼Œè¿˜å¯å®ç° JTAG æ¥å£å¯¹å†…ä»¿çœŸåŠŸèƒ½ â—† USB æ¥å£æä¾›è™šæ‹Ÿ UART çš„åŠŸèƒ½ï¼Œä¸éœ€è¦é¢å¤–çš„æ¥å£ç”µè·¯ â— ç®€æ˜çš„å¤–å›´ç”µè·¯è®¾è®¡ï¼Œè°ƒè¯•æ—¶æ— éœ€ä»»ä½•è¿çº¿å’Œè·³çº¿ï¼Œæ“ä½œæä¸ºæ–¹ä¾¿ â—† 5 åª LED æŒ‡ç¤ºç¯ â—† 3 åª KEY â—† 1 åªäº¤æµèœ‚é¸£å™¨ï¼Œå¯æ¼”å¥åŠ¨å¬ä¹æ›²ï¼Œå¦‚ã€Šæ¢ç¥ã€‹ â—† ä¸¤æ’æ’é’ˆå¼•å‡ºå…¨éƒ¨ GPIO èµ„æºï¼Œä»¥åŠ ADC0ï½7ã€5V/3.3V/GND â—† GPIO æ’é’ˆé—´è·æ­£å¥½ä¸º 2000mil(50.8mm)ï¼Œå¾ˆå®¹æ˜“æ’æ¥åœ¨ä¸‡ç”¨æ¿ æˆ–å…¶å®ƒè‡ªåˆ¶çš„ç”µè·¯æ¿ä¸Šï¼Œä¸ºæ•™å­¦å®éªŒæä¾›äº†æå¤§æ–¹ä¾¿ â— åœ¨è½¯ä»¶ä¸Šé‡‡ç”¨â€œC è¯­è¨€ï¼‹é©±åŠ¨åº“â€çš„æ–°æ¦‚å¿µå¼€å‘æ¨¡å¼ ç”±äº Luminary Micro å®˜æ–¹å…è´¹æä¾›äº†åŸºäº C è¯­è¨€ï¼ˆç¬¦åˆ ANSI C æ ‡å‡†ï¼‰çš„é©±åŠ¨åº“è½¯ä»¶åŒ…ï¼Œå¹¶ä¸”æºä»£ç æ˜¯å…¬å¼€çš„ï¼Œå› æ­¤ç”¨æˆ·å®Œå…¨å¯ä»¥æ‘’å¼ƒæ™¦æ¶©éš¾æ‡‚çš„æ±‡ç¼–è¯­è¨€ï¼Œä¹Ÿä¸éœ€è¦æŒæ¡åº•å±‚å¯„å­˜å™¨çš„æ“ä½œç»†èŠ‚ï¼Œåªè¦æ‡‚ C è¯­è¨€å°±èƒ½è½»æ¾ç©è½¬ LM3S ç³»åˆ— ARMã€‚è¿™ä¹Ÿä½¿å¾— 32 ä½ ARM çš„å…¥é—¨é—¨æ§›å¤§å¤§é™ä½ã€‚ä»¥ä¸‹æ˜¯æ“ä½œ GPIO ç«¯å£ç‚¹äº® LED çš„ç¤ºä¾‹ï¼Œéå¸¸ç®€æ·ï¼š SysCtlPeriEnable(SYSCTL_PERIPH_GPIOG); // ç¬¬ 1 æ­¥ï¼šä½¿èƒ½ GPIOG ç«¯å£GPIOPinTypeOut(GPIO_PORTG_BASE , GPIO_PIN_3); // ç¬¬ 2 æ­¥ï¼šè®¾ç½® PG3 ä¸ºè¾“å‡ºGPIOPinWrite(GPIO_PORTG_BASE , GPIO_PIN_3 , 0x00); // ç¬¬ 3 æ­¥ï¼šä»¤ PG3 = 0ï¼Œç‚¹äº® LED â— ä»åŸºç¡€å®éªŒåˆ°è¯¾é¢˜è®¾è®¡ â—† GPIO å®éªŒï¼šLED é—ªçƒå‘å…‰ã€GPIO ä¸­æ–­ã€æŒ‰é”®æ§åˆ¶ â—† Timer å®éªŒï¼šå®šæ—¶/è®¡æ•°ã€è„‰å†²æ•è·ã€RTC æ—¶é’Ÿã€PWM æ–¹æ³¢ â—† ä¸²è¡Œé€šä¿¡ï¼šUARTã€I2Cã€SSI(å…¼å®¹SPI)ã€RS-4852å¹¿å·è‡´è¿œç”µå­æœ‰é™å…¬å¸ ç”µè¯ï¼š020-22644252 ä¼ çœŸï¼š020-38601859 http://www.embedtools.com â—† ä¸²è¡Œçº¢å¤–é€šä¿¡å®éªŒï¼ˆIrDA SIRï¼‰ â—† æ¨¡æ‹ŸåŠŸèƒ½ï¼šæ¨¡æ‹Ÿæ¯”è¾ƒå™¨ä¿¡å·æ£€æµ‹ï¼Œ10 ä½ ADC æ•°æ®é‡‡é›† â—† ç‰‡å†…æ¸©åº¦ä¼ æ„Ÿå™¨å®éªŒ â—† å¤§å®¹é‡ SD å¡è¯»å†™å®éªŒ â—† æ”¯æŒå„ç±»ç”µæœºå®éªŒï¼šç›´æµç”µæœºã€æ­¥è¿›ç”µæœºã€ä¸‰ç›¸ç”µæœºï¼Œ æä¾›è¿åŠ¨æ§åˆ¶ PID ç®—æ³• â—† PWM è¯­éŸ³æ’­æ”¾ï¼šèƒ½å¤Ÿå¯¹å£°éŸ³ä¿¡å·è¿›è¡Œé‡‡é›†ã€å­˜å‚¨å’Œæ’­æ”¾ â— å¼€å‘è½¯ä»¶ â—† IAR Embedded Workbench for ARM 4.42A æˆ– 5.11(å†…åµŒ USB ä¸‹è½½ä»¿çœŸå™¨ï¼Œæ¨è) â—† Keil ÂµVision3(æ— éœ€ U-LINK ä»¿çœŸå™¨) â—† æ”¯æŒ ÂµC/OS II æ“ä½œç³»ç»Ÿ(æä¾›ç§»æ¤ä»£ç ) â—† æä¾›ã€ŠStellaris å¤–è®¾é©±åŠ¨åº“ã€‹å¿«é€Ÿå®‰è£…æ–¹æ³•åŠ C è¯­è¨€æºä»£ç ","categories":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}],"tags":[{"name":"1138","slug":"1138","permalink":"http://ailous.top/tags/1138/"}],"keywords":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}]},{"title":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆPWMï¼‰","slug":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆPWMï¼‰","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:38:05.460Z","comments":true,"path":"2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-pwm/","link":"","permalink":"http://ailous.top/2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-pwm/","excerpt":"","text":"è¿™äº›æ˜¯æˆ‘è‡ªå·±å¸¸ç”¨çš„ä»£ç ï¼Œæ¯”å®˜æ–¹çš„è¦ç®€æ´äº›ï¼Œä¸»è¦æ˜¯è‡ªç”¨ï¼Œè¿˜æœ‰ç›¸å…³æ¨¡å—ï¼Œä½¿ç”¨ä»£ç ã€‚ å…·ä½“æ–‡ä»¶å¯ä»¥å»æˆ‘githubä¸Šä¸‹è½½ã€‚ pwmç®€ä»‹ è„‰å†²å®½åº¦è°ƒåˆ¶æ˜¯åˆ©ç”¨å¾®å¤„ç†å™¨çš„æ•°å­—è¾“å‡ºæ¥å¯¹æ¨¡æ‹Ÿç”µè·¯è¿›è¡Œæ§åˆ¶çš„ä¸€ç§éå¸¸æœ‰æ•ˆçš„æŠ€æœ¯ï¼Œå¹¿æ³›åº”ç”¨åœ¨ä»æµ‹é‡ã€é€šä¿¡åˆ°åŠŸç‡æ§åˆ¶ä¸å˜æ¢çš„è®¸å¤šé¢†åŸŸä¸­ã€‚ è„‰å†²å®½åº¦è°ƒåˆ¶æ˜¯ä¸€ç§æ¨¡æ‹Ÿæ§åˆ¶æ–¹å¼ï¼Œå…¶æ ¹æ®ç›¸åº”è½½è·çš„å˜åŒ–æ¥è°ƒåˆ¶æ™¶ä½“ç®¡åŸºææˆ–MOSç®¡æ …æçš„åç½®ï¼Œæ¥å®ç°æ™¶ä½“ç®¡æˆ–MOSç®¡å¯¼é€šæ—¶é—´çš„æ”¹å˜ï¼Œä»è€Œå®ç°å¼€å…³ç¨³å‹ç”µæºè¾“å‡ºçš„æ”¹å˜ã€‚è¿™ç§æ–¹å¼èƒ½ä½¿ç”µæºçš„è¾“å‡ºç”µå‹åœ¨å·¥ä½œæ¡ä»¶å˜åŒ–æ—¶ä¿æŒæ’å®šï¼Œæ˜¯åˆ©ç”¨å¾®å¤„ç†å™¨çš„æ•°å­—ä¿¡å·å¯¹æ¨¡æ‹Ÿç”µè·¯è¿›è¡Œæ§åˆ¶çš„ä¸€ç§éå¸¸æœ‰æ•ˆçš„æŠ€æœ¯ã€‚ PWMæ§åˆ¶æŠ€æœ¯ä»¥å…¶æ§åˆ¶ç®€å•ï¼Œçµæ´»å’ŒåŠ¨æ€å“åº”å¥½çš„ä¼˜ç‚¹è€Œæˆä¸ºç”µåŠ›ç”µå­æŠ€æœ¯æœ€å¹¿æ³›åº”ç”¨çš„æ§åˆ¶æ–¹å¼ï¼Œä¹Ÿæ˜¯äººä»¬ç ”ç©¶çš„çƒ­ç‚¹ã€‚ç”±äºå½“ä»Šç§‘å­¦æŠ€æœ¯çš„å‘å±•å·²ç»æ²¡æœ‰äº†å­¦ç§‘ä¹‹é—´çš„ç•Œé™ï¼Œç»“åˆç°ä»£æ§åˆ¶ç†è®ºæ€æƒ³æˆ–å®ç°æ— è°æŒ¯æ³¢å¼€å…³æŠ€æœ¯å°†ä¼šæˆä¸ºPWMæ§åˆ¶æŠ€æœ¯å‘å±•çš„ä¸»è¦æ–¹å‘ä¹‹ä¸€ã€‚å…¶æ ¹æ®ç›¸åº”è½½è·çš„å˜åŒ–æ¥è°ƒåˆ¶æ™¶ä½“ç®¡åŸºææˆ–MOSç®¡æ …æçš„åç½®ï¼Œæ¥å®ç°æ™¶ä½“ç®¡æˆ–MOSç®¡å¯¼é€šæ—¶é—´çš„æ”¹å˜ï¼Œä»è€Œå®ç°å¼€å…³ç¨³å‹ç”µæºè¾“å‡ºçš„æ”¹å˜ã€‚è¿™ç§æ–¹å¼èƒ½ä½¿ç”µæºçš„è¾“å‡ºç”µå‹åœ¨å·¥ä½œæ¡ä»¶å˜åŒ–æ—¶ä¿æŒæ’å®šï¼Œæ˜¯åˆ©ç”¨å¾®å¤„ç†å™¨çš„æ•°å­—ä¿¡å·å¯¹æ¨¡æ‹Ÿç”µè·¯è¿›è¡Œæ§åˆ¶çš„ä¸€ç§éå¸¸æœ‰æ•ˆçš„æŠ€æœ¯ã€‚ æºç mainå‡½æ•°#include \"systemInit.h\" #include &lt;ctype.h> #include &lt;timer.h> #define PART_LM3S1138 #include &lt;pin_map.h> #include &lt;math.h> int T1A , T1B , T2A , T2B ; void Moto_Init(void){ //Â³ÃµÃŠÂ¼Â»Â¯ÂµÃ§Â»Ãº SysCtlPeriEnable(SYSCTL_PERIPH_TIMER1); // ÃŠÂ¹Ã„ÃœTIMER1Ã„Â£Â¿Ã© SysCtlPeriEnable(SYSCTL_PERIPH_TIMER2); // ÃŠÂ¹Ã„ÃœTIMER2Ã„Â£Â¿Ã© SysCtlPeriEnable(CCP2_PERIPH); // ÃŠÂ¹Ã„ÃœCCP2Ã‹Ã¹Ã”ÃšÂµÃ„GPIOÂ¶Ã‹Â¿Ãš SysCtlPeriEnable(CCP3_PERIPH); // ÃŠÂ¹Ã„ÃœCCP3Ã‹Ã¹Ã”ÃšÂµÃ„GPIOÂ¶Ã‹Â¿Ãš SysCtlPeriEnable(CCP4_PERIPH); // ÃŠÂ¹Ã„ÃœCCP4Ã‹Ã¹Ã”ÃšÂµÃ„GPIOÂ¶Ã‹Â¿Ãš SysCtlPeriEnable(CCP5_PERIPH); // ÃŠÂ¹Ã„ÃœCCP5Ã‹Ã¹Ã”ÃšÂµÃ„GPIOÂ¶Ã‹Â¿Ãš GPIOPinTypeTimer(CCP2_PORT, CCP2_PIN); // Ã‰Ã¨Ã–ÃƒÃÃ Â¹Ã˜Â¹ÃœÂ½Ã…ÃÂªTimerÂ¹Â¦Ã„Ãœ GPIOPinTypeTimer(CCP3_PORT, CCP3_PIN); // Ã‰Ã¨Ã–ÃƒÃÃ Â¹Ã˜Â¹ÃœÂ½Ã…ÃÂªTimerÂ¹Â¦Ã„Ãœ GPIOPinTypeTimer(CCP4_PORT, CCP4_PIN); // Ã‰Ã¨Ã–ÃƒÃÃ Â¹Ã˜Â¹ÃœÂ½Ã…ÃÂªTimerÂ¹Â¦Ã„Ãœ GPIOPinTypeTimer(CCP5_PORT, CCP5_PIN); // Ã‰Ã¨Ã–ÃƒÃÃ Â¹Ã˜Â¹ÃœÂ½Ã…ÃÂªTimerÂ¹Â¦Ã„Ãœ TimerConfigure(TIMER1_BASE, TIMER_CFG_16_BIT_PAIR | // Ã…Ã¤Ã–ÃƒTimerÃÂªÃ‹Â«16ÃÂ»PWM TIMER_CFG_A_PWM | TIMER_CFG_B_PWM); TimerConfigure(TIMER2_BASE, TIMER_CFG_16_BIT_PAIR | // Ã…Ã¤Ã–ÃƒTimerÃÂªÃ‹Â«16ÃÂ»PWM TIMER_CFG_A_PWM | TIMER_CFG_B_PWM); TimerControlLevel(TIMER1_BASE, TIMER_BOTH, true); // Â¿Ã˜Ã–Ã†PWMÃŠÃ¤Â³Ã¶Â·Â´ÃÃ  TimerControlLevel(TIMER2_BASE, TIMER_BOTH, true); TimerLoadSet(TIMER1_BASE, TIMER_BOTH, 1000); // Ã‰Ã¨Ã–ÃƒTimerBothÂ³ÃµÃ–Âµ TimerLoadSet(TIMER2_BASE, TIMER_BOTH, 1000); TimerMatchSet(TIMER1_BASE, TIMER_A, 0); // Ã‰Ã¨Ã–ÃƒTimerBÃ†Â¥Ã…Ã¤Ã–Âµ TimerMatchSet(TIMER1_BASE, TIMER_B, 0); // Ã‰Ã¨Ã–ÃƒTimerBÃ†Â¥Ã…Ã¤Ã–Âµ TimerMatchSet(TIMER2_BASE, TIMER_A, 0); // Ã‰Ã¨Ã–ÃƒTimerBÃ†Â¥Ã…Ã¤Ã–Âµ TimerMatchSet(TIMER2_BASE, TIMER_B, 0); // Ã‰Ã¨Ã–ÃƒTimerBÃ†Â¥Ã…Ã¤Ã–Âµ TimerEnable(TIMER1_BASE, TIMER_BOTH); // ÃŠÂ¹Ã„ÃœTimerÂ¼Ã†ÃŠÃ½Â£Â¬PWMÂ¿ÂªÃŠÂ¼ÃŠÃ¤Â³Ã¶ TimerEnable(TIMER2_BASE, TIMER_BOTH); } // Ã–Ã·ÂºÂ¯ÃŠÃ½Â£Â¨Â³ÃŒÃÃ²ÃˆÃ«Â¿ÃšÂ£Â© int main(void) { jtagWait(); // Â·Ã€Ã–Â¹JTAGÃŠÂ§ÃÂ§Â£Â¬Ã–Ã˜Ã’ÂªÂ£Â¡ clockInit(); // ÃŠÂ±Ã–Ã“Â³ÃµÃŠÂ¼Â»Â¯Â£ÂºÂ¾Â§Ã•Ã±Â£Â¬6MHz Moto_Init(); while(1) { TimerMatchSet(TIMER1_BASE, TIMER_A, T1A); // Ã‰Ã¨Ã–ÃƒTimerBÃ†Â¥Ã…Ã¤Ã–Âµ TimerMatchSet(TIMER1_BASE, TIMER_B, T1B); // Ã‰Ã¨Ã–ÃƒTimerBÃ†Â¥Ã…Ã¤Ã–Âµ TimerMatchSet(TIMER2_BASE, TIMER_A, T2A); // Ã‰Ã¨Ã–ÃƒTimerBÃ†Â¥Ã…Ã¤Ã–Âµ TimerMatchSet(TIMER2_BASE, TIMER_B, T2B); // Ã‰Ã¨Ã–ÃƒTimerBÃ†Â¥Ã…Ã¤Ã–Âµ } }","categories":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}],"tags":[{"name":"1138","slug":"1138","permalink":"http://ailous.top/tags/1138/"},{"name":"PWM","slug":"PWM","permalink":"http://ailous.top/tags/PWM/"}],"keywords":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}]},{"title":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆ12864æ¶²æ™¶ï¼‰","slug":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆ12864æ¶²æ™¶ï¼‰","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:37:34.676Z","comments":true,"path":"2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-12864-ye-jing/","link":"","permalink":"http://ailous.top/2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-12864-ye-jing/","excerpt":"","text":"è¿™äº›æ˜¯æˆ‘è‡ªå·±å¸¸ç”¨çš„ä»£ç ï¼Œæ¯”å®˜æ–¹çš„è¦ç®€æ´äº›ï¼Œä¸»è¦æ˜¯è‡ªç”¨ï¼Œè¿˜æœ‰ç›¸å…³æ¨¡å—ï¼Œä½¿ç”¨ä»£ç ã€‚ å…·ä½“æ–‡ä»¶å¯ä»¥å»æˆ‘githubä¸Šä¸‹è½½ã€‚å°±æ˜¯è¿™æ¬¾ã€‚ lcd12864ç®€ä»‹ å¸¦ä¸­æ–‡å­—åº“çš„128X64æ˜¯ä¸€ç§å…·æœ‰4ä½/8ä½å¹¶è¡Œã€2çº¿æˆ–3çº¿ä¸²è¡Œå¤šç§æ¥å£æ–¹å¼ï¼Œå†…éƒ¨å«æœ‰å›½æ ‡ä¸€çº§ã€äºŒçº§ç®€ä½“ä¸­æ–‡å­—åº“çš„ç‚¹é˜µå›¾å½¢æ¶²æ™¶æ˜¾ç¤ºæ¨¡å—ï¼›å…¶æ˜¾ç¤ºåˆ†è¾¨ç‡ä¸º128Ã—64ï¼Œå†…ç½®8192ä¸ª1616ç‚¹æ±‰å­—ï¼Œå’Œ128ä¸ª168ç‚¹ASCIIå­—ç¬¦é›†ã€‚åˆ©ç”¨è¯¥æ¨¡å—çµæ´»çš„æ¥å£æ–¹å¼å’Œç®€å•ã€æ–¹ä¾¿çš„æ“ä½œæŒ‡ä»¤ï¼Œå¯æ„æˆå…¨ä¸­æ–‡äººæœºäº¤äº’å›¾å½¢ç•Œé¢ã€‚å¯ä»¥æ˜¾ç¤º8Ã—4è¡Œ16Ã—16ç‚¹é˜µçš„æ±‰å­—ã€‚ä¹Ÿå¯å®Œæˆå›¾å½¢æ˜¾ç¤ºã€‚ä½ç”µå‹ä½åŠŸè€—æ˜¯å…¶åˆä¸€æ˜¾è‘—ç‰¹ç‚¹ã€‚ç”±è¯¥æ¨¡å—æ„æˆçš„æ¶²æ™¶æ˜¾ç¤ºæ–¹æ¡ˆä¸åŒç±»å‹çš„å›¾å½¢ç‚¹é˜µæ¶²æ™¶æ˜¾ç¤ºæ¨¡å—ç›¸æ¯”ï¼Œä¸è®ºç¡¬ä»¶ç”µè·¯ç»“æ„æˆ–æ˜¾ç¤ºç¨‹åºéƒ½è¦ç®€æ´å¾—å¤šï¼Œä¸”è¯¥æ¨¡å—çš„ä»·æ ¼ä¹Ÿç•¥ä½äºç›¸åŒç‚¹é˜µçš„å›¾å½¢æ¶²æ™¶æ¨¡å—ã€‚ æºç mainå‡½æ•°#include \"lcd_driver.H\" #include \"SoftI2C.h\" #include &lt;hw_types.h> #include &lt;hw_memmap.h> #include &lt;sysctl.h> #include &lt;gpio.h> #include &lt;stdio.h> #include \"LM3S1138_PinMap.H\" // å°†è¾ƒé•¿çš„æ ‡è¯†ç¬¦å®šä¹‰ä¸ºè¾ƒçŸ­çš„å½¢å¼ #define SysCtlPeriEnable SysCtlPeripheralEnable #define SysCtlPeriDisable SysCtlPeripheralDisable #define GPIOPinTypeIn GPIOPinTypeGPIOInput #define GPIOPinTypeOut GPIOPinTypeGPIOOutput #define GPIOPinTypeOD GPIOPinTypeGPIOOutputOD // å®šä¹‰KEY #define KEY_PERIPH SYSCTL_PERIPH_GPIOG #define KEY_PORT GPIO_PORTG_BASE #define KEY_PIN GPIO_PIN_5 // é˜²æ­¢JTAGå¤±æ•ˆ void JTAG_Wait(void){ SysCtlPeriEnable(KEY_PERIPH); // ä½¿èƒ½KEYæ‰€åœ¨çš„GPIOç«¯å£ GPIOPinTypeIn(KEY_PORT , KEY_PIN); // è®¾ç½®KEYæ‰€åœ¨ç®¡è„šä¸ºè¾“å…¥ if ( GPIOPinRead(KEY_PORT , KEY_PIN) == 0x00 ){ // å¦‚æœå¤ä½æ—¶æŒ‰ä¸‹KEYï¼Œåˆ™è¿›å…¥ while(1); // æ­»å¾ªç¯ï¼Œä»¥ç­‰å¾…JTAGè¿æ¥ } SysCtlPeriDisable(KEY_PERIPH); // ç¦æ­¢KEYæ‰€åœ¨çš„GPIOç«¯å£ } // å®šä¹‰å…¨å±€çš„ç³»ç»Ÿæ—¶é’Ÿå˜é‡ unsigned long TheSysClock = 12000000UL; // å»¶æ—¶ //============================================================================================= //*** å‡½ æ•°:Delay()\\''' //*** åŠŸ èƒ½ï¼šå»¶æ—¶ //*** å‚ æ•°: x å»¶æ—¶çš„æ—¶é—´ //============================================================================================ void Delay(unsigned long x){ unsigned long DelayValue = 0; for (DelayValue = 0; DelayValue &lt; x; DelayValue++); } // ç³»ç»Ÿåˆå§‹åŒ– void SystemInit(void){/* SysCtlLDOSet(SYSCTL_LDO_2_50V); // è®¾ç½®LDOè¾“å‡ºç”µå‹ SysCtlClockSet(SYSCTL_USE_OSC | // ç³»ç»Ÿæ—¶é’Ÿè®¾ç½®ï¼Œé‡‡ç”¨ä¸»æŒ¯è¡å™¨ SYSCTL_OSC_MAIN | SYSCTL_XTAL_6MHZ | SYSCTL_SYSDIV_1); SysCtlLDOSet(SYSCTL_LDO_2_75V); // é…ç½®PLLå‰é¡»å°†LDOç”µå‹è®¾ç½®ä¸º2.75V */ SysCtlClockSet(SYSCTL_USE_PLL | // ç³»ç»Ÿæ—¶é’Ÿè®¾ç½®ï¼Œé‡‡ç”¨PLL SYSCTL_OSC_MAIN | // ä¸»æŒ¯è¡å™¨ SYSCTL_XTAL_6MHZ | // å¤–æ¥6MHzæ™¶æŒ¯ SYSCTL_SYSDIV_4); // åˆ†é¢‘ç»“æœä¸º20MHz TheSysClock = SysCtlClockGet(); // è·å–ç³»ç»Ÿæ—¶é’Ÿï¼Œå•ä½ï¼šHz } int main(void){ JTAG_Wait(); // é˜²æ­¢JTAGå¤±æ•ˆï¼Œé‡è¦ï¼ SystemInit(); init_lcd(); I2C_Init(); while(1){ zlg_disp(); } } lcd_driver.c// åŒ…å«å¿…è¦çš„å¤´æ–‡ä»¶ // åŒ…å«å¿…è¦çš„å¤´æ–‡ä»¶ #include \"lcd_driver.h\" #include &lt;hw_types.h> #include &lt;hw_memmap.h> #include &lt;hw_sysctl.h> #include &lt;hw_gpio.h> #include &lt;hw_adc.h> #include &lt;sysctl.h> #include &lt;gpio.h> #include &lt;adc.h> #include &lt;stdio.h> // å°†è¾ƒé•¿çš„æ ‡è¯†ç¬¦å®šä¹‰ä¸ºè¾ƒçŸ­çš„å½¢å¼ #define SysCtlPeriEnable SysCtlPeripheralEnable #define SysCtlPeriDisable SysCtlPeripheralDisable #define GPIOPinTypeIn GPIOPinTypeGPIOInput #define GPIOPinTypeOut GPIOPinTypeGPIOOutput #define GPIOPinTypeOD GPIOPinTypeGPIOOutputOD #define LCD_PORT GPIO_PORTF_BASE #define CS GPIO_PIN_1 #define SDAT GPIO_PIN_2 #define SCLK GPIO_PIN_3 unsigned char pos[4]={0x80,0x90,0x88,0x98}; unsigned char data[4][16]; unsigned int gui_disp_buf[8][64]={0};//å»ºç«‹ç¼“å†²åŒºåŸŸ const unsigned char ascii_tab[]={\"0123456789ABCDEF\"}; unsigned char line_sign=0; extern float fTemp; extern void Delay(unsigned long x); //============================================================================================ //*** å‡½ æ•°: sdelay() //*** åŠŸ èƒ½ï¼šå»¶æ—¶å‡½æ•° //*** å‚ æ•°: å»¶æ—¶è®¡æ•°æ•°æ® //============================================================================================ void sdelay(unsigned long x) { while(x--); } //============================================================================================ //*** å‡½ æ•°:send_data() //*** åŠŸ èƒ½ï¼šæ¶²æ™¶ä¸²è¡Œç§»ä½æ•°æ® //*** å‚ æ•°: data ä¸²è¡Œç§»ä½çš„æ•°æ® //============================================================================================ void send_data(unsigned char data) //8ä½ä¸ºå¾…é€æ•°æ® { unsigned char i=8,data1; while (i--) { data1=data &amp; 0x80; //çœ‹ä¸€ä¸‹d7æ˜¯é«˜æ˜¯ä½ if (data1) //æ˜¯é«˜çš„è¯é€å‡º1 { GPIOPinWrite(LCD_PORT , SDAT , 0xff); sdelay(400); } else //å¦åˆ™çš„è¯é€å‡º0 { GPIOPinWrite(LCD_PORT , SDAT , 0x00); sdelay(400); //ä¸è¯»å¿™çº¿ï¼Œä½†è¦ç­‰åˆ°ä¸å¿™ä¸ºæ­¢ã€‚ } GPIOPinWrite(LCD_PORT , SCLK , 0xff); //sclk=1 sdelay(400) ; GPIOPinWrite(LCD_PORT , SCLK , 0x00); //sclk=0 sdelay(400) ; data=data&lt;&lt;1; } } //============================================================================================ //*** å‡½ æ•°:write_data() //*** åŠŸ èƒ½: å†™æ•°æ® //*** å‚ æ•°: data RW=1,RS=1æ—¶ä¼ é€çš„æ•°æ®æŒ‡ä»¤ //============================================================================================ void write_data(unsigned char data) //å…«ä½æ˜¯å¾…å†™å…¥æ•°æ® { unsigned char data1=0xfa,data2,data3; //data2ä¸­å­˜æ”¾é«˜4ä½æ•°æ®ï¼Œdata3ä¸­å­˜æ”¾ä½4ä½æ•°æ® GPIOPinWrite(LCD_PORT , CS , 0xff); //cs=1 sdelay(400); data2=data &amp; 0xf0; //å–é«˜4ä½æ•°æ® data3=(data &amp; 0x0f)&lt;&lt;4; //å–ä½4ä½æ•°æ® send_data(data1); send_data(data2); send_data(data3); GPIOPinWrite(LCD_PORT , CS , 0x00); //cs=0 sdelay(400); } //============================================================================================ //*** å‡½ æ•°:write_comm() //*** åŠŸ èƒ½: å†™å‘½ä»¤ //*** å‚ æ•°: data RW=0,RS=0æ—¶ä¼ é€çš„å‘½ä»ŠæŒ‡ä»¤ //============================================================================================ void write_comm(unsigned char data) //ä½å…«ä½æ˜¯å¾…å†™å…¥æ•°æ® { unsigned char data1=0xf8,data2,data3; //data2ä¸­å­˜æ”¾é«˜4ä½æ•°æ®ï¼Œdata3ä¸­å­˜æ”¾ä½4ä½æ•°æ® GPIOPinWrite(LCD_PORT , CS , 0xff); //cs=1 sdelay(400); data2=data &amp; 0xf0; //å–é«˜4ä½æ•°æ® data3=(data &amp; 0x0f)&lt;&lt;4; //å–ä½4ä½æ•°æ® send_data(data1); send_data(data2); send_data(data3); GPIOPinWrite(LCD_PORT , CS , 0x00); //cs=0 sdelay(400); } //============================================================================================ //*** å‡½ æ•°:init_lcd() //*** åŠŸ èƒ½: LCMåˆå§‹åŒ– //*** å‚ æ•°: æ—  //============================================================================================ void init_lcd(void) { SysCtlPeriEnable(SYSCTL_PERIPH_GPIOF); // ä½¿èƒ½GPIOFç«¯å£ GPIOPinTypeOut(LCD_PORT , CS); // è®¾ç½®PF1ä¸ºè¾“å‡ºç±»å‹ GPIOPinTypeOut(LCD_PORT , SDAT); // è®¾ç½®PF2ä¸ºè¾“å‡ºç±»å‹ GPIOPinTypeOut(LCD_PORT , SCLK); // è®¾ç½®PF3ä¸ºè¾“å‡ºç±»å‹ GPIOPinWrite(LCD_PORT , CS , 0x00); //CS=0 GPIOPinWrite(LCD_PORT , SDAT , 0x00); //SDAT=0 GPIOPinWrite(LCD_PORT , SCLK , 0x00); //SCLK=0 write_comm(0x30); //åŸºæœ¬æŒ‡ä»¤é›† write_comm(0x01); //æ¸…é™¤æ˜¾ç¤ºå±å¹•ï¼ŒæŠŠDDRAMä½å€è®¡æ•°å™¨è°ƒæ•´ä¸º\"00H\" sdelay(40000); write_comm(0x03); //æŠŠDDRAMä½å€è®¡æ•°å™¨è°ƒæ•´ä¸º\"00H\"ï¼Œæ¸¸æ ‡å›åŸç‚¹ï¼Œè¯¥åŠŸèƒ½ä¸å½±å“æ˜¾ç¤ºDDRAM sdelay(40000); write_comm(0x06); //å…‰æ ‡å³ç§» sdelay(4000); write_comm(0x0c); //æ˜¾ç¤ºå±æ‰“å¼€ sdelay(4000); } //============================================================================================ //*** å‡½ æ•°:screen() //*** åŠŸ èƒ½: å…¨å±æ˜¾ç¤º //*** å‚ æ•°: data åŸºæœ¬æŒ‡ä»¤é›†ä¸‹è¦æ˜¾ç¤ºä¸€ç»´æ•°ç»„ //============================================================================================ void screen(unsigned char data[]) { unsigned char i,j; for (i=0;i&lt;4;i++) { switch(i) { case 0: write_comm(0x80); //è®¾å®šDDRAMç¬¬ä¸€è¡Œï¼Œç¬¬ä¸€åˆ— break; case 1: write_comm(0x90); //è®¾å®šDDRAMç¬¬äºŒè¡Œï¼Œç¬¬ä¸€åˆ— break; case 2: write_comm(0x88); //è®¾å®šDDRAMç¬¬ä¸‰è¡Œï¼Œç¬¬ä¸€åˆ— break; case 3: write_comm(0x98); //è®¾å®šDDRAMç¬¬å››è¡Œï¼Œç¬¬ä¸€åˆ— break; } for(j=0;j&lt;16;j++) write_data(data[i*16+j]); } } //============================================================================================ //*** å‡½ æ•°:disp_line(unsigned char line,unsigned char data[]) //*** åŠŸ èƒ½: å†™ä¸€è¡Œæ•°æ® //*** å‚ æ•°: line è¡Œï¼ˆ0~3ï¼‰ //*** å‚ æ•°: data åŸºæœ¬æŒ‡ä»¤é›†ä¸‹è¦æ˜¾ç¤ºä¸€ç»´æ•°ç»„(16å­—èŠ‚ï¼‰ //============================================================================================ void disp_line(unsigned char line,unsigned char data[]) { unsigned char j; switch(line) { case 0: write_comm(0x80); //è®¾å®šDDRAMç¬¬ä¸€è¡Œï¼Œç¬¬ä¸€åˆ— break; case 1: write_comm(0x90); //è®¾å®šDDRAMç¬¬äºŒè¡Œï¼Œç¬¬ä¸€åˆ— break; case 2: write_comm(0x88); //è®¾å®šDDRAMç¬¬ä¸‰è¡Œï¼Œç¬¬ä¸€åˆ— break; case 3: write_comm(0x98); //è®¾å®šDDRAMç¬¬å››è¡Œï¼Œç¬¬ä¸€åˆ— break; } for(j=0;j&lt;16;j++) write_data(data[j]); write_comm(0xa0); } //============================================================================================ //*** å‡½ æ•°:GUI_ClearSCR() //*** åŠŸ èƒ½: æ¸…å±ï¼ˆæ‰©å……æŒ‡ä»¤é›†ä¸‹ï¼‰ //*** å‚ æ•°: mode: æ¨¡å¼ // 0:åŸºæœ¬æŒ‡ä»¤é›† // 1:æ‰©å……æŒ‡ä»¤é›† //============================================================================================ void GUI_ClearSCR(char mode) { unsigned char x,y; unsigned char i,j; switch(mode) { case 0: write_comm(0x32); //åŸºæœ¬æŒ‡ä»¤é›† write_comm(0x01); //æ¸…é™¤å±å¹• break; case 1: write_comm(0x36); //æ‰©å……æŒ‡ä»¤é›† for(i=0;i&lt;8;i++) //å¡«å†™ç¼“å†²åŒºåŸŸ { for(j=0;j&lt;64;j++) gui_disp_buf[i][j]=0x00; } x=0x80;y=0x80; write_comm(y); //è®¾ç½®åæ ‡ write_comm(x); for (j=0;j&lt;32;j++) { for (i=0;i&lt;16;i++) { write_data(0x00); } write_comm(++y); write_comm(x); } x=0x88;y=0x80; write_data(0x00); write_comm(y); write_comm(x); for (j=32;j&lt;64;j++) { for (i=0;i&lt;16;i++) { write_data(0x00); } write_comm(++y); write_comm(x); } write_comm(0x32);//åŸºæœ¬æŒ‡ä»¤é›†ï¼Œç»˜å›¾æ˜¾ç¤º break; } } void lcd_demo(void) { GUI_ClearSCR(0); paint(paint_buffer1); Delay(200000); GUI_ClearSCR(0); } //============================================================================================ //*** å‡½ æ•°:location(int y,int x) //*** åŠŸ èƒ½:æ±‰å­—å®šä½ //*** å‚ æ•°: //============================================================================================ void location(int y,int x) { switch(y) {case 0: write_comm(0x80 | x); break; case 1: write_comm(0x90 | x); break; case 2: write_comm(0x88 | x); break; case 3: write_comm(0x98 | x); break; } } void display( char *str) { while(*str != '\\0') { write_data(*str); str++; } } //========================================================== // åœ¨LCDä¸Šæ˜¾ç¤º //========================================================== void zlg_disp() { // unsigned x; unsigned char lcd_buffer[16]; unsigned char hz_1[]={\"å¹´æœˆæ—¥æ˜ŸæœŸæ—¥ä¸€äºŒä¸‰å››äº”å…­é”®ç›˜æ¸©åº¦\"}; //x=fTemp*10; lcd_buffer[0]=' '; lcd_buffer[1]=' '; lcd_buffer[2]=' '; lcd_buffer[3]=' '; lcd_buffer[4]=hz_1[24]; lcd_buffer[5]=hz_1[25]; lcd_buffer[6]=hz_1[26]; lcd_buffer[7]=hz_1[27]; lcd_buffer[8]=':'; lcd_buffer[9]=ascii_tab[1]; lcd_buffer[10]=ascii_tab[2]; lcd_buffer[11]='H'; lcd_buffer[12]=' '; lcd_buffer[13]=' '; lcd_buffer[14]=' '; lcd_buffer[15]=' '; disp_line(3,lcd_buffer); } è¿™ä¸ªä¸ç”¨ä¿®æ”¹ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥startup_ewarm.cä¸ç”¨åŠ¨ã€‚ å…·ä½“çš„å°±ä¸è®²è§£äº†ï¼Œåœ°å€åæœŸä¼šé™„ä¸Š","categories":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}],"tags":[{"name":"1138","slug":"1138","permalink":"http://ailous.top/tags/1138/"},{"name":"12864","slug":"12864","permalink":"http://ailous.top/tags/12864/"},{"name":"lcd","slug":"lcd","permalink":"http://ailous.top/tags/lcd/"}],"keywords":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}]},{"title":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆè‡ªå¸¦æŒ‰é”®ï¼‰","slug":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆè‡ªå¸¦æŒ‰é”®ï¼‰","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:39:36.342Z","comments":true,"path":"2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-zi-dai-an-jian/","link":"","permalink":"http://ailous.top/2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-zi-dai-an-jian/","excerpt":"","text":"è¿™äº›æ˜¯æˆ‘è‡ªå·±å¸¸ç”¨çš„ä»£ç ï¼Œæ¯”å®˜æ–¹çš„è¦ç®€æ´äº›ï¼Œä¸»è¦æ˜¯è‡ªç”¨ï¼Œè¿˜æœ‰ç›¸å…³æ¨¡å—ï¼Œä½¿ç”¨ä»£ç ã€‚ å…·ä½“æ–‡ä»¶å¯ä»¥å»æˆ‘githubä¸Šä¸‹è½½ã€‚ è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è®²çš„ï¼Œå°±æ˜¯è‡ªå¸¦çš„å‡ ä¸ªæŒ‰é”®ä½¿ç”¨ç½¢äº†ã€‚ä¸æƒ³å¤–æ¥ç”¨è¿™ä¸ªã€‚ æºç mainå‡½æ•°// åŸºäºã€ŠStellariså¤–è®¾é©±åŠ¨åº“ã€‹çš„ä¾‹ç¨‹ï¼šäº¤æµèœ‚é¸£å™¨å‘å‡ºã€æŒ‰é”®æ§åˆ¶LED // åŒ…å«å¿…è¦çš„å¤´æ–‡ä»¶ #include \"KEY.H\" #include &lt;hw_types.h> #include &lt;hw_memmap.h> #include &lt;hw_sysctl.h> #include &lt;hw_gpio.h> #include &lt;sysctl.h> #include &lt;gpio.h> // å°†è¾ƒé•¿çš„æ ‡è¯†ç¬¦å®šä¹‰æˆè¾ƒçŸ­çš„å½¢å¼ #define SysCtlPeriEnable SysCtlPeripheralEnable #define SysCtlPeriDisable SysCtlPeripheralDisable #define GPIOPinTypeIn GPIOPinTypeGPIOInput #define GPIOPinTypeOut GPIOPinTypeGPIOOutput // å®šä¹‰KEY #define KEY_PERIPH SYSCTL_PERIPH_GPIOG #define KEY_PORT GPIO_PORTG_BASE #define KEY_PIN GPIO_PIN_5 // é˜²æ­¢JTAGå¤±æ•ˆ void JTAG_Wait(void) { SysCtlPeriEnable(KEY_PERIPH); // ä½¿èƒ½KEYæ‰€åœ¨çš„GPIOç«¯å£ GPIOPinTypeIn(KEY_PORT , KEY_PIN); // è®¾ç½®KEYæ‰€åœ¨ç®¡è„šä¸ºè¾“å…¥ if ( GPIOPinRead(KEY_PORT , KEY_PIN) == 0x00 ) // å¦‚æœå¤ä½æ—¶æŒ‰ä¸‹KEYï¼Œåˆ™è¿›å…¥ { while(1); // æ­»å¾ªç¯ï¼Œä»¥ç­‰å¾…JTAGè¿æ¥ } SysCtlPeriDisable(KEY_PERIPH); // ç¦æ­¢KEYæ‰€åœ¨çš„GPIOç«¯å£ } // å®šä¹‰å…¨å±€çš„ç³»ç»Ÿæ—¶é’Ÿå˜é‡ unsigned long TheSysClock = 12000000UL; // å»¶æ—¶ void Delay(unsigned long ulVal){ while ( --ulVal != 0 ); } // ç³»ç»Ÿåˆå§‹åŒ– void SystemInit(void) { /* SysCtlLDOSet(SYSCTL_LDO_2_50V); // è®¾ç½®LDOè¾“å‡ºç”µå‹ SysCtlClockSet(SYSCTL_USE_OSC | // ç³»ç»Ÿæ—¶é’Ÿè®¾ç½®ï¼Œé‡‡ç”¨ä¸»æŒ¯è¡å™¨ SYSCTL_OSC_MAIN | SYSCTL_XTAL_6MHZ | SYSCTL_SYSDIV_1); */ SysCtlLDOSet(SYSCTL_LDO_2_75V); // é…ç½®PLLå‰å°†LDOç”µå‹è®¾ç½®ä¸º2.75V SysCtlClockSet(SYSCTL_USE_PLL | // ç³»ç»Ÿæ—¶é’Ÿè®¾ç½®ï¼Œé‡‡ç”¨PLL SYSCTL_OSC_MAIN | // ä¸»æŒ¯è¡å™¨ SYSCTL_XTAL_6MHZ | // å¤–æ¥6MHzæ™¶æŒ¯ SYSCTL_SYSDIV_4); // åˆ†é¢‘ç»“æœä¸º50MHz TheSysClock = SysCtlClockGet(); // è·å–ç³»ç»Ÿæ—¶é’Ÿï¼Œå•ä½ï¼šHz KEY_Init(KEY1 | KEY2); // KEYåˆå§‹åŒ– } // ä¸»å‡½æ•°ï¼ˆç¨‹åºå…¥å£ï¼‰ int main(void){ JTAG_Wait(); // é˜²æ­¢JTAGå¤±æ•ˆï¼Œé‡è¦ï¼ SystemInit(); // ç³»ç»Ÿåˆå§‹åŒ– while(1){ if ( KEY_Get(KEY1 | KEY2) ){ } else{ } } } å…¶ä»–çš„ä¸ç”¨æ”¹ã€‚","categories":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}],"tags":[{"name":"1138","slug":"1138","permalink":"http://ailous.top/tags/1138/"},{"name":"è‡ªå¸¦æŒ‰é”®","slug":"è‡ªå¸¦æŒ‰é”®","permalink":"http://ailous.top/tags/è‡ªå¸¦æŒ‰é”®/"}],"keywords":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}]},{"title":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆUART2Aï¼‰","slug":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆUART2Aï¼‰","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:38:35.253Z","comments":true,"path":"2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-uart2a/","link":"","permalink":"http://ailous.top/2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-uart2a/","excerpt":"","text":"è¿™äº›æ˜¯æˆ‘è‡ªå·±å¸¸ç”¨çš„ä»£ç ï¼Œæ¯”å®˜æ–¹çš„è¦ç®€æ´äº›ï¼Œä¸»è¦æ˜¯è‡ªç”¨ï¼Œè¿˜æœ‰ç›¸å…³æ¨¡å—ï¼Œä½¿ç”¨ä»£ç ã€‚ å…·ä½“æ–‡ä»¶å¯ä»¥å»æˆ‘githubä¸Šä¸‹è½½ã€‚ UART ç®€ä»‹è®¡ç®—æœºä¸å¤–éƒ¨è®¾å¤‡çš„è¿æ¥ï¼ŒåŸºæœ¬ä¸Šä½¿ç”¨äº†ä¸¤ç±»æ¥å£ï¼šä¸²è¡Œæ¥å£ä¸å¹¶è¡Œæ¥å£ã€‚å¹¶è¡Œæ¥å£æ˜¯æŒ‡æ•°æ®çš„å„ä¸ªä½åŒæ—¶è¿›è¡Œä¼ é€ï¼Œå…¶ç‰¹ç‚¹æ˜¯ä¼ è¾“é€Ÿåº¦å—ï¼Œä½†å½“ä¼ è¾“è·ç¦»è¿œã€ä½æ•°åˆå¤šæ—¶ï¼Œé€šä¿¡çº¿è·¯å˜å¤æ‚ä¸”æˆæœ¬æé«˜ã€‚ä¸²è¡Œé€šä¿¡æ˜¯æŒ‡æ•°æ®ä¸€ä½ä½åœ°é¡ºåºä¼ é€ï¼Œå…¶ç‰¹ç‚¹æ˜¯é€‚åˆäºè¿œè·ç¦»é€šä¿¡ï¼Œé€šä¿¡çº¿è·¯ç®€å•ï¼Œåªè¦ä¸€å¯¹ä¼ è¾“çº¿å°±å¯ä»¥å®ç°åŒå‘é€šä¿¡ï¼Œä»è€Œå¤§å¤§é™ä½äº†æˆæœ¬ã€‚ä¸²è¡Œé€šä¿¡åˆåˆ†ä¸ºå¼‚æ­¥ä¸åŒæ­¥ä¸¤ç±»ã€‚UARTï¼ˆUniversal Asynchronous Receiver/Transmitterï¼Œé€šç”¨å¼‚æ­¥æ”¶å‘å™¨ï¼‰æ­£æ˜¯è®¾å¤‡é—´è¿›è¡Œå¼‚æ­¥é€šä¿¡çš„å…³é”®æ¨¡å—ã€‚å®ƒçš„é‡è¦ä½œç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š å¤„ç†æ•°æ®æ€»è·¯çº¿å’Œä¸²è¡Œå£ä¹‹é—´çš„ä¸²/å¹¶ã€å¹¶/ä¸²è½¬æ¢ï¼› é€šä¿¡åŒæ–¹åªè¦é‡‡ç”¨ç›¸åŒçš„å¸§æ ¼å¼å’Œæ³¢ç‰¹ç‡ï¼Œå°±èƒ½åœ¨æœªå…±äº«æ—¶é’Ÿä¿¡å·çš„æƒ…å†µä¸‹ï¼Œä»…ç”¨ä¸¤æ ¹ä¿¡å·çº¿ï¼ˆRx å’Œ Txï¼‰å°±å¯ä»¥å®Œæˆé€šä¿¡è¿‡ç¨‹ï¼› é‡‡ç”¨å¼‚æ­¥æ–¹å¼ï¼Œæ•°æ®æ”¶å‘å®Œæ¯•åï¼Œå¯é€šè¿‡ä¸­æ–­æˆ–ç½®ä½æ ‡å¿—ä½çš„æ–¹å¼é€šçŸ¥å¾®æ§åˆ¶å™¨è¿›è¡Œå¤„ç†ï¼Œå¤§å¤§æé«˜å¾®æ§åˆ¶å™¨çš„å·¥ä½œæ•ˆç‡ã€‚ è‹¥åŠ å…¥ä¸€ä¸ªåˆé€‚çš„ç”µå¹³è½¬æ¢å™¨ï¼Œå¦‚ SP3232Eã€SP3485ï¼ŒUART è¿˜èƒ½ç”¨äº RS-232ã€RS-485é€šä¿¡ï¼Œæˆ–ä¸è®¡ç®—æœºçš„ç«¯å£è¿æ¥ã€‚UART åº”ç”¨éå¸¸å¹¿æ³›ï¼Œæ‰‹æœºã€å·¥ä¸šæ§åˆ¶ã€PC ç­‰åº”ç”¨ä¸­éƒ½è¦ç”¨åˆ° UARTã€‚ æºç mainå‡½æ•°#include \"systemInit.h\" #include &lt;uart.h> #include &lt;ctype.h> #include &lt;string.h> #include \"uartGetPut.h\" #include &lt;stdio.h> #include &lt;timer.h> #define PART_LM3S1138 #include &lt;pin_map.h> #include &lt;math.h> char Num ; // ä¸»å‡½æ•°ï¼ˆç¨‹åºå…¥å£ï¼‰ int main(void) { jtagWait(); // é˜²æ­¢JTAGå¤±æ•ˆï¼Œé‡è¦ï¼ clockInit(); // æ—¶é’Ÿåˆå§‹åŒ–ï¼šæ™¶æŒ¯ï¼Œ6MHz uartInit(); // UARTåˆå§‹åŒ– while(1) { } } void UART2_ISR(void) { unsigned long ulStatus; ulStatus = UARTIntStatus(UART2_BASE, true); // è¯»å–å½“å‰ä¸­æ–­çŠ¶æ€ UARTIntClear(UART2_BASE, ulStatus); // æ¸…é™¤ä¸­æ–­çŠ¶æ€ if ((ulStatus &amp; UART_INT_RX) || (ulStatus &amp; UART_INT_RT)) // è‹¥æ˜¯æ¥æ”¶ä¸­æ–­æˆ–è€… { Num = UARTCharGet(UART2_BASE); // ç­‰å¾…æ¥æ”¶å­—ç¬¦ if (Num == 'a'){ // å¦‚æœé‡åˆ°a&lt;CR> } } } startup_ewarm.cï¼ˆä¿®æ”¹ä¼˜å…ˆçº§ï¼‰ è¿™äº›æ˜¯è¦æ”¹çš„éƒ¨åˆ†ã€‚ å…·ä½“çš„å°±ä¸è®²è§£äº†ï¼Œåœ°å€åæœŸä¼šé™„ä¸Š","categories":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}],"tags":[{"name":"1138","slug":"1138","permalink":"http://ailous.top/tags/1138/"},{"name":"UART2A","slug":"UART2A","permalink":"http://ailous.top/tags/UART2A/"}],"keywords":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}]},{"title":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆå®šæ—¶å™¨ï¼‰","slug":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆå®šæ—¶å™¨ï¼‰","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:39:02.191Z","comments":true,"path":"2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-ding-shi-qi/","link":"","permalink":"http://ailous.top/2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-ding-shi-qi/","excerpt":"","text":"è¿™äº›æ˜¯æˆ‘è‡ªå·±å¸¸ç”¨çš„ä»£ç ï¼Œæ¯”å®˜æ–¹çš„è¦ç®€æ´äº›ï¼Œä¸»è¦æ˜¯è‡ªç”¨ï¼Œè¿˜æœ‰ç›¸å…³æ¨¡å—ï¼Œä½¿ç”¨ä»£ç ã€‚ å…·ä½“æ–‡ä»¶å¯ä»¥å»æˆ‘githubä¸Šä¸‹è½½ã€‚ Timer æ€»ä½“ç‰¹æ€§åœ¨ Stellaris ç³»åˆ— ARM å†…éƒ¨é€šå¸¸é›†æˆæœ‰ 2ï½4 ä¸ªé€šç”¨å®šæ—¶å™¨æ¨¡å—ï¼ˆGeneral-Purpose TimerModuleï¼ŒGPTMï¼‰ï¼Œåˆ†åˆ«ç§°ä¸º Timer0ã€Timer1ã€Timer2 å’Œ Timer3ã€‚å®ƒä»¬çš„ç”¨æ³•æ˜¯ç›¸åŒçš„ï¼šæ¯ ä¸ª Timer æ¨¡å—éƒ½å¯ä»¥é…ç½®ä¸ºä¸€ä¸ª 32 ä½å®šæ—¶å™¨æˆ–ä¸€ä¸ª 32 ä½ RTC å®šæ—¶å™¨ï¼›ä¹Ÿå¯ä»¥æ‹†åˆ†ä¸ºä¸¤ä¸ª16 ä½çš„å®šæ—¶/è®¡æ•°å™¨ TimerA å’Œ TimerBï¼Œå®ƒä»¬å¯ä»¥è¢«é…ç½®ä¸ºç‹¬ç«‹è¿è¡Œçš„å®šæ—¶å™¨ã€äº‹ä»¶è®¡æ•°å™¨æˆ– PWMã€‚ Timer æ¨¡å—å…·æœ‰éå¸¸ä¸°å¯Œçš„åŠŸèƒ½ï¼š32 ä½å®šæ—¶å™¨æ¨¡å¼ï¼šÂ„å¯ç¼–ç¨‹å•æ¬¡è§¦å‘ï¼ˆone-shotï¼‰å®šæ—¶å™¨Â„ å¯ç¼–ç¨‹å‘¨æœŸï¼ˆperiodicï¼‰å®šæ—¶å™¨Â„ å®æ—¶æ—¶é’Ÿ RTCï¼ˆReal Time Clockï¼‰ Â„ è½¯ä»¶å¯æ§çš„äº‹ä»¶æš‚åœï¼ˆç”¨äºå•æ­¥è°ƒè¯•æ—¶æš‚åœè®¡æ•°ï¼ŒRTC æ¨¡å¼é™¤å¤–ï¼‰ 16 ä½å®šæ—¶å™¨æ¨¡å¼ï¼šÂ„ å¸¦ 8 ä½é¢„åˆ†é¢‘å™¨çš„é€šç”¨å®šæ—¶å™¨åŠŸèƒ½Â„ å¯ç¼–ç¨‹å•æ¬¡è§¦å‘ï¼ˆone-shotï¼‰å®šæ—¶å™¨Â„ å¯ç¼–ç¨‹å‘¨æœŸï¼ˆperiodicï¼‰å®šæ—¶å™¨Â„ è½¯ä»¶å¯æ§çš„äº‹ä»¶æš‚åœ 16 ä½è¾“å…¥æ•è·æ¨¡å¼ï¼šÂ„ è¾“å…¥è¾¹æ²¿è®¡æ•°æ•è·Â„ è¾“å…¥è¾¹æ²¿å®šæ—¶æ•è· 16 ä½ PWM æ¨¡å¼ï¼šÂ„ ç”¨æ³•ç®€å•çš„ PWMï¼ˆPulse-Width Modulationï¼Œè„‰å®½è°ƒåˆ¶ï¼‰æ¨¡å¼Â„ å¯é€šè¿‡è½¯ä»¶å®ç° PWM ä¿¡å·å‘¨æœŸã€å ç©ºæ¯”ã€è¾“å‡ºåç›¸ç­‰çš„æ§åˆ¶ Timer åŠŸèƒ½æ¦‚è¿°Timer æ¨¡å—çš„åŠŸèƒ½åœ¨æ€»ä½“ä¸Šå¯ä»¥åˆ†æˆ 32 ä½æ¨¡å¼å’Œ 16 ä½æ¨¡å¼ä¸¤å¤§ç±»ã€‚åœ¨ 32 ä½æ¨¡å¼ä¸‹ï¼ŒTimerA å’Œ TimerB è¢«è¿åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå®Œæ•´çš„ 32 ä½è®¡æ•°å™¨ï¼Œå¯¹ Timer çš„å„é¡¹æ“ä½œï¼Œå¦‚è£…è½½åˆå€¼ã€è¿è¡Œæ§åˆ¶ã€ä¸­æ–­æ§åˆ¶ç­‰ï¼Œéƒ½ç”¨å¯¹ TimerA çš„æ“ä½œä½œä¸ºæ€»ä½“ä¸Šçš„ 32 ä½æ§åˆ¶ï¼Œè€Œå¯¹ TimerBçš„æ“ä½œæ— ä»»ä½•æ•ˆæœã€‚åœ¨ 16 ä½æ¨¡å¼ä¸‹ï¼Œå¯¹ TimerA çš„æ“ä½œä»…å¯¹ TimerA æœ‰æ•ˆï¼Œå¯¹ TimerB çš„æ“ä½œä»…å¯¹ TimerB æœ‰æ•ˆï¼Œå³å¯¹ä¸¤è€…çš„æ“æ§æ˜¯å®Œå…¨ç‹¬ç«‹è¿›è¡Œçš„ã€‚ æ¯ä¸€ä¸ª Timer æ¨¡å—å¯¹åº”ä¸¤ä¸ª CCP ç®¡è„šã€‚CCP æ˜¯â€œCapture Compare PWMâ€çš„ç¼©å†™ï¼Œæ„ä¸ºâ€œæ•è·/æ¯”è¾ƒ/è„‰å®½è°ƒåˆ¶â€ã€‚åœ¨ 32 ä½å•æ¬¡è§¦å‘å’Œå‘¨æœŸå®šæ—¶æ¨¡å¼ä¸‹ï¼ŒCCP åŠŸèƒ½æ— æ•ˆï¼ˆä¸ä¹‹å¤ç”¨çš„ GPIO ç®¡è„šåŠŸèƒ½ä»ç„¶æ­£å¸¸ï¼‰ã€‚åœ¨ 32 ä½ RTC æ¨¡å¼ä¸‹ï¼Œå¶æ•° CCP ç®¡è„šï¼ˆCCP0ã€CCP2ã€CCP4ç­‰ï¼‰ä½œä¸º RTC æ—¶é’Ÿæºçš„è¾“å…¥ï¼Œè€Œå¥‡æ•° CCP ç®¡è„šï¼ˆCCP1ã€CCP3ã€CCP5 ç­‰ï¼‰æ— æ•ˆã€‚åœ¨ 16 ä½æ¨¡å¼ä¸‹ï¼Œè®¡æ•°æ•è·ã€å®šæ—¶æ•è·ã€PWM åŠŸèƒ½éƒ½ä¼šç”¨åˆ° CCP ç®¡è„šï¼Œå¯¹åº”å…³ç³»æ˜¯ï¼šTimer0A å¯¹åº”CCP0ã€Timer0B å¯¹åº” CCP1ï¼ŒTimer1A å¯¹åº” CCP2ã€Timer1B å¯¹åº” CCP3ï¼Œä¾æ­¤ç±»æ¨ã€‚ 32 ä½å•æ¬¡è§¦å‘/å‘¨æœŸå®šæ—¶å™¨åœ¨è¿™ä¸¤ç§æ¨¡å¼ä¸­ï¼ŒTimer éƒ½è¢«é…ç½®æˆä¸€ä¸ª 32 ä½çš„é€’å‡è®¡æ•°å™¨ï¼Œç”¨æ³•ç±»ä¼¼ï¼Œåªæ˜¯å•æ¬¡è§¦å‘æ¨¡å¼åªèƒ½å®šæ—¶ä¸€æ¬¡ï¼Œå¦‚æœéœ€è¦å†æ¬¡å®šæ—¶åˆ™å¿…é¡»é‡æ–°é…ç½®ï¼Œè€Œå‘¨æœŸæ¨¡å¼åˆ™å¯ä»¥å‘¨è€Œå¤å§‹åœ°å®šæ—¶ï¼Œé™¤éè¢«å…³é—­ã€‚åœ¨è®¡æ•°åˆ° 0x00000000 æ—¶ï¼Œå¯ä»¥åœ¨è½¯ä»¶çš„æ§åˆ¶ä¸‹è§¦å‘ä¸­æ–­æˆ–è¾“å‡ºä¸€ä¸ªå†…éƒ¨çš„å•æ—¶é’Ÿå‘¨æœŸè„‰å†²ä¿¡å·ï¼Œè¯¥ä¿¡å·å¯ä»¥ç”¨æ¥è§¦å‘ ADC é‡‡æ ·ã€‚ 32 ä½ RTC å®šæ—¶å™¨åœ¨è¯¥æ¨¡å¼ä¸­ï¼ŒTimer è¢«é…ç½®æˆä¸€ä¸ª 32 ä½çš„é€’å¢è®¡æ•°å™¨ã€‚RTC åŠŸèƒ½çš„æ—¶é’Ÿæºæ¥è‡ªå¶æ•° CCP ç®¡è„šçš„è¾“å…¥ã€‚åœ¨ LM3S101/102 é‡Œï¼ŒRTC æ—¶é’Ÿä¿¡å·ä»ä¸“é—¨çš„â€œ32KHzâ€ç®¡è„šè¾“å…¥ã€‚è¾“å…¥çš„æ—¶é’Ÿé¢‘ç‡åº”å½“ä¸ºç²¾å‡†çš„ 32.768KHzï¼Œåœ¨èŠ¯ç‰‡å†…éƒ¨æœ‰ä¸€ä¸ªRTC ä¸“ç”¨çš„é¢„åˆ†é¢‘å™¨ï¼Œå›ºå®šä¸º 32768 åˆ†é¢‘ã€‚å› æ­¤æœ€ç»ˆè¾“å…¥åˆ° RTC è®¡æ•°å™¨çš„æ—¶é’Ÿé¢‘ç‡æ­£å¥½æ˜¯1Hzï¼Œå³æ¯è¿‡ 1 ç§’é’Ÿ RTC è®¡æ•°å™¨å¢ 1ã€‚RTCè®¡æ•°å™¨ä» 0x00000000 å¼€å§‹è®¡æ»¡éœ€è¦ 232ç§’ï¼Œè¿™æ˜¯ä¸ªæé•¿çš„æ—¶é—´ï¼Œæœ‰ 136 å¹´ï¼å› æ­¤RTCçœŸæ­£çš„ç”¨æ³•æ˜¯ï¼šåˆå§‹åŒ–åä¸éœ€è¦æ›´æ”¹é…ç½®ï¼ˆè°ƒæ•´æ—¶é—´æˆ–æ—¥æœŸæ—¶ä¾‹å¤–ï¼‰ï¼Œåªéœ€è¦ä¿®æ”¹åŒ¹é…å¯„å­˜å™¨çš„å€¼ï¼Œè€Œä¸”è¦ä¿è¯åŒ¹é…å€¼æ€»æ˜¯è¶…å‰äºå½“å‰è®¡æ•°å€¼ã€‚æ¯æ¬¡åŒ¹é…æ—¶å¯äº§ç”Ÿä¸­æ–­ï¼ˆå¦‚æœä¸­æ–­å·²è¢«ä½¿èƒ½ï¼‰ï¼Œæ®æ­¤å¯ä»¥è®¡ç®—å‡ºå½“å‰çš„å¹´æœˆæ—¥ã€æ—¶åˆ†ç§’ä»¥åŠæ˜ŸæœŸã€‚åœ¨ä¸­æ–­æœåŠ¡å‡½æ•°é‡Œåº”å½“é‡æ–°è®¾ç½®åŒ¹é…å€¼ï¼Œå¹¶ä¸”åŒ¹é…å€¼ä»è¦è¶…å‰äºå½“å‰çš„è®¡æ•°å€¼ã€‚æ³¨æ„ï¼šåœ¨å®é™…åº”ç”¨å½“ä¸­ä¸€èˆ¬ä¸ä¼šçœŸæ­£é‡‡ç”¨ Timer æ¨¡å—çš„ RTC åŠŸèƒ½æ¥å®ç°ä¸€ä¸ªä½åŠŸè€—ä¸‡å¹´å†ç³»ç»Ÿï¼Œå› ä¸ºèŠ¯ç‰‡ä¸€æ—¦å‡ºç°å¤ä½æˆ–æ–­ç”µçš„æƒ…å†µå°±ä¼šæ¸…é™¤ RTC è®¡æ•°å€¼ã€‚å–è€Œä»£ä¹‹çš„æ˜¯å†¬çœ æ¨¡å—ï¼ˆHibernation Moduleï¼‰çš„ RTC åŠŸèƒ½ï¼Œç”±äºé‡‡ç”¨äº†åå¤‡ç”µæ± ï¼Œå› æ­¤ä¸æ€•å¤ä½å’Œ VDD æ–­ç”µï¼Œå¹¶ä¸”åŠŸè€—å¾ˆä½ã€‚ 16 ä½å•æ¬¡è§¦å‘/å‘¨æœŸå®šæ—¶å™¨ä¸€ä¸ª 32 ä½çš„ Timer å¯ä»¥è¢«æ‹†åˆ†ä¸ºä¸¤ä¸ªå•ç‹¬è¿è¡Œçš„ 16 ä½å®šæ—¶/è®¡æ•°å™¨ï¼Œæ¯ä¸€ä¸ªéƒ½å¯ä»¥è¢«é…ç½®æˆå¸¦ 8 ä½é¢„åˆ†é¢‘ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰çš„ 16 ä½é€’å‡è®¡æ•°å™¨ã€‚å¦‚æœä½¿ç”¨ 8 ä½é¢„åˆ†é¢‘åŠŸèƒ½ï¼Œåˆ™ç›¸å½“äº24ä½å®šæ—¶å™¨ã€‚å…·ä½“ç”¨æ³•è·Ÿ32ä½å•æ¬¡è§¦å‘/å‘¨æœŸå®šæ—¶æ¨¡å¼ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å¯¹TimerAå’ŒTimerBçš„æ“ä½œæ˜¯åˆ†åˆ«ç‹¬ç«‹è¿›è¡Œçš„ã€‚ 16 ä½è¾“å…¥è¾¹æ²¿è®¡æ•°æ•è·åœ¨è¯¥æ¨¡å¼ä¸­ï¼ŒTimerA æˆ– TimerB è¢«é…ç½®ä¸ºèƒ½å¤Ÿæ•è·å¤–éƒ¨è¾“å…¥è„‰å†²è¾¹æ²¿äº‹ä»¶çš„é€’å‡è®¡æ•°å™¨ã€‚å…±æœ‰ 3 ç§è¾¹æ²¿äº‹ä»¶ç±»å‹ï¼šæ­£è¾¹æ²¿ã€è´Ÿè¾¹æ²¿ã€åŒè¾¹æ²¿ã€‚è¯¥æ¨¡å¼çš„å·¥ä½œè¿‡ç¨‹æ˜¯ï¼šè®¾ç½®è£…è½½å€¼ï¼Œå¹¶é¢„è®¾ä¸€ä¸ªåŒ¹é…å€¼ï¼ˆåº”å½“å°äºè£…è½½å€¼ï¼‰ï¼›è®¡æ•°ä½¿èƒ½åï¼Œåœ¨ç‰¹å®šçš„ CCP ç®¡è„šæ¯è¾“å…¥ 1 ä¸ªè„‰å†²ï¼ˆæ­£è¾¹æ²¿ã€è´Ÿè¾¹æ²¿æˆ–åŒè¾¹æ²¿æœ‰æ•ˆï¼‰ï¼Œè®¡æ•°å€¼å°±å‡ 1ï¼›å½“è®¡æ•°å€¼ä¸åŒ¹é…å€¼ç›¸ç­‰æ—¶åœæ­¢è¿è¡Œå¹¶è§¦å‘ä¸­æ–­ï¼ˆå¦‚æœä¸­æ–­å·²è¢«ä½¿èƒ½ï¼‰ã€‚å¦‚æœéœ€è¦å†æ¬¡æ•è·å¤–éƒ¨è„‰å†²ï¼Œåˆ™è¦é‡æ–°è¿›è¡Œé…ç½®ã€‚ 16 ä½è¾“å…¥è¾¹æ²¿å®šæ—¶æ•è·åœ¨è¯¥æ¨¡å¼ä¸­ï¼ŒTimerA æˆ– TimerB è¢«é…ç½®ä¸ºè‡ªç”±è¿è¡Œçš„ 16 ä½é€’å‡è®¡æ•°å™¨ï¼Œå…è®¸åœ¨è¾“å…¥ä¿¡å·çš„ä¸Šå‡æ²¿æˆ–ä¸‹é™æ²¿æ•è·äº‹ä»¶ã€‚è¯¥æ¨¡å¼çš„å·¥ä½œè¿‡ç¨‹æ˜¯ï¼šè®¾ç½®è£…è½½å€¼ï¼ˆé»˜è®¤ä¸º 0xFFFFï¼‰ã€æ•è·è¾¹æ²¿ç±»å‹ï¼›è®¡æ•°å™¨è¢«ä½¿èƒ½åå¼€å§‹è‡ªç”±è¿è¡Œï¼Œä»è£…è½½å€¼å¼€å§‹é€’å‡è®¡æ•°ï¼Œè®¡æ•°åˆ° 0 æ—¶é‡è£…åˆå€¼ï¼Œç»§ç»­è®¡æ•°ï¼›å¦‚æœä» CCP ç®¡è„šä¸Šå‡ºç°æœ‰æ•ˆçš„è¾“å…¥è„‰å†²è¾¹æ²¿äº‹ä»¶ï¼Œåˆ™å½“å‰è®¡æ•°å€¼è¢«è‡ªåŠ¨å¤åˆ¶åˆ°ä¸€ä¸ªç‰¹å®šçš„å¯„å­˜å™¨é‡Œï¼Œè¯¥å€¼ä¼šä¸€ç›´ä¿å­˜ä¸å˜ï¼Œç›´è‡³é‡åˆ°ä¸‹ä¸€ä¸ªæœ‰æ•ˆè¾“å…¥è¾¹æ²¿æ—¶è¢«åˆ·æ–°ã€‚ä¸ºäº†èƒ½å¤ŸåŠæ—¶è¯»å–æ•è·åˆ°çš„è®¡æ•°å€¼ï¼Œåº”å½“ä½¿èƒ½è¾¹æ²¿äº‹ä»¶æ•è·ä¸­æ–­ï¼Œå¹¶åœ¨ä¸­æ–­æœåŠ¡å‡½æ•°é‡Œè¯»å–ã€‚ 16 ä½ PWMTimer æ¨¡å—è¿˜å¯ä»¥ç”¨æ¥äº§ç”Ÿç®€å•çš„ PWM ä¿¡å·ã€‚åœ¨ Stellaris ç³»åˆ— ARM ä¼—å¤šå‹å·å½“ä¸­ï¼Œå¯¹äºç‰‡å†…æœªé›†æˆä¸“ç”¨ PWM æ¨¡å—çš„ï¼Œå¯ä»¥åˆ©ç”¨ Timer æ¨¡å—çš„ 16 ä½ PWM åŠŸèƒ½æ¥äº§ç”Ÿ PWM ä¿¡å·ï¼Œåªä¸è¿‡åŠŸèƒ½è¾ƒä¸ºç®€å•ã€‚å¯¹äºç‰‡å†…å·²é›†æˆä¸“ç”¨ PWM æ¨¡å—çš„ï¼Œä½†ä»ç„¶ä¸å¤Ÿç”¨æ—¶ï¼Œåˆ™å¯ä»¥ä»Timer æ¨¡å—å€Ÿç”¨ã€‚åœ¨ PWM æ¨¡å¼ä¸­ï¼ŒTimerA æˆ– TimerB è¢«é…ç½®ä¸º 16 ä½çš„é€’å‡è®¡æ•°å™¨ï¼Œé€šè¿‡è®¾ç½®é€‚å½“çš„è£…è½½å€¼ï¼ˆå†³å®š PWM å‘¨æœŸï¼‰å’ŒåŒ¹é…å€¼ï¼ˆå†³å®š PWM å ç©ºæ¯”ï¼‰æ¥è‡ªåŠ¨åœ°äº§ç”Ÿ PWM æ–¹æ³¢ä¿¡å·ä»ç›¸åº”çš„ CCP ç®¡è„šè¾“å‡ºã€‚åœ¨è½¯ä»¶ä¸Šï¼Œè¿˜å¯ä»¥æ§åˆ¶è¾“å‡ºåç›¸ï¼Œå‚è§å‡½æ•° TimerControlLevel( )ã€‚ æºç mainå‡½æ•°#include \"systemInit.h\" #include &lt;timer.h> void Time_Init( void ) { SysCtlPeriEnable(SYSCTL_PERIPH_TIMER0); // ä½¿èƒ½Timeræ¨¡å— TimerConfigure(TIMER0_BASE, TIMER_CFG_16_BIT_PAIR | // é…ç½®Timerä¸º16ä½å‘¨æœŸå®šæ—¶å™¨ TIMER_CFG_A_PERIODIC); TimerPrescaleSet(TIMER0_BASE, TIMER_A, 99); // é¢„å…ˆè¿›è¡Œ100åˆ†é¢‘ TimerLoadSet(TIMER0_BASE, TIMER_A, 30000); // è®¾ç½®Timeråˆå€¼ï¼Œå®šæ—¶500ms TimerIntEnable(TIMER0_BASE, TIMER_TIMA_TIMEOUT); // ä½¿èƒ½Timerè¶…æ—¶ä¸­æ–­ IntEnable(INT_TIMER0A); // ä½¿èƒ½Timerä¸­æ–­ IntMasterEnable(); // ä½¿èƒ½å¤„ç†å™¨ä¸­æ–­ TimerEnable(TIMER0_BASE, TIMER_A); // ä½¿èƒ½Timerè®¡æ•° } // ä¸»å‡½æ•°ï¼ˆç¨‹åºå…¥å£ï¼‰ int main(void){ jtagWait(); // é˜²æ­¢JTAGå¤±æ•ˆï¼Œé‡è¦ï¼ clockInit(); // æ—¶é’Ÿåˆå§‹åŒ–ï¼šæ™¶æŒ¯ï¼Œ6MHz Time_Init(); while(1){ } } // å®šæ—¶å™¨çš„ä¸­æ–­æœåŠ¡å‡½æ•° void Timer0A_ISR(void) { unsigned long ulStatus; ulStatus = TimerIntStatus(TIMER0_BASE, true); // è¯»å–ä¸­æ–­çŠ¶æ€ TimerIntClear(TIMER0_BASE, ulStatus); // æ¸…é™¤ä¸­æ–­çŠ¶æ€ï¼Œé‡è¦ï¼ if (ulStatus &amp; TIMER_TIMA_TIMEOUT) // å¦‚æœæ˜¯Timerè¶…æ—¶ä¸­æ–­ { } } startup_ewarm.c è¿™äº›æ˜¯è¦æ”¹çš„éƒ¨åˆ†ã€‚ å…·ä½“çš„å°±ä¸è®²è§£äº†ï¼Œåœ°å€åæœŸä¼šé™„ä¸Šã€‚","categories":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}],"tags":[{"name":"1138","slug":"1138","permalink":"http://ailous.top/tags/1138/"},{"name":"å®šæ—¶å™¨","slug":"å®šæ—¶å™¨","permalink":"http://ailous.top/tags/å®šæ—¶å™¨/"}],"keywords":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}]},{"title":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆé™€èºä»ª6050+UARTï¼‰","slug":"åµŒå…¥å¼â€”â€”1138çº¯å‡€ç‰ˆä»£ç ï¼ˆé™€èºä»ª6050+UARTï¼‰","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:40:13.675Z","comments":true,"path":"2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-tuo-luo-yi-6050-uart/","link":"","permalink":"http://ailous.top/2018/12/09/qian-ru-shi-1138-chun-jing-ban-dai-ma-tuo-luo-yi-6050-uart/","excerpt":"","text":"è¿™äº›æ˜¯æˆ‘è‡ªå·±å¸¸ç”¨çš„ä»£ç ï¼Œæ¯”å®˜æ–¹çš„è¦ç®€æ´äº›ï¼Œä¸»è¦æ˜¯è‡ªç”¨ï¼Œè¿˜æœ‰ç›¸å…³æ¨¡å—ï¼Œä½¿ç”¨ä»£ç ã€‚ å…·ä½“æ–‡ä»¶å¯ä»¥å»æˆ‘githubä¸Šä¸‹è½½ã€‚ MPU-6050 ç®€ä»‹ä¾›ç”µç”µæºï¼š3-5vï¼ˆå†…éƒ¨ä½å‹å·®ç¨³å‹ï¼‰ é€šä¿¡æ–¹å¼ï¼šæ ‡å‡†IICé€šä¿¡åè®® èŠ¯ç‰‡å†…ç½®16bit ADè½¬æ¢å™¨,16ä½æ•°æ®è¾“å‡º é™€èºä»ªèŒƒå›´ï¼šÂ±250 500 1000 2000 Â°/s åŠ é€Ÿåº¦èŒƒå›´ï¼šÂ±2Â±4Â±8Â±16g MPU-6000ï¼ˆMPU-6000æ•°æ®æ‰‹å†Œï¼‰ä¸ºå…¨çƒé¦–ä¾‹æ•´åˆæ€§6è½´è¿åŠ¨å¤„ç†ç»„ä»¶ï¼Œç›¸è¾ƒäºå¤šç»„ä»¶æ–¹æ¡ˆï¼Œå…é™¤äº†ç»„åˆé™€èºä»ªä¸åŠ é€Ÿå™¨æ—¶ä¹‹è½´é—´å·®çš„é—®é¢˜ï¼Œå‡å°‘äº†å¤§é‡çš„åŒ…è£…ç©ºé—´ã€‚MPU-6000æ•´åˆäº†3è½´é™€èºä»ªã€3è½´åŠ é€Ÿå™¨ï¼Œå¹¶å«å¯è—‰ç”±ç¬¬äºŒä¸ªI2Cç«¯å£è¿æ¥å…¶ä»–å‚ç‰Œä¹‹åŠ é€Ÿå™¨ã€ç£åŠ›ä¼ æ„Ÿå™¨ã€æˆ–å…¶ä»–ä¼ æ„Ÿå™¨çš„æ•°ä½è¿åŠ¨å¤„ç†(DMP: Digital Motion Processor)ç¡¬ä»¶åŠ é€Ÿå¼•æ“ï¼Œç”±ä¸»è¦I2Cç«¯å£ä»¥å•ä¸€æ•°æ®æµçš„å½¢å¼ï¼Œå‘åº”ç”¨ç«¯è¾“å‡ºå®Œæ•´çš„9è½´èåˆæ¼”ç®—æŠ€æœ¯ InvenSenseçš„è¿åŠ¨å¤„ç†èµ„æ–™åº“ï¼Œå¯å¤„ç†è¿åŠ¨æ„Ÿæµ‹çš„å¤æ‚æ•°æ®ï¼Œé™ä½äº†è¿åŠ¨å¤„ç†è¿ç®—å¯¹æ“ä½œç³»ç»Ÿçš„è´Ÿè·ï¼Œå¹¶ä¸ºåº”ç”¨å¼€å‘æä¾›æ¶æ„åŒ–çš„APIã€‚ MPU-6000çš„è§’é€Ÿåº¦å…¨æ ¼æ„Ÿæµ‹èŒƒå›´ä¸ºÂ±250ã€Â±500ã€Â±1000ä¸Â±2000Â°/sec (dps)ï¼Œå¯å‡†ç¡®è¿½ç·ƒå¿«é€Ÿä¸æ…¢é€ŸåŠ¨ä½œï¼Œå¹¶ä¸”ï¼Œç”¨æˆ·å¯ç¨‹å¼æ§åˆ¶çš„åŠ é€Ÿå™¨å…¨æ ¼æ„Ÿæµ‹èŒƒå›´ä¸ºÂ±2gã€Â±4gÂ±8gä¸Â±16gã€‚äº§å“ä¼ è¾“å¯é€è¿‡æœ€é«˜è‡³400kHzçš„I2Cæˆ–æœ€é«˜è¾¾20MHzçš„SPIã€‚ MPU-6000å¯åœ¨ä¸åŒç”µå‹ä¸‹å·¥ä½œï¼ŒVDDä¾›ç”µç”µå‹ä»‹ä¸º2.5VÂ±5%ã€3.0VÂ±5%æˆ–3.3VÂ±5%ï¼Œé€»è¾‘æ¥å£VVDIOä¾›ç”µä¸º1.8VÂ± 5%ã€‚MPU-6000çš„åŒ…è£…å°ºå¯¸4x4x0.9mm(QFN)ï¼Œåœ¨ä¸šç•Œæ˜¯é©å‘½æ€§çš„å°ºå¯¸ã€‚å…¶ä»–çš„ç‰¹å¾åŒ…å«å†…å»ºçš„æ¸©åº¦æ„Ÿæµ‹å™¨ã€åŒ…å«åœ¨è¿ä½œç¯å¢ƒä¸­ä»…æœ‰Â±1%å˜åŠ¨çš„æŒ¯è¡å™¨ã€‚ ç‰¹å¾ ä»¥æ•°å­—è¾“å‡º6è½´æˆ–9è½´çš„æ—‹è½¬çŸ©é˜µã€å››å…ƒæ•°(quaternion)ã€æ¬§æ‹‰è§’æ ¼å¼(Euler Angle forma)çš„èåˆæ¼”ç®—æ•°æ®ã€‚ å…·æœ‰131 LSBs/Â°/sec æ•æ„Ÿåº¦ä¸å…¨æ ¼æ„Ÿæµ‹èŒƒå›´ä¸ºÂ±250ã€Â±500ã€Â±1000ä¸Â±2000Â°/sec çš„3è½´è§’é€Ÿåº¦æ„Ÿæµ‹å™¨(é™€èºä»ª)ã€‚ å¯ç¨‹å¼æ§åˆ¶ï¼Œä¸”ç¨‹å¼æ§åˆ¶èŒƒå›´ä¸ºÂ±2gã€Â±4gã€Â±8gå’ŒÂ±16gçš„3è½´åŠ é€Ÿå™¨ã€‚ ç§»é™¤åŠ é€Ÿå™¨ä¸é™€èºä»ªè½´é—´æ•æ„Ÿåº¦ï¼Œé™ä½è®¾å®šç»™äºˆçš„å½±å“ä¸æ„Ÿæµ‹å™¨çš„é£˜ç§»ã€‚ æ•°å­—è¿åŠ¨å¤„ç†(DMP: Digital Motion Processing)å¼•æ“å¯å‡å°‘å¤æ‚çš„èåˆæ¼”ç®—æ•°æ®ã€æ„Ÿæµ‹å™¨åŒæ­¥åŒ–ã€å§¿åŠ¿æ„Ÿåº”ç­‰çš„è´Ÿè·ã€‚ è¿åŠ¨å¤„ç†æ•°æ®åº“æ”¯æŒAndroidã€Linuxä¸Windows å†…å»ºä¹‹è¿ä½œæ—¶é—´åå·®ä¸ç£åŠ›æ„Ÿæµ‹å™¨æ ¡æ­£æ¼”ç®—æŠ€æœ¯ï¼Œå…é™¤äº†å®¢æˆ·é¡»å¦å¤–è¿›è¡Œæ ¡æ­£çš„éœ€æ±‚ã€‚ ä»¥æ•°ä½è¾“å‡ºçš„æ¸©åº¦ä¼ æ„Ÿå™¨ ä»¥æ•°ä½è¾“å…¥çš„åŒæ­¥å¼•è„š(Sync pin)æ”¯æ´è§†é¢‘ç”µå­å½±ç›¸ç¨³å®šæŠ€æœ¯ä¸GPS å¯ç¨‹å¼æ§åˆ¶çš„ä¸­æ–­(interrupt)æ”¯æ´å§¿åŠ¿è¯†åˆ«ã€æ‘‡æ‘„ã€ç”»é¢æ”¾å¤§ç¼©å°ã€æ»šåŠ¨ã€å¿«é€Ÿä¸‹é™ä¸­æ–­ã€high-Gä¸­æ–­ã€é›¶åŠ¨ä½œæ„Ÿåº”ã€è§¦å‡»æ„Ÿåº”ã€æ‘‡åŠ¨æ„Ÿåº”åŠŸèƒ½ã€‚ VDDä¾›ç”µç”µå‹ä¸º2.5VÂ±5%ã€3.0VÂ±5%ã€3.3VÂ±5%ï¼›VDDIOä¸º1.8VÂ± 5% é™€èºä»ªè¿ä½œç”µæµï¼š5mAï¼Œé™€èºä»ªå¾…å‘½ç”µæµï¼š5Aï¼›åŠ é€Ÿå™¨è¿ä½œç”µæµï¼š350Aï¼ŒåŠ é€Ÿå™¨çœç”µæ¨¡å¼ç”µæµï¼š 20A@10Hz é«˜è¾¾400kHzå¿«é€Ÿæ¨¡å¼çš„I2Cï¼Œæˆ–æœ€é«˜è‡³20MHzçš„SPIä¸²è¡Œä¸»æœºæ¥å£(serial host interface) å†…å»ºé¢‘ç‡äº§ç”Ÿå™¨åœ¨æ‰€æœ‰æ¸©åº¦èŒƒå›´(full temperature range)ä»…æœ‰Â±1%é¢‘ç‡å˜åŒ–ã€‚ ä½¿ç”¨è€…äº²è‡ªæµ‹è¯• 10,000 g ç¢°æ’å®¹å¿åº¦ ä¸ºå¯æºå¼äº§å“é‡èº«è®¢ä½œçš„æœ€å°æœ€è–„åŒ…è£… (4x4x0.9mm QFN) æºç mainå‡½æ•°#include \"systemInit.h\" #include &lt;uart.h> #include &lt;ctype.h> #include &lt;string.h> #include \"uartGetPut.h\" #include &lt;stdio.h> #include &lt;timer.h> #include &lt;adc.h> #include &lt;stdio.h> #define PART_LM3S1138 #include &lt;pin_map.h> unsigned char Re_buf[11],counter=0; unsigned char ucStra[6],ucStrw[6],ucStrAngle[6]; float Value[9]; void delay(int a){ int x,y; for(x=0;x&lt;a;x++) for(y=0;y&lt;255;y++); } void DataTreating() { //float Value[8]; // char a[40]; // char b[40]; char c[40]; Value[0] = ((short)(ucStra[1]&lt;&lt;8| ucStra[0]))/32768.0*16; Value[1] = ((short)(ucStra[3]&lt;&lt;8| ucStra[2]))/32768.0*16; Value[2] = ((short)(ucStra[5]&lt;&lt;8| ucStra[4]))/32768.0*16; Value[3] = ((short)(ucStrw[1]&lt;&lt;8| ucStrw[0]))/32768.0*2000; Value[4] = ((short)(ucStrw[3]&lt;&lt;8| ucStrw[2]))/32768.0*2000; Value[5] = ((short)(ucStrw[5]&lt;&lt;8| ucStrw[4]))/32768.0*2000; Value[6] = ((short)(ucStrAngle[1]&lt;&lt;8| ucStrAngle[0]))/32768.0*180; Value[7] = ((short)(ucStrAngle[3]&lt;&lt;8| ucStrAngle[2]))/32768.0*180; Value[8] = ((short)(ucStrAngle[5]&lt;&lt;8| ucStrAngle[4]))/32768.0*180; //sprintf(a,\"åŠ é€Ÿåº¦æ˜¯x:%.2f y:%.2f z:%.2f \\r\\n\",Value[0],Value[1],Value[2]); // sprintf(b,\"è§’é€Ÿåº¦æ˜¯x:%.2f y:%.2f z:%.2f \\r\\n\",Value[3],Value[4],Value[5]); sprintf(c,\"è§’åº¦æ˜¯x:%.2f y:%.2f z:%.2f \\r\\n\",Value[6],Value[7],Value[8]); //uartPuts(a); // uartPuts(b); uartPuts(c); delay(10); } // ä¸»å‡½æ•°ï¼ˆç¨‹åºå…¥å£ï¼‰ int main(void) { //float Value[8]; jtagWait(); // é˜²æ­¢JTAGå¤±æ•ˆï¼Œé‡è¦ï¼ clockInit(); // æ—¶é’Ÿåˆå§‹åŒ–ï¼šæ™¶æŒ¯ï¼Œ6MHz uartInit(); // UARTåˆå§‹åŒ– for (;;) { DataTreating(); } } // UART2ä¸­æ–­æœåŠ¡å‡½æ•° void UART0_ISR(void) { unsigned long ulStatus; ulStatus = UARTIntStatus(UART0_BASE, true); // è¯»å–å½“å‰ä¸­æ–­çŠ¶æ€ UARTIntClear(UART0_BASE, ulStatus); // æ¸…é™¤ä¸­æ–­çŠ¶æ€ if ((ulStatus &amp; UART_INT_RX) || (ulStatus &amp; UART_INT_RT)) // è‹¥æ˜¯æ¥æ”¶ä¸­æ–­æˆ–è€… { for(;;) {Re_buf[counter]= uartGetc0(); if(counter==0&amp;&amp;Re_buf[0]!=0x55) return; //ç¬¬0å·æ•°æ®ä¸æ˜¯å¸§å¤´ counter++; if(counter==11) //æ¥æ”¶åˆ°11ä¸ªæ•°æ® { counter=0; //é‡æ–°èµ‹å€¼ï¼Œå‡†å¤‡ä¸‹ä¸€å¸§æ•°æ®çš„æ¥æ”¶ switch(Re_buf [1]) { case 0x51: ucStra[0]=Re_buf[2]; ucStra[1]=Re_buf[3]; ucStra[2]=Re_buf[4]; ucStra[3]=Re_buf[5]; ucStra[4]=Re_buf[6]; ucStra[5]=Re_buf[7]; break; case 0x52: ucStrw[0]=Re_buf[2]; ucStrw[1]=Re_buf[3]; ucStrw[2]=Re_buf[4]; ucStrw[3]=Re_buf[5]; ucStrw[4]=Re_buf[6]; ucStrw[5]=Re_buf[7]; break; case 0x53: ucStrAngle[0]=Re_buf[2]; ucStrAngle[1]=Re_buf[3]; ucStrAngle[2]=Re_buf[4]; ucStrAngle[3]=Re_buf[5]; ucStrAngle[4]=Re_buf[6]; ucStrAngle[5]=Re_buf[7]; break; } //DataTreating(); } break; } } } startup_ewarm.cï¼ˆä¿®æ”¹ä¼˜å…ˆçº§ï¼‰è¿™é‡Œç”¨çš„æ˜¯UART0 ä¼ è¾“æ–‡ä»¶ã€‚ å…·ä½“çš„å°±ä¸è®²è§£äº†ï¼Œåœ°å€åæœŸä¼šé™„ä¸Š","categories":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}],"tags":[{"name":"1138","slug":"1138","permalink":"http://ailous.top/tags/1138/"},{"name":"é™€èºä»ª6050","slug":"é™€èºä»ª6050","permalink":"http://ailous.top/tags/é™€èºä»ª6050/"},{"name":"UART","slug":"UART","permalink":"http://ailous.top/tags/UART/"}],"keywords":[{"name":"åµŒå…¥å¼","slug":"åµŒå…¥å¼","permalink":"http://ailous.top/categories/åµŒå…¥å¼/"}]},{"title":"ç®—æ³•â€”â€”æœ€é•¿å…¬å…±å­åºåˆ—","slug":"ç®—æ³•â€”â€”æœ€é•¿å…¬å…±å­åºåˆ—","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:44:15.645Z","comments":true,"path":"2018/12/09/suan-fa-zui-chang-gong-gong-zi-xu-lie/","link":"","permalink":"http://ailous.top/2018/12/09/suan-fa-zui-chang-gong-gong-zi-xu-lie/","excerpt":"","text":"ç®—æ³•â€”â€”æœ€é•¿å…¬å…±å­åºåˆ—é“¾æ¥ï¼šhttps://ac.nowcoder.com/acm/problem/19978 æ¥æºï¼šç‰›å®¢ç½‘ é¢˜ç›®æè¿°å­—ç¬¦åºåˆ—çš„å­åºåˆ—æ˜¯æŒ‡ä»ç»™å®šå­—ç¬¦åºåˆ—ä¸­éšæ„åœ°ï¼ˆä¸ä¸€å®šè¿ç»­ï¼‰å»æ‰è‹¥å¹²ä¸ªå­—ç¬¦ï¼ˆå¯èƒ½ä¸€ä¸ªä¹Ÿä¸å»æ‰ï¼‰åæ‰€å½¢æˆçš„å­—ç¬¦åºåˆ—ã€‚ä»¤ç»™å®šçš„å­—ç¬¦åºåˆ—X=â€œx0ï¼Œx1ï¼Œâ€¦ï¼Œxm-1â€ï¼Œåºåˆ—Y=â€œy0ï¼Œy1ï¼Œâ€¦ï¼Œyk-1â€æ˜¯Xçš„å­åºåˆ—ï¼Œå­˜åœ¨Xçš„ä¸€ä¸ªä¸¥æ ¼é€’å¢ä¸‹æ ‡åºåˆ— &lt; i0ï¼Œi1ï¼Œâ€¦ï¼Œik-1 &gt; ï¼Œä½¿å¾—å¯¹æ‰€æœ‰çš„j=0ï¼Œ1ï¼Œâ€¦ï¼Œk-1ï¼Œæœ‰xij = yjã€‚ä¾‹å¦‚ï¼ŒX=â€œABCBDABâ€ï¼ŒY=â€œBCDBâ€æ˜¯Xçš„ä¸€ä¸ªå­åºåˆ—ã€‚å¯¹ç»™å®šçš„ä¸¤ä¸ªå­—ç¬¦åºåˆ—ï¼Œæ±‚å‡ºä»–ä»¬æœ€é•¿çš„å…¬å…±å­åºåˆ—é•¿åº¦ï¼Œä»¥åŠæœ€é•¿å…¬å…±å­åºåˆ—ä¸ªæ•°ã€‚ è¾“å…¥æè¿°:ç¬¬1è¡Œä¸ºç¬¬1ä¸ªå­—ç¬¦åºåˆ—ï¼Œéƒ½æ˜¯å¤§å†™å­—æ¯ç»„æˆï¼Œä»¥â€.â€ç»“æŸã€‚é•¿åº¦å°äº5000ã€‚ç¬¬2è¡Œä¸ºç¬¬2ä¸ªå­—ç¬¦åºåˆ—ï¼Œéƒ½æ˜¯å¤§å†™å­—æ¯ç»„æˆï¼Œä»¥â€.â€ç»“æŸï¼Œé•¿åº¦å°äº5000ã€‚ è¾“å‡ºæè¿°:ç¬¬1è¡Œè¾“å‡ºä¸Šè¿°ä¸¤ä¸ªæœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦ã€‚ç¬¬2è¡Œè¾“å‡ºæ‰€æœ‰å¯èƒ½å‡ºç°çš„æœ€é•¿å…¬å…±å­åºåˆ—ä¸ªæ•°ï¼Œç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œåªè¦å°†ç­”æ¡ˆå¯¹100,000,000æ±‚ä½™å³å¯ã€‚ æºç ï¼š#include&lt;cstdio> #include&lt;cstring> #define N 5010 #define mod 100000000 int f[2][N],g[2][N]; char A[N],B[N]; int main() { int n,m,i,j,d; scanf(\"%s%s\",A+1,B+1); n=strlen(A+1)-1,m=strlen(B+1)-1; for(i=0;i&lt;=m;i++) f[0][i]=0,g[0][i]=1; for(d=i=1;i&lt;=n;i++,d^=1) { f[d][0]=0,g[d][0]=1; for(j=1;j&lt;=m;j++) { if(f[d^1][j]>f[d][j-1]) f[d][j]=f[d^1][j], g[d][j]=g[d^1][j]; else if(f[d^1][j]&lt;f[d][j-1]) f[d][j]=f[d][j-1],g[d][j]=g[d][j-1]; else { f[d][j]=f[d^1][j],g[d][j]=(g[d^1][j]+g[d][j-1])%mod; if(f[d][j]==f[d^1][j-1]) g[d][j]=(g[d][j]-g[d^1][j-1]+mod)%mod; } if(A[i]==B[j]) { if(f[d^1][j-1]+1>f[d][j]) f[d][j]=f[d^1][j-1]+1,g[d][j]=g[d^1][j-1]; else if(f[d^1][j-1]+1==f[d][j]) g[d][j]=(g[d][j]+g[d^1][j-1])%mod; } } } printf(\"%d\\n%d\\n\",f[n&amp;1][m],g[n&amp;1][m]); return 0; }","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://ailous.top/categories/ç®—æ³•/"}],"tags":[{"name":"å…¬å…±å­åºåˆ—","slug":"å…¬å…±å­åºåˆ—","permalink":"http://ailous.top/tags/å…¬å…±å­åºåˆ—/"}],"keywords":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://ailous.top/categories/ç®—æ³•/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”å¤è¯—æ–‡ç½‘ä¸­éªŒè¯ç ï¼ˆè¶…çº§é¹°ï¼‰","slug":"ç½‘ç»œçˆ¬è™«â€”â€”å¤è¯—æ–‡ç½‘ä¸­éªŒè¯ç ï¼ˆè¶…çº§é¹°ï¼‰","date":"2018-12-09T05:47:40.000Z","updated":"2020-05-27T07:44:35.151Z","comments":true,"path":"2018/12/09/wang-luo-pa-chong-gu-shi-wen-wang-zhong-yan-zheng-ma-chao-ji-ying/","link":"","permalink":"http://ailous.top/2018/12/09/wang-luo-pa-chong-gu-shi-wen-wang-zhong-yan-zheng-ma-chao-ji-ying/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”å¤è¯—æ–‡ç½‘ä¸­éªŒè¯ç ï¼ˆè¶…çº§é¹°ï¼‰ç›®æ ‡ç½‘å€: å¤è¯—æ–‡ç½‘ç›®æ ‡ç½‘å€ï¼šhttps://so.gushiwen.org/user/login.aspx?from=http://so.gushiwen.org/user/collect.aspx ä»»åŠ¡è¦æ±‚ï¼šï¼ˆ1ï¼‰é€šè¿‡seleniumçš„æ–¹å¼æ¨¡æ‹Ÿè¯¥ç½‘ç«™çš„ç™»å½•ï¼Œå¹¶æˆåŠŸè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼› ï¼ˆ2ï¼‰ä¿å­˜éªŒè¯ç å›¾ç‰‡ï¼Œå¹¶ä½¿ç”¨è¾“å…¥å¼éªŒè¯ç è¯†åˆ«çš„æ–¹å¼è¯†åˆ«éªŒè¯ç çš„æ–‡å­—ï¼Œè·å–åè¾“å…¥åˆ°è¾“å…¥æ¡†ä¸­ï¼Œ ï¼ˆ3ï¼‰éªŒè¯ç™»å½•æ˜¯å¦æˆåŠŸã€‚ æºç ï¼šè¶…çº§é¹°æºç ï¼šimport requests from hashlib import md5 class Chaojiying_Client(object): def __init__(self, username, password, soft_id): self.username = username # todo:æ›´æ”¹ç‚¹ä¸€ self.password = md5(password.encode(\"utf-8\")).hexdigest() self.soft_id = soft_id self.base_params = { 'user': self.username, 'pass2': self.password, 'softid': self.soft_id, } self.headers = { 'Connection': 'Keep-Alive', 'User-Agent': 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)', } def PostPic(self, im, codetype): params = { 'codetype': codetype, } params.update(self.base_params) files = {'userfile': ('ccc.jpg', im)} r = requests.post('http://upload.chaojiying.net/Upload/Processing.php', data=params, files=files, headers=self.headers) return r.json() def ReportError(self, im_id): \"\"\" im_id:æŠ¥é”™é¢˜ç›®çš„å›¾ç‰‡ID \"\"\" params = { 'id': im_id, } params.update(self.base_params) r = requests.post('http://upload.chaojiying.net/Upload/ReportError.php', data=params, headers=self.headers) return r.json() è¯†åˆ«æºç ï¼šfrom selenium import webdriver from selenium.common.exceptions import TimeoutException , NoSuchElementException import time from PIL import Image import pytesseract import chaojiying browser = webdriver.Edge(&#39;E:\\\\anaconda\\\\Scripts\\\\msedgedriver.exe&#39;) # browser = webdriver.Chrome() try: browser.get(&#39;https://so.gushiwen.org/user/login.aspx?from=http://so.gushiwen.org/user/collect.aspx&#39;) except TimeoutException: print(&#39;Time Out&#39;) try: username = browser.find_element_by_xpath(&#39;//*[@id=&quot;email&quot;]&#39;) username.send_keys(&#39;è‡ªå·±è´¦å·&#39;) time.sleep(1) password = browser.find_element_by_xpath(&#39;//*[@id=&quot;pwd&quot;]&#39;) password.send_keys(&#39;è‡ªå·±å¯†ç &#39;) time.sleep(1) pictureN = browser.find_element_by_xpath(&#39;//*[@id=&quot;imgCode&quot;]&#39;) browser.save_screenshot(&#39;login.png&#39;) loc = pictureN.location size = pictureN.size left = loc[&#39;x&#39;] top = loc[&#39;y&#39;] bottom = top+size[&#39;height&#39;] right = left+size[&#39;width&#39;] page = Image.open(&#39;login.png&#39;) Code = page.crop((left,top,right,bottom)) Code.save(&#39;code.png&#39;) chaojiying = Chaojiying_Client(&#39;è¶…çº§é¹°è´¦å·&#39;, &#39;å¯†ç &#39;, &#39;ID&#39;)#ID å…·ä½“çœ‹è½¯ä»¶IDã€‚ im = open(&#39;code.png&#39;, &#39;rb&#39;).read() text = chaojiying.PostPic(im,2004)[&#39;pic_str&#39;] print(text) # text = pytesseract.image_to_string(Image.open(&#39;code.png&#39;)) # print(text) CodeWhere = browser.find_element_by_xpath(&#39;//*[@id=&quot;code&quot;]&#39;) CodeWhere.send_keys(text) time.sleep(5) Submit = browser.find_element_by_xpath(&#39;//*[@id=&quot;denglu&quot;]&#39;) Submit.click() time.sleep(5) except NoSuchElementException: print(&#39;No Element&#39;) finally: browser.close()","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"å¤è¯—æ–‡ç½‘","slug":"å¤è¯—æ–‡ç½‘","permalink":"http://ailous.top/tags/å¤è¯—æ–‡ç½‘/"},{"name":"è¶…çº§é¹°","slug":"è¶…çº§é¹°","permalink":"http://ailous.top/tags/è¶…çº§é¹°/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"é£æ ¼è¿ç§»â€”â€”ä»£ç éƒ¨åˆ†","slug":"å·ç§¯ç¥ç»ç½‘ç»œï¼šï¼ˆä¸‰ï¼‰é£æ ¼è¿ç§»â€”â€”ä»£ç éƒ¨åˆ†","date":"2018-10-29T05:47:40.000Z","updated":"2020-05-27T07:43:33.638Z","comments":true,"path":"2018/10/29/juan-ji-shen-jing-wang-luo-san-feng-ge-qian-yi-dai-ma-bu-fen/","link":"","permalink":"http://ailous.top/2018/10/29/juan-ji-shen-jing-wang-luo-san-feng-ge-qian-yi-dai-ma-bu-fen/","excerpt":"","text":"å·ç§¯ç¥ç»ç½‘ç»œï¼šï¼ˆä¸‰ï¼‰é£æ ¼è¿ç§»â€”â€”ä»£ç éƒ¨åˆ†å¼•è¨€æœ¬æ–‡æ˜¯åœ¨ç¬¬ä¸€æ­¥é…ç½®å®Œç¯å¢ƒååŸºç¡€ä¸Šè¿è¡Œçš„ã€‚ä½¿ç”¨çš„ä¸ºç³»ç»Ÿç›´è£…çš„pythonç¯å¢ƒï¼ˆåœ¨anacondaç¯å¢ƒä¸‹ä¸€æ ·é€‚ç”¨ï¼Œåé¢æ³¨æ„çš„ç‚¹ä¼šæç¤ºçš„ã€‚ï¼‰ã€‚å‹æƒ…æç¤ºï¼šé£æ ¼è¿ç§»è·‘çš„æ—¶é—´ä¼šå¾ˆé•¿ã€‚æœ‰ç‚¹è€å¿ƒå“¦ã€‚ è‹¥æƒ³æŸ¥çœ‹ç¯å¢ƒé…ç½®æ­¥éª¤ï¼Œè¯·ç‚¹å‡»https://blog.csdn.net/weixin_41108515/article/details/103636284ï¼Œ æƒ³çŸ¥é“åŸç†ï¼Œè¯·ç‚¹å‡»https://blog.csdn.net/weixin_41108515/article/details/103650964 è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼šhttps://blog.csdn.net/weixin_41108515/article/details/103651784 è¿™é‡Œå¼•ç”¨çš„æ˜¯ï¼šhttps://blog.csdn.net/aaronjny/article/details/79681080http://zh.gluon.ai/chapter_computer-vision/neural-style.htmlè¿™ä¸¤ç¯‡éƒ½éå¸¸è¯¦ç»†ï¼Œå¹¶ä¸”ç»è°ƒè¯•å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªå¹¶æœªä½¿ç”¨tensorflowã€‚ä»¥åŠç†è®ºå¸®åŠ©çš„ä¸€ç¯‡https://juejin.im/post/5d29e818e51d454f73356de0 ç¬¬ä¸€éƒ¨åˆ† ï¼šç®€ä»‹ä¸»è¦æ“ä½œä»¥è¿™éƒ¨åˆ†ä¸ºä¸»ï¼Œè¿™ç¯‡å¼•ç”¨çš„æ˜¯tensorflowç»ƒæ‰‹é¡¹ç›®ä¸‰ã€‚å¯ä»¥é€šè¿‡ç‚¹å‡»æŸ¥çœ‹ï¼Œä»£ç ä¹Ÿæ˜¯æ‰€æœ‰æˆ‘è°ƒè¯•è¿‡çš„é‡Œé¢è¾ƒç®€æ´çš„ä¸€ä¸ªï¼Œèƒ½å¤Ÿå®ç°åŸºæœ¬åŠŸèƒ½ã€‚è¿™é‡Œåªæ˜¯æˆ‘æ·»åŠ äº†ä¸€äº›äº†è§£ï¼Œä»¥åŠæ“ä½œæ­¥éª¤ï¼Œä¾¿äºæ–°æ‰‹ç†è§£ã€‚ æ‰€è°“é£æ ¼è¿ç§»å°±æ˜¯ä¸¤å¼ å›¾ç‰‡ï¼Œä½ æœ‰ä½ çš„é£æ ¼ï¼Œæˆ‘æœ‰æˆ‘çš„å†…å®¹ã€‚ä½ ç”¨ä½ çš„æ²¹ç”»é£æ ¼å°†æˆ‘çš„å†…å®¹è¿›è¡Œç»˜ç”»ä¸€éã€‚è¿™é‡Œä½¿ç”¨çš„æ˜¯styleé‡Œé¢çš„å›¾ç‰‡ï¼ˆpainting.jpgï¼‰ï¼Œæ•°æ®é›†å°†å­˜æ”¾åœ¨ç™¾åº¦ç½‘ç›˜ã€‚ contentæ–‡ä»¶é€‰å–çš„æ˜¯qd.jpgï¼Œåœ¨contentæ–‡ä»¶å¤¹ä¸‹ã€‚æœ€ç»ˆå®ç°æ•ˆæœå¦‚ä¸‹ã€‚ ç¬¬äºŒéƒ¨åˆ† ï¼šæ“ä½œ1.è·å–æ¨¡å‹VGGæ˜¯Visual Geometry Group è¿™ä¸ªå®éªŒå®¤å‘æ˜çš„ï¼ŒVGGæ˜¯åœ¨2014å¹´çš„ ILSVRC localization and classification ä¸¤ä¸ªé—®é¢˜ä¸Šåˆ†åˆ«å–å¾—äº†ç¬¬ä¸€åå’Œç¬¬äºŒåçš„ç½‘ç»œæ¶æ„ï¼Œæ˜¯ä¸€ä¸ªå…·æœ‰é‡Œç¨‹ç¢‘æ„ä¹‰çš„CNNæ¶æ„ï¼Œå…¶ä¸­æœ€ä»¤äººéœ‡æƒŠçš„å°±æ˜¯å®ƒçš„æ·±åº¦ï¼Œè¿™é‡Œä½¿ç”¨çš„VGG19ï¼Œæœ‰19å±‚ä¹‹å¤šã€‚VGG19åŒ…å«äº†19ä¸ªéšè—å±‚ï¼ˆ16ä¸ªå·ç§¯å±‚å’Œ3ä¸ªå…¨è¿æ¥å±‚ï¼‰ã€‚VGGç½‘ç»œçš„ç»“æ„éå¸¸ä¸€è‡´ï¼Œä»å¤´åˆ°å°¾å…¨éƒ¨ä½¿ç”¨çš„æ˜¯3x3çš„å·ç§¯å’Œ2x2çš„max poolingã€‚ é€‰æ‹©ä½¿ç”¨VGGæ˜¯ä¸ºäº†å°†æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œçš„è®­ç»ƒä»å¯¹æ•°æ®é›†ç‰¹å¾çš„ä¸€æ­¥æ­¥æŠ½å–çš„è¿‡ç¨‹ï¼Œä»ç®€å•çš„ç‰¹å¾ï¼Œåˆ°å¤æ‚çš„ç‰¹å¾çš„æ¨¡å¼è½¬ä¸ºç›´æ¥ä½¿ç”¨å·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œç‰¹å¾æŠ½å–ã€‚åœ¨imagenetæ•°æ®é›†ä¸Šè®­ç»ƒå¥½çš„æ¨¡å‹ä¸Šï¼Œç›´æ¥æŠ½å–å…¶ä»–å›¾åƒçš„ç‰¹å¾ï¼Œè™½è¯´è¿™æ ·çš„æ•ˆæœå¾€å¾€æ²¡æœ‰åœ¨æ–°æ•°æ®ä¸Šé‡æ–°è®­ç»ƒçš„æ•ˆæœå¥½ï¼Œä½†èƒ½å¤ŸèŠ‚çœå¤§é‡çš„è®­ç»ƒæ—¶é—´ï¼Œåœ¨ç‰¹å®šæƒ…å†µä¸‹éå¸¸æœ‰ç”¨ã€‚ CNNåœ¨å›¾ç‰‡å¤„ç†ä¸Šè¡¨ç°è‰¯å¥½ï¼ŒVGG19æå‡ºåï¼Œä¹Ÿè¢«ç”¨åœ¨å›¾åƒå¤„ç†ä¸Šã€‚æˆ‘è¿™é‡Œè¦ç”¨åˆ°çš„VGG19æ¨¡å‹å°±æ˜¯åœ¨imagenetæ•°æ®é›†ä¸Šé¢„è®­ç»ƒçš„æ¨¡å‹ã€‚æ³¨ï¼š é¢„è®­ç»ƒå¥½çš„VGG19æ¨¡å‹å¯ä»¥ä»http://www.vlfeat.org/matconvnet/models/beta16/imagenet-vgg-verydeep-19.matä¸‹è½½ï¼Œä¸‹è½½è¾ƒæ…¢çš„è¯ï¼Œç½‘ç›˜https://pan.baidu.com/s/1uFinsEArbrgYRc2FWY9zVwï¼šã€‚ 2.æ¨¡å‹ä¿®æ”¹è¿™é‡Œæ˜¯æŒ‡ä»é¢„è®­ç»ƒçš„VGGæ¨¡å‹ä¸­ï¼Œè·å–å·ç§¯å±‚éƒ¨åˆ†çš„å‚æ•°ï¼Œç”¨äºæ„å»ºæˆ‘ä»¬è‡ªå·±çš„æ¨¡å‹ã€‚VGG19ä¸­çš„å…¨è¿æ¥å±‚èˆå¼ƒæ‰ï¼Œè¿™ä¸€éƒ¨åˆ†å¯¹æå–å›¾åƒç‰¹å¾åŸºæœ¬æ— ç”¨ã€‚VGG19æ¨¡å‹ä¸­æƒé‡ç”±ImageNetè®­ç»ƒè€Œæ¥ï¼Œå…¨éƒ¨æ˜¯ä½œä¸ºå¸¸é‡ä½¿ç”¨çš„ï¼Œè¿™äº›å‚æ•°æ˜¯ä¸ä¼šå†è¢«è®­ç»ƒçš„ï¼Œåœ¨åå‘ä¼ æ’­çš„è¿‡ç¨‹ä¸­ä¹Ÿä¸ä¼šæ”¹å˜ã€‚ ç°åœ¨çŸ¥é“å›¾ç‰‡çš„å†…å®¹è¡¨ç¤ºå’Œé£æ ¼è¡¨ç¤ºåœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­æ˜¯å¯åˆ†ç¦»çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç‹¬ç«‹åœ°æ“çºµè¿™ä¸¤ç§è¡¨ç¤ºæ¥äº§ç”Ÿæ–°çš„æœ‰æ„ŸçŸ¥æ„ä¹‰ä¸Šçš„å›¾ç‰‡ã€‚ é£æ ¼è¿ç§»å›¾ç‰‡æ˜¯é€šè¿‡å¯»æ‰¾ä¸€ä¸ªåŒæ—¶åŒ¹é…ç…§ç‰‡å†…å®¹å’Œå¯¹åº”çš„è‰ºæœ¯é£æ ¼çš„å›¾ç‰‡çš„æ–¹æ³•è€Œç”Ÿæˆçš„ã€‚è¿™äº›åˆæˆå›¾ç‰‡åœ¨ä¿ç•™åŸå§‹ç…§ç‰‡çš„å…¨å±€å¸ƒç½®çš„åŒæ—¶ï¼Œç»§æ‰¿äº†å„ç§è‰ºæœ¯å›¾ç‰‡çš„ä¸åŒè‰ºæœ¯é£æ ¼ã€‚é£æ ¼è¡¨ç¤ºæ˜¯ä¸€ä¸ªå¤šå±‚æ¬¡çš„è¡¨è¾¾ï¼ŒåŒ…æ‹¬äº†ç¥ç»ç½‘ç»œç»“æ„çš„å¤šä¸ªå±‚æ¬¡ã€‚å½“é£æ ¼è¡¨ç¤ºåªåŒ…å«äº†å°‘é‡çš„ä½å±‚ç»“æ„ï¼Œï¼ˆç®€å•ç†è§£ä¸ºè®­ç»ƒæ¨¡å‹æ¬¡æ•°å°‘ï¼Œæ¨¡å‹ç‰¹å¾ä¸å¤Ÿå¼ºåŠ¿ï¼‰é£æ ¼çš„å°±å˜å¾—æ›´åŠ å±€éƒ¨åŒ–ï¼Œäº§ç”Ÿä¸åŒçš„è§†è§‰æ•ˆæœã€‚å½“é£æ ¼è¡¨ç¤ºç”±ç½‘ç»œçš„é«˜å±‚ç»“æ„è¡¨ç¤ºæ—¶ï¼Œå›¾åƒçš„ç»“æ„ä¼šåœ¨æ›´å¤§çš„èŒƒå›´å†…å’Œè¿™ç§é£æ ¼åŒ¹é…ï¼ˆç‰¹å¾å¼ºåŠ¿ï¼Œä¼šæ”¹å˜æ•´ä¸ªå›¾çš„é£æ ¼ï¼‰ï¼Œäº§ç”Ÿåˆ«æ ·çš„æ„Ÿè§‰ã€‚ç†è®ºä¸Šç®€å•ç†è§£äº†ï¼Œå¼€å§‹æ“ä½œã€‚ è¿™é‡Œå»ºç«‹pyæ–‡ä»¶ models.pyï¼Œä¸‹é¢å†…å®¹æˆ‘ä¼šå†™åœ¨æ³¨é‡Šé‡Œã€‚ # å¯¼å…¥å¿…é¡»çš„åŒ… import tensorflow as tf import numpy as np import settings import scipy.io import scipy.misc class Model(object): def __init__(self, content_path, style_path): self.content = self.loadimg(content_path) # åŠ è½½å†…å®¹å›¾ç‰‡ self.style = self.loadimg(style_path) # åŠ è½½é£æ ¼å›¾ç‰‡ self.random_img = self.get_random_img() # ç”Ÿæˆå™ªéŸ³å†…å®¹å›¾ç‰‡ self.net = self.vggnet() # å»ºç«‹vggç½‘ç»œ def vggnet(self): # è¯»å–é¢„è®­ç»ƒçš„vggæ¨¡å‹ # è¿™é‡Œè£…çš„æ˜¯miscï¼Œå®‰è£…opencvçš„ä¹Ÿäº¦å¯ä»¥ä½¿ç”¨opencvç­‰å…¶ä»–æ–¹æ³• vgg = scipy.io.loadmat(settings.VGG_MODEL_PATH) vgg_layers = vgg['layers'][0] net = {} # ä½¿ç”¨é¢„è®­ç»ƒçš„æ¨¡å‹å‚æ•°æ„å»ºvggç½‘ç»œçš„å·ç§¯å±‚å’Œæ± åŒ–å±‚ # å…¨è¿æ¥å±‚ä¸éœ€è¦ # æ³¨æ„ï¼Œé™¤äº†inputä¹‹å¤–ï¼Œè¿™é‡Œå‚æ•°éƒ½ä¸ºå¸¸é‡ï¼Œä¸è®­ç»ƒvggçš„å‚æ•°ï¼ˆæƒé‡æ¯”ï¼‰ï¼Œè¿™ä¸ªä»¥åŠè®­ç»ƒå®Œä¸éœ€è°ƒæ•´ã€‚ # éœ€è¦è¿›è¡Œè®­ç»ƒçš„æ˜¯inputï¼Œå®ƒå³æ˜¯æˆ‘ä»¬æœ€ç»ˆç”Ÿæˆçš„å›¾åƒ net['input'] = tf.Variable(np.zeros([1, settings.IMAGE_HEIGHT, settings.IMAGE_WIDTH, 3]), dtype=tf.float32) # å‚æ•°å¯¹åº”çš„å±‚æ•°å¯ä»¥å‚è€ƒvggæ¨¡å‹å›¾ net['conv1_1'] = self.conv_relu(net['input'], self.get_wb(vgg_layers, 0)) net['conv1_2'] = self.conv_relu(net['conv1_1'], self.get_wb(vgg_layers, 2)) net['pool1'] = self.pool(net['conv1_2']) net['conv2_1'] = self.conv_relu(net['pool1'], self.get_wb(vgg_layers, 5)) net['conv2_2'] = self.conv_relu(net['conv2_1'], self.get_wb(vgg_layers, 7)) net['pool2'] = self.pool(net['conv2_2']) net['conv3_1'] = self.conv_relu(net['pool2'], self.get_wb(vgg_layers, 10)) net['conv3_2'] = self.conv_relu(net['conv3_1'], self.get_wb(vgg_layers, 12)) net['conv3_3'] = self.conv_relu(net['conv3_2'], self.get_wb(vgg_layers, 14)) net['conv3_4'] = self.conv_relu(net['conv3_3'], self.get_wb(vgg_layers, 16)) net['pool3'] = self.pool(net['conv3_4']) net['conv4_1'] = self.conv_relu(net['pool3'], self.get_wb(vgg_layers, 19)) net['conv4_2'] = self.conv_relu(net['conv4_1'], self.get_wb(vgg_layers, 21)) net['conv4_3'] = self.conv_relu(net['conv4_2'], self.get_wb(vgg_layers, 23)) net['conv4_4'] = self.conv_relu(net['conv4_3'], self.get_wb(vgg_layers, 25)) net['pool4'] = self.pool(net['conv4_4']) net['conv5_1'] = self.conv_relu(net['pool4'], self.get_wb(vgg_layers, 28)) net['conv5_2'] = self.conv_relu(net['conv5_1'], self.get_wb(vgg_layers, 30)) net['conv5_3'] = self.conv_relu(net['conv5_2'], self.get_wb(vgg_layers, 32)) net['conv5_4'] = self.conv_relu(net['conv5_3'], self.get_wb(vgg_layers, 34)) net['pool5'] = self.pool(net['conv5_4']) return net def conv_relu(self, input, wb): \"\"\" è¿›è¡Œå…ˆå·ç§¯ã€åreluçš„è¿ç®— :param input: è¾“å…¥å±‚ :param wb: wb[0],wb[1] == w,b :return: reluåçš„ç»“æœ \"\"\" conv = tf.nn.conv2d(input, wb[0], strides=[1, 1, 1, 1], padding='SAME') relu = tf.nn.relu(conv + wb[1]) return relu def pool(self, input): \"\"\" è¿›è¡Œmax_poolæ“ä½œ :param input: è¾“å…¥å±‚ :return: æ± åŒ–åçš„ç»“æœ \"\"\" return tf.nn.max_pool(input, ksize=[1, 2, 2, 1], strides=[1, 2, 2, 1], padding='SAME') def get_wb(self, layers, i): \"\"\" ä»é¢„è®­ç»ƒå¥½çš„vggæ¨¡å‹ä¸­è¯»å–å‚æ•° :param layers: è®­ç»ƒå¥½çš„vggæ¨¡å‹ :param i: vggæŒ‡å®šå±‚æ•° :return: è¯¥å±‚çš„w,b \"\"\" w = tf.constant(layers[i][0][0][0][0][0]) bias = layers[i][0][0][0][0][1] b = tf.constant(np.reshape(bias, (bias.size))) return w, b def get_random_img(self): \"\"\" æ ¹æ®å™ªéŸ³å’Œå†…å®¹å›¾ç‰‡ï¼Œç”Ÿæˆä¸€å¼ éšæœºå›¾ç‰‡ :return: \"\"\" noise_image = np.random.uniform(-20, 20, [1, settings.IMAGE_HEIGHT, settings.IMAGE_WIDTH, 3]) random_img = noise_image * settings.NOISE + self.content * (1 - settings.NOISE) return random_img def loadimg(self, path): \"\"\" åŠ è½½ä¸€å¼ å›¾ç‰‡ï¼Œå°†å…¶è½¬åŒ–ä¸ºç¬¦åˆè¦æ±‚çš„æ ¼å¼ :param path: :return: \"\"\" # è¯»å–å›¾ç‰‡ image = scipy.misc.imread(path) # é‡æ–°è®¾å®šå›¾ç‰‡å¤§å° image = scipy.misc.imresize(image, [settings.IMAGE_HEIGHT, settings.IMAGE_WIDTH]) # æ”¹å˜æ•°ç»„å½¢çŠ¶ï¼Œå…¶å®å°±æ˜¯æŠŠå®ƒå˜æˆä¸€ä¸ªbatch_size=1çš„batch image = np.reshape(image, (1, settings.IMAGE_HEIGHT, settings.IMAGE_WIDTH, 3)) # å‡å»å‡å€¼ï¼Œä½¿å…¶æ•°æ®åˆ†å¸ƒæ¥è¿‘0 image = image - settings.IMAGE_MEAN_VALUE return image if __name__ == '__main__': Model(settings.CONTENT_IMAGE, settings.STYLE_IMAGE) 3.æ¨¡å‹è®­ç»ƒä½†æ˜¯å®é™…ä¸Šï¼Œå›¾ç‰‡çš„å†…å®¹å’Œé£æ ¼æ˜¯ä¸èƒ½å¤Ÿè¢«å®Œå…¨åˆ†ç¦»çš„ã€‚å½“æˆ‘ä»¬åˆæˆå›¾ç‰‡æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸æ‰¾ä¸å‡ºä¸€å¼ èƒ½å¤ŸåŒ¹é…æŸä¸ªå›¾ç‰‡å†…å®¹å’Œå¦ä¸€ç§å›¾ç‰‡é£æ ¼çš„å›¾ç‰‡ã€‚åœ¨æˆ‘ä»¬åˆæˆå›¾ç‰‡çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æœ€å°åŒ–çš„æŸå¤±å‡½æ•°åŒ…å«å†…å®¹å’Œé£æ ¼ï¼Œä½†å®ƒä»¬æ˜¯åˆ†å¼€çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¹³æ»‘åœ°è°ƒæ•´å†…å®¹å’Œé£æ ¼çš„æƒé‡æ¯”ä¾‹ã€‚å½“æŸå¤±å‡½æ•°åˆ†é…åœ¨å†…å®¹å’Œé£æ ¼çš„æƒé‡ä¸åŒæ—¶ï¼Œåˆæˆäº§ç”Ÿçš„å›¾ç‰‡æ•ˆæœä¹Ÿå®Œå…¨ä¸ä¸€æ ·ã€‚æˆ‘ä»¬éœ€è¦é€‚å½“åœ°è°ƒæ•´å†…å®¹è¡¨ç¤ºå’Œé£æ ¼è¡¨ç¤ºçš„æƒé‡æ¯”æ¥äº§ç”Ÿå…·æœ‰è§†è§‰æ„ŸæŸ“åŠ›çš„å›¾ç‰‡ã€‚æ˜¯å¦èƒ½å¤Ÿæ‰¾åˆ°åˆé€‚çš„æƒé‡æ¯”æ˜¯èƒ½å¦äº§ç”Ÿä»¤äººæ»¡æ„çš„å›¾ç‰‡çš„å…³é”®å› ç´ ã€‚ å°±æ˜¯å°†è¾“å…¥å±‚çš„Variableè®­ç»ƒåˆ°æ»¡æ„çš„æ¯”ä¾‹ï¼Œæœ€å¼€å§‹è¾“å…¥ä¸€å¼ å™ªéŸ³å›¾ç‰‡ï¼Œç„¶åä¸æ–­åœ°æ ¹æ®å†…å®¹losså’Œé£æ ¼losså¯¹å…¶è¿›è¡Œè°ƒæ•´ï¼Œç›´åˆ°ä¸€å®šæ¬¡æ•°åï¼Œè¯¥å›¾ç‰‡å…¼å…·äº†é£æ ¼å›¾ç‰‡çš„é£æ ¼ä»¥åŠå†…å®¹å›¾ç‰‡çš„å†…å®¹ã€‚å½“è®­ç»ƒç»“æŸæ—¶ï¼Œè¾“å…¥å±‚çš„å‚æ•°å°±æ˜¯æˆ‘ä»¬ç”Ÿæˆçš„å›¾ç‰‡ã€‚ è¿™é‡Œå»ºç«‹pyæ–‡ä»¶ train.pyï¼Œä¸‹é¢å†…å®¹æˆ‘ä¼šå†™åœ¨æ³¨é‡Šé‡Œã€‚ # -*- coding: utf-8 -*- import tensorflow as tf import settings import models import numpy as np import scipy.misc def loss(sess, model): \"\"\" å®šä¹‰æ¨¡å‹çš„æŸå¤±å‡½æ•° :param sess: tf session :param model: ç¥ç»ç½‘ç»œæ¨¡å‹ :return: å†…å®¹æŸå¤±å’Œé£æ ¼æŸå¤±çš„åŠ æƒå’ŒæŸå¤± \"\"\" # å…ˆè®¡ç®—å†…å®¹æŸå¤±å‡½æ•° # è·å–å®šä¹‰å†…å®¹æŸå¤±çš„vggå±‚åç§°åˆ—è¡¨åŠæƒé‡ content_layers = settings.CONTENT_LOSS_LAYERS # å°†å†…å®¹å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼Œæ–¹ä¾¿åé¢æå–å†…å®¹å›¾ç‰‡åœ¨å„å±‚ä¸­çš„ç‰¹å¾çŸ©é˜µ sess.run(tf.assign(model.net['input'], model.content)) # å†…å®¹æŸå¤±ç´¯åŠ é‡ content_loss = 0.0 # é€ä¸ªå–å‡ºè¡¡é‡å†…å®¹æŸå¤±çš„vggå±‚åç§°åŠå¯¹åº”æƒé‡ for layer_name, weight in content_layers: # æå–å†…å®¹å›¾ç‰‡åœ¨layer_nameå±‚ä¸­çš„ç‰¹å¾çŸ©é˜µ p = sess.run(model.net[layer_name]) # æå–å™ªéŸ³å›¾ç‰‡åœ¨layer_nameå±‚ä¸­çš„ç‰¹å¾çŸ©é˜µ x = model.net[layer_name] # é•¿xå®½ M = p.shape[1] * p.shape[2] # ä¿¡é“æ•° N = p.shape[3] # æ ¹æ®å…¬å¼è®¡ç®—æŸå¤±ï¼Œå¹¶è¿›è¡Œç´¯åŠ  content_loss += (1.0 / (2 * M * N)) * tf.reduce_sum(tf.pow(p - x, 2)) * weight # å°†æŸå¤±å¯¹å±‚æ•°å–å¹³å‡ content_loss /= len(content_layers) # å†è®¡ç®—é£æ ¼æŸå¤±å‡½æ•° style_layers = settings.STYLE_LOSS_LAYERS # å°†é£æ ¼å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼Œæ–¹ä¾¿åé¢æå–é£æ ¼å›¾ç‰‡åœ¨å„å±‚ä¸­çš„ç‰¹å¾çŸ©é˜µ sess.run(tf.assign(model.net['input'], model.style)) # é£æ ¼æŸå¤±ç´¯åŠ é‡ style_loss = 0.0 # é€ä¸ªå–å‡ºè¡¡é‡é£æ ¼æŸå¤±çš„vggå±‚åç§°åŠå¯¹åº”æƒé‡ for layer_name, weight in style_layers: # æå–é£æ ¼å›¾ç‰‡åœ¨layer_nameå±‚ä¸­çš„ç‰¹å¾çŸ©é˜µ a = sess.run(model.net[layer_name]) # æå–å™ªéŸ³å›¾ç‰‡åœ¨layer_nameå±‚ä¸­çš„ç‰¹å¾çŸ©é˜µ x = model.net[layer_name] # é•¿xå®½ M = a.shape[1] * a.shape[2] # ä¿¡é“æ•° N = a.shape[3] # æ±‚é£æ ¼å›¾ç‰‡ç‰¹å¾çš„gramçŸ©é˜µ A = gram(a, M, N) # æ±‚å™ªéŸ³å›¾ç‰‡ç‰¹å¾çš„gramçŸ©é˜µ G = gram(x, M, N) # æ ¹æ®å…¬å¼è®¡ç®—æŸå¤±ï¼Œå¹¶è¿›è¡Œç´¯åŠ  style_loss += (1.0 / (4 * M * M * N * N)) * tf.reduce_sum(tf.pow(G - A, 2)) * weight # å°†æŸå¤±å¯¹å±‚æ•°å–å¹³å‡ style_loss /= len(style_layers) # å°†å†…å®¹æŸå¤±å’Œé£æ ¼æŸå¤±åŠ æƒæ±‚å’Œï¼Œæ„æˆæ€»æŸå¤±å‡½æ•° loss = settings.ALPHA * content_loss + settings.BETA * style_loss return loss def gram(x, size, deep): \"\"\" åˆ›å»ºç»™å®šçŸ©é˜µçš„æ ¼è±å§†çŸ©é˜µï¼Œç”¨æ¥è¡¡é‡é£æ ¼ :param x:ç»™å®šçŸ©é˜µ :param size:çŸ©é˜µçš„è¡Œæ•°ä¸åˆ—æ•°çš„ä¹˜ç§¯ :param deep:çŸ©é˜µä¿¡é“æ•° :return:æ ¼è±å§†çŸ©é˜µ \"\"\" # æ”¹å˜shapeä¸ºï¼ˆsize,deepï¼‰ x = tf.reshape(x, (size, deep)) # æ±‚xTx g = tf.matmul(tf.transpose(x), x) return g def train(): # åˆ›å»ºä¸€ä¸ªæ¨¡å‹ model = models.Model(settings.CONTENT_IMAGE, settings.STYLE_IMAGE) # åˆ›å»ºsession with tf.Session() as sess: # å…¨å±€åˆå§‹åŒ– sess.run(tf.global_variables_initializer()) # å®šä¹‰æŸå¤±å‡½æ•° cost = loss(sess, model) # åˆ›å»ºä¼˜åŒ–å™¨ optimizer = tf.train.AdamOptimizer(1.0).minimize(cost) # å†åˆå§‹åŒ–ä¸€æ¬¡ï¼ˆä¸»è¦é’ˆå¯¹äºç¬¬ä¸€æ¬¡åˆå§‹åŒ–ååˆå®šä¹‰çš„è¿ç®—ï¼Œä¸ç„¶å¯èƒ½ä¼šæŠ¥é”™ï¼‰ sess.run(tf.global_variables_initializer()) # ä½¿ç”¨å™ªå£°å›¾ç‰‡è¿›è¡Œè®­ç»ƒ sess.run(tf.assign(model.net['input'], model.random_img)) # è¿­ä»£æŒ‡å®šæ¬¡æ•° for step in range(settings.TRAIN_STEPS): # è¿›è¡Œä¸€æ¬¡åå‘ä¼ æ’­ sess.run(optimizer) # æ¯éš”ä¸€å®šæ¬¡æ•°ï¼Œè¾“å‡ºä¸€ä¸‹è¿›åº¦ï¼Œå¹¶ä¿å­˜å½“å‰è®­ç»ƒç»“æœ if step % 50 == 0: print('step {} is down.'.format(step)) # å–å‡ºinputçš„å†…å®¹ï¼Œè¿™æ˜¯ç”Ÿæˆçš„å›¾ç‰‡ img = sess.run(model.net['input']) # è®­ç»ƒè¿‡ç¨‹æ˜¯å‡å»å‡å€¼çš„ï¼Œè¿™é‡Œè¦åŠ ä¸Š img += settings.IMAGE_MEAN_VALUE # è¿™é‡Œæ˜¯ä¸€ä¸ªbatch_size=1çš„batchï¼Œæ‰€ä»¥img[0]æ‰æ˜¯å›¾ç‰‡å†…å®¹ img = img[0] # å°†åƒç´ å€¼é™å®šåœ¨0-255ï¼Œå¹¶è½¬ä¸ºæ•´å‹ img = np.clip(img, 0, 255).astype(np.uint8) # ä¿å­˜å›¾ç‰‡ scipy.misc.imsave('{}-{}.jpg'.format(settings.OUTPUT_IMAGE,step), img) # ä¿å­˜æœ€ç»ˆè®­ç»ƒç»“æœ img = sess.run(model.net['input']) img += settings.IMAGE_MEAN_VALUE img = img[0] img = np.clip(img, 0, 255).astype(np.uint8) scipy.misc.imsave('{}.jpg'.format(settings.OUTPUT_IMAGE), img) if __name__ == '__main__': train() 4.ç³»ç»Ÿæ–‡ä»¶é…ç½®è¿™é‡Œå»ºç«‹pyæ–‡ä»¶ setting.pyã€‚ # -*- coding: utf-8 -*- # å†…å®¹å›¾ç‰‡è·¯å¾„ CONTENT_IMAGE = 'content/qd.jpg' # è·¯å¾„/å›¾ç‰‡ è‡ªå·±åœ¨å·¥ç¨‹æ–‡ä»¶å¤¹ä¸‹å»ºç«‹ã€‚ # é£æ ¼å›¾ç‰‡è·¯å¾„ STYLE_IMAGE = 'style/painting.jpg' # è·¯å¾„/å›¾ç‰‡ è‡ªå·±åœ¨å·¥ç¨‹æ–‡ä»¶å¤¹ä¸‹å»ºç«‹ã€‚ # è¾“å‡ºå›¾ç‰‡è·¯å¾„ OUTPUT_IMAGE = 'output/output' # è·¯å¾„/å›¾ç‰‡å¼€å§‹å è‡ªå·±åœ¨å·¥ç¨‹æ–‡ä»¶å¤¹ä¸‹å»ºç«‹ã€‚ # é¢„è®­ç»ƒçš„vggæ¨¡å‹è·¯å¾„ VGG_MODEL_PATH = 'imagenet-vgg-verydeep-19.mat' # ç›´æ¥ç½®äºå·¥ç¨‹æ–‡ä»¶å¤¹å³å¯ã€‚ # å›¾ç‰‡å®½åº¦ IMAGE_WIDTH = 450 # å›¾ç‰‡é«˜åº¦ IMAGE_HEIGHT = 300 # å®šä¹‰è®¡ç®—å†…å®¹æŸå¤±çš„vggå±‚åç§°åŠå¯¹åº”æƒé‡çš„åˆ—è¡¨ CONTENT_LOSS_LAYERS = [('conv4_2', 0.5),('conv5_2',0.5)] # å®šä¹‰è®¡ç®—é£æ ¼æŸå¤±çš„vggå±‚åç§°åŠå¯¹åº”æƒé‡çš„åˆ—è¡¨ STYLE_LOSS_LAYERS = [('conv1_1', 0.2), ('conv2_1', 0.2), ('conv3_1', 0.2), ('conv4_1', 0.2), ('conv5_1', 0.2)] # å™ªéŸ³æ¯”ç‡ NOISE = 0.5 # å›¾ç‰‡RGBå‡å€¼ IMAGE_MEAN_VALUE = [128.0, 128.0, 128.0] # å†…å®¹æŸå¤±æƒé‡ ALPHA = 1 # é£æ ¼æŸå¤±æƒé‡ BETA = 500 # è®­ç»ƒæ¬¡æ•° TRAIN_STEPS = 3000 # è¿™é‡Œæ¨èå‡ ç™¾æ¬¡å°±è¡Œï¼Œç¡®å®æ—¶é—´å¤ªé•¿ã€‚","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://ailous.top/categories/äººå·¥æ™ºèƒ½/"}],"tags":[{"name":"å·ç§¯ç¥ç»ç½‘ç»œ","slug":"å·ç§¯ç¥ç»ç½‘ç»œ","permalink":"http://ailous.top/tags/å·ç§¯ç¥ç»ç½‘ç»œ/"},{"name":"é£æ ¼è¿ç§»","slug":"é£æ ¼è¿ç§»","permalink":"http://ailous.top/tags/é£æ ¼è¿ç§»/"}],"keywords":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://ailous.top/categories/äººå·¥æ™ºèƒ½/"}]},{"title":"é£æ ¼è¿ç§»â€”â€”åŸç†éƒ¨åˆ†","slug":"å·ç§¯ç¥ç»ç½‘ç»œï¼šï¼ˆäºŒï¼‰é£æ ¼è¿ç§»â€”â€”åŸç†éƒ¨åˆ†","date":"2018-10-28T05:47:40.000Z","updated":"2020-05-26T23:44:54.207Z","comments":true,"path":"2018/10/28/juan-ji-shen-jing-wang-luo-er-feng-ge-qian-yi-yuan-li-bu-fen/","link":"","permalink":"http://ailous.top/2018/10/28/juan-ji-shen-jing-wang-luo-er-feng-ge-qian-yi-yuan-li-bu-fen/","excerpt":"","text":"å·ç§¯ç¥ç»ç½‘ç»œï¼šï¼ˆäºŒï¼‰é£æ ¼è¿ç§»â€”â€”åŸç†éƒ¨åˆ†å¼•è¨€æœ¬æ–‡æ˜¯åœ¨ç¬¬ä¸€æ­¥é…ç½®å®Œç¯å¢ƒååŸºç¡€ä¸Šè¿è¡Œçš„ã€‚ä½¿ç”¨çš„ä¸ºç³»ç»Ÿç›´è£…çš„pythonç¯å¢ƒï¼ˆåœ¨anacondaç¯å¢ƒä¸‹ä¸€æ ·é€‚ç”¨ï¼Œåé¢æ³¨æ„çš„ç‚¹ä¼šæç¤ºçš„ã€‚ï¼‰ã€‚è‹¥æƒ³æŸ¥çœ‹ç¯å¢ƒé…ç½®æ­¥éª¤ï¼Œè¯·ç‚¹å‡»https://blog.csdn.net/weixin_41108515/article/details/103636284ï¼Œå› åŸç†éƒ¨åˆ†ç¯‡å¹…è¾ƒå¤šï¼Œæ‰€ä»¥å°†æ‰€æœ‰ä»£ç ï¼ŒçŸ¥è¯†éƒ¨åˆ†ç§»åˆ°ç¬¬ä¸‰ç¯‡åšå®¢ä¸Šï¼Œè‹¥æ˜¯å¯¹äºè¯¥åŸç†äº†è§£ç†Ÿæ‚‰ï¼Œæˆ–åªæƒ³æ“ä½œä¸éœ€æ·±å…¥çš„ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨ç¬¬ä¸‰ç¯‡ä¸Šã€‚&nbsp;è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼šhttps://blog.csdn.net/weixin_41108515/article/details/103650964&nbsp;è¿™é‡Œå¼•ç”¨çš„æ˜¯ï¼šhttp://zh.gluon.ai/chapter_computer-vision/neural-style.htmlhttps://blog.csdn.net/aaronjny/article/details/79681080è¿™ä¸¤ç¯‡éƒ½éå¸¸è¯¦ç»†ï¼Œå¹¶ä¸”ç»è°ƒè¯•å¯ä»¥ä½¿ç”¨ã€‚ æ¶‰åŠåˆ°çš„ç›¸å…³åŸç†ï¼š1ã€ç¥ç»ç½‘ç»œéƒ¨åˆ†åŸç†ï¼š1.1 ç¥ç»ç½‘ç»œåŸºç¡€ä»‹ç»ç¥ç»ç½‘ç»œåŸºæœ¬å¯ä»¥åˆ†æˆä¸¤ç§ï¼šä¸€ç§ä¸ºç”Ÿç‰©ç¥ç»ç½‘ç»œï¼Œä¸€ç§ä¸ºäººå·¥ç¥ç»ç½‘ç»œã€‚ç”Ÿç‰©ç¥ç»ç½‘ç»œä¸€èˆ¬æ˜¯æŒ‡ç”Ÿç‰©çš„å¤§è„‘ç¥ç»å…ƒï¼Œç»†èƒï¼Œè§¦ç‚¹ç­‰ç»„æˆçš„ç½‘ç»œï¼Œç”¨äºäº§ç”Ÿç”Ÿç‰©çš„æ„è¯†ï¼Œå¸®åŠ©ç”Ÿç‰©è¿›è¡Œæ€è€ƒå’Œè¡ŒåŠ¨ã€‚å…¶ä¸»è¦æ˜¯ç”±ç”Ÿç‰©ç¥ç»å…ƒæ„æˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚äººå·¥ç¥ç»ç½‘ç»œå°±æ˜¯æ¨¡æ‹Ÿäººæ€ç»´çš„ç¬¬äºŒç§æ–¹å¼ã€‚è¿™æ˜¯ä¸€ä¸ªéçº¿æ€§åŠ¨åŠ›å­¦ç³»ç»Ÿï¼Œå…¶ç‰¹è‰²åœ¨äºä¿¡æ¯çš„åˆ†å¸ƒå¼å­˜å‚¨å’Œå¹¶è¡ŒååŒå¤„ç†ã€‚è™½ç„¶å•ä¸ªç¥ç»å…ƒçš„ç»“æ„æå…¶ç®€å•ï¼ŒåŠŸèƒ½æœ‰é™ï¼Œä½†å¤§é‡ç¥ç»å…ƒæ„æˆçš„ç½‘ç»œç³»ç»Ÿæ‰€èƒ½å®ç°çš„è¡Œä¸ºå´æ˜¯æå…¶ä¸°å¯Œå¤šå½©çš„ã€‚ç¥ç»ç½‘ç»œçš„ç ”ç©¶å†…å®¹ç›¸å½“å¹¿æ³›ï¼Œåæ˜ äº†å¤šå­¦ç§‘äº¤å‰æŠ€æœ¯é¢†åŸŸçš„ç‰¹ç‚¹ã€‚ä¸»è¦çš„ç ”ç©¶å·¥ä½œé›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼šï¼ˆ1ï¼‰ç”Ÿç‰©åŸå‹ç ”ç©¶ã€‚ä»ç”Ÿç†å­¦ã€å¿ƒç†å­¦ã€è§£å‰–å­¦ã€è„‘ç§‘å­¦ã€ç—…ç†å­¦ç­‰ç”Ÿç‰©ç§‘å­¦æ–¹é¢ç ”ç©¶ç¥ç»ç»†èƒã€ç¥ç»ç½‘ç»œã€ç¥ç»ç³»ç»Ÿçš„ç”Ÿç‰©åŸå‹ç»“æ„åŠå…¶åŠŸèƒ½æœºç†ã€‚ï¼ˆ2ï¼‰å»ºç«‹ç†è®ºæ¨¡å‹ã€‚æ ¹æ®ç”Ÿç‰©åŸå‹çš„ç ”ç©¶ï¼Œå»ºç«‹ç¥ç»å…ƒã€ç¥ç»ç½‘ç»œçš„ç†è®ºæ¨¡å‹ã€‚å…¶ä¸­åŒ…æ‹¬æ¦‚å¿µæ¨¡å‹ã€çŸ¥è¯†æ¨¡å‹ã€ç‰©ç†åŒ–å­¦æ¨¡å‹ã€æ•°å­¦æ¨¡å‹ç­‰ã€‚ï¼ˆ3ï¼‰ç½‘ç»œæ¨¡å‹ä¸ç®—æ³•ç ”ç©¶ã€‚åœ¨ç†è®ºæ¨¡å‹ç ”ç©¶çš„åŸºç¡€ä¸Šæ„ä½œå…·ä½“çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œä»¥å®ç°è®¡ç®—æœºæ¨¡æ‹Ÿæˆ–å‡†å¤‡åˆ¶ä½œç¡¬ä»¶ï¼ŒåŒ…æ‹¬ç½‘ç»œå­¦ä¹ ç®—æ³•çš„ç ”ç©¶ã€‚è¿™æ–¹é¢çš„å·¥ä½œä¹Ÿç§°ä¸ºæŠ€æœ¯æ¨¡å‹ç ”ç©¶ã€‚ï¼ˆ4ï¼‰äººå·¥ç¥ç»ç½‘ç»œåº”ç”¨ç³»ç»Ÿã€‚åœ¨ç½‘ç»œæ¨¡å‹ä¸ç®—æ³•ç ”ç©¶çš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨äººå·¥ç¥ç»ç½‘ç»œç»„æˆå®é™…çš„åº”ç”¨ç³»ç»Ÿï¼Œä¾‹å¦‚ï¼Œå®ŒæˆæŸç§ä¿¡å·å¤„ç†æˆ–æ¨¡å¼è¯†åˆ«çš„åŠŸèƒ½ã€æ„é€ ä¸“å®¶ç³»ç»Ÿã€åˆ¶æˆæœºå™¨äººç­‰ç­‰ã€‚ çºµè§‚å½“ä»£æ–°å…´ç§‘å­¦æŠ€æœ¯çš„å‘å±•å†å²ï¼Œäººç±»åœ¨å¾æœå®‡å®™ç©ºé—´ã€åŸºæœ¬ç²’å­ï¼Œç”Ÿå‘½èµ·æºç­‰ç§‘å­¦æŠ€æœ¯é¢†åŸŸçš„è¿›ç¨‹ä¸­å†ç»äº†å´å²–ä¸å¹³çš„é“è·¯ã€‚æˆ‘ä»¬ä¹Ÿä¼šçœ‹åˆ°ï¼Œæ¢ç´¢äººè„‘åŠŸèƒ½å’Œç¥ç»ç½‘ç»œçš„ç ”ç©¶å°†ä¼´éšç€é‡é‡å›°éš¾çš„å…‹æœè€Œæ—¥æ–°æœˆå¼‚ã€‚äººå·¥ç¥ç»ç½‘ç»œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ 1.2 å·ç§¯ç¥ç»ç½‘ç»œåŸºæœ¬ç»“æ„å·ç§¯ç¥ç»ç½‘ç»œ(Convolutional Neural Networkï¼ŒCNN)æ˜¯ä¸€ç§å‰é¦ˆç¥ç»ç½‘ç»œï¼Œå®ƒçš„äººå·¥ç¥ç»å…ƒå¯ä»¥å¯¹å‘¨å›´å•å…ƒçš„ä¸€éƒ¨åˆ†è¿›è¡Œå“åº”ï¼Œå¹¶èƒ½å¾ˆå¥½çš„å¤„ç†å¤§å‹çš„å›¾ç‰‡ã€‚å·ç§¯ç¥ç»ç½‘ç»œæ˜¯è¿‘å‡ å¹´æ¥å‘å±•èµ·æ¥çš„ä¸€ç§é«˜æ•ˆçš„è¯†åˆ«æ–¹æ³•ï¼Œå¹¶å¼•èµ·äº†å¹¿æ³›çš„å…³æ³¨[16]ã€‚æ­£æ˜¯ç”±äºé«˜æ•ˆçš„è¯†åˆ«å‡†ç¡®ç‡ï¼Œå¯¹å·ç§¯ç¥ç»ç½‘ç»œçš„ç ”ç©¶æ‰å±‚å‡ºä¸ç©·ã€‚20ä¸–çºª60å¹´ä»£ï¼Œèƒ¡è´å°”å’Œé­å¡å°”å‘ç°ï¼Œç‹¬ç‰¹çš„ç½‘ç»œç»“æ„å¯ä»¥æœ‰æ•ˆåœ°å‡å°‘åé¦ˆç¥ç»ç½‘ç»œåœ¨å¤§è„‘çš®å±‚ç¥ç»å…ƒç ”ç©¶ä¸­çš„å±€éƒ¨æ•æ„Ÿæ€§å’Œæ–¹å‘æ€§é€‰æ‹©çš„å¤æ‚æ€§ï¼Œä»è€Œæå‡ºäº†å·ç§¯ç¥ç»ç½‘ç»œ(Convolutional Neural Networksç®€ç§°CNN)çš„æ¦‚å¿µã€‚ç›®å‰ï¼Œå·ç§¯ç¥ç»ç½‘ç»œå·²æˆä¸ºè®¸å¤šç§‘å­¦é¢†åŸŸçš„çƒ­ç‚¹è¯é¢˜ã€‚ç”±äºå†…éƒ¨ç®—æ³•é¿å…äº†å¯¹å›¾åƒè¿›è¡Œå¤æ‚çš„é¢„å¤„ç†ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ç›´æ¥è¾“å…¥åŸå§‹å›¾ç‰‡ã€‚ 1.2.1 è¾“å…¥å±‚å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥å±‚å¯ä»¥å¤„ç†å¤šç»´æ•°æ®ï¼Œå¸¸è§åœ°ï¼Œä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥å±‚æ¥æ”¶ä¸€ç»´æˆ–äºŒç»´æ•°ç»„ï¼Œå…¶ä¸­ä¸€ç»´æ•°ç»„é€šå¸¸ä¸ºæ—¶é—´æˆ–é¢‘è°±é‡‡æ ·ï¼›äºŒç»´æ•°ç»„å¯èƒ½åŒ…å«å¤šä¸ªé€šé“ï¼›äºŒç»´å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥å±‚æ¥æ”¶äºŒç»´æˆ–ä¸‰ç»´æ•°ç»„ï¼›ä¸‰ç»´å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥å±‚æ¥æ”¶å››ç»´æ•°ç»„ã€‚ 1.2.2 éšå«å±‚1.å·ç§¯å±‚ï¼ˆ1ï¼‰å·ç§¯å±‚ åˆ©ç”¨ä¹˜æ³•å·ç§¯ä»£æ›¿çŸ©é˜µä¹˜æ³•ã€‚åœ¨å›¾åƒå¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œä¸€å¼ â€œå°çŒ«â€çš„å›¾ç‰‡å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªâ€œè–„é¥¼â€ï¼Œå®ƒåŒ…æ‹¬å›¾ç‰‡çš„é«˜åº¦ã€å®½åº¦å’Œæ·±åº¦(å³é¢œè‰²çš„ä¸‰åŸè‰²ï¼Œä»¥RGBè¡¨ç¤º)ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè‹¥æƒé‡ä¸å˜ï¼ŒæŠŠè¿™ä¸ªä¸Šæ–¹å…·æœ‰kä¸ªè¾“å‡ºçš„å°ç¥ç»ç½‘ç»œå¯¹åº”çš„å°å—æ»‘éæ•´ä¸ªå›¾åƒï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªå®½åº¦ã€é«˜åº¦ã€æ·±åº¦éƒ½ä¸åŒçš„æ–°å›¾åƒã€‚å¾—åˆ°çš„æ–°å›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ï¼ˆ2ï¼‰å·ç§¯å±‚å‚æ•°å·ç§¯å±‚å‚æ•°åŒ…æ‹¬å·ç§¯æ ¸å¤§å°ã€æ­¥é•¿å’Œå¡«å……ï¼Œä¸‰è€…å…±åŒå†³å®šäº†å·ç§¯å±‚è¾“å‡ºç‰¹å¾å›¾çš„å°ºå¯¸ï¼Œæ˜¯å·ç§¯ç¥ç»ç½‘ç»œçš„è¶…å‚æ•°ã€‚å…¶ä¸­å·ç§¯æ ¸å¤§å°å¯ä»¥æŒ‡å®šä¸ºå°äºè¾“å…¥å›¾åƒå°ºå¯¸çš„ä»»æ„å€¼ï¼Œå·ç§¯æ ¸è¶Šå¤§ï¼Œå¯æå–çš„è¾“å…¥ç‰¹å¾è¶Šå¤æ‚ã€‚å·ç§¯æ­¥é•¿å®šä¹‰äº†å·ç§¯æ ¸ç›¸é‚»ä¸¤æ¬¡æ‰«è¿‡ç‰¹å¾å›¾æ—¶ä½ç½®çš„è·ç¦»ï¼Œå·ç§¯æ­¥é•¿ä¸º1æ—¶ï¼Œå·ç§¯æ ¸ä¼šé€ä¸ªæ‰«è¿‡ç‰¹å¾å›¾çš„å…ƒç´ ï¼Œæ­¥é•¿ä¸ºnæ—¶ä¼šåœ¨ä¸‹ä¸€æ¬¡æ‰«æè·³è¿‡n-1ä¸ªåƒç´ ã€‚ç”±å·ç§¯æ ¸çš„äº¤å‰ç›¸å…³è®¡ç®—å¯çŸ¥ï¼Œéšç€å·ç§¯å±‚çš„å †å ï¼Œç‰¹å¾å›¾çš„å°ºå¯¸ä¼šé€æ­¥å‡å°ï¼Œä¾‹å¦‚16Ã—16çš„è¾“å…¥å›¾åƒåœ¨ç»è¿‡å•ä½æ­¥é•¿ã€æ— å¡«å……çš„5Ã—5çš„å·ç§¯æ ¸åï¼Œä¼šè¾“å‡º12Ã—12çš„ç‰¹å¾å›¾ã€‚ä¸ºæ­¤ï¼Œå¡«å……æ˜¯åœ¨ç‰¹å¾å›¾é€šè¿‡å·ç§¯æ ¸ä¹‹å‰äººä¸ºå¢å¤§å…¶å°ºå¯¸ä»¥æŠµæ¶ˆè®¡ç®—ä¸­å°ºå¯¸æ”¶ç¼©å½±å“çš„æ–¹æ³•ã€‚å¸¸è§çš„å¡«å……æ–¹æ³•ä¸ºæŒ‰0å¡«å……å’Œé‡å¤è¾¹ç•Œå€¼å¡«å……ã€‚å¡«å……ä¾æ®å…¶å±‚æ•°å’Œç›®çš„å¯åˆ†ä¸ºå››ç±»ï¼šæœ‰æ•ˆå¡«å……ï¼ˆvalid paddingï¼‰ï¼šå³å®Œå…¨ä¸ä½¿ç”¨å¡«å……ï¼Œå·ç§¯æ ¸åªå…è®¸è®¿é—®ç‰¹å¾å›¾ä¸­åŒ…å«å®Œæ•´æ„Ÿå—é‡çš„ä½ç½®ã€‚è¾“å‡ºçš„æ‰€æœ‰åƒç´ éƒ½æ˜¯è¾“å…¥ä¸­ç›¸åŒæ•°é‡åƒç´ çš„å‡½æ•°ã€‚ä½¿ç”¨æœ‰æ•ˆå¡«å……çš„å·ç§¯è¢«ç§°ä¸ºâ€œçª„å·ç§¯â€ï¼Œçª„å·ç§¯è¾“å‡ºçš„ç‰¹å¾å›¾å°ºå¯¸ä¸º(L-f)/s+1ã€‚ç›¸åŒå¡«å……/åŠå¡«å……ï¼šåªè¿›è¡Œè¶³å¤Ÿçš„å¡«å……æ¥ä¿æŒè¾“å‡ºå’Œè¾“å…¥çš„ç‰¹å¾å›¾å°ºå¯¸ç›¸åŒã€‚ç›¸åŒå¡«å……ä¸‹ç‰¹å¾å›¾çš„å°ºå¯¸ä¸ä¼šç¼©å‡ä½†è¾“å…¥åƒç´ ä¸­é è¿‘è¾¹ç•Œçš„éƒ¨åˆ†ç›¸æ¯”äºä¸­é—´éƒ¨åˆ†å¯¹äºç‰¹å¾å›¾çš„å½±å“æ›´å°ï¼Œå³å­˜åœ¨è¾¹ç•Œåƒç´ çš„æ¬ è¡¨è¾¾ã€‚ä½¿ç”¨ç›¸åŒå¡«å……çš„å·ç§¯è¢«ç§°ä¸ºâ€œç­‰é•¿å·ç§¯ã€‚å…¨å¡«å……ï¼šè¿›è¡Œè¶³å¤Ÿå¤šçš„å¡«å……ä½¿å¾—æ¯ä¸ªåƒç´ åœ¨æ¯ä¸ªæ–¹å‘ä¸Šè¢«è®¿é—®çš„æ¬¡æ•°ç›¸åŒã€‚æ­¥é•¿ä¸º1æ—¶ï¼Œå…¨å¡«å……è¾“å‡ºçš„ç‰¹å¾å›¾å°ºå¯¸ä¸ºL+f-1ï¼Œå¤§äºè¾“å…¥å€¼ã€‚ä½¿ç”¨å…¨å¡«å……çš„å·ç§¯è¢«ç§°ä¸ºâ€œå®½å·ç§¯â€ã€‚ä»»æ„å¡«å……ï¼šä»‹äºæœ‰æ•ˆå¡«å……å’Œå…¨å¡«å……ä¹‹é—´ï¼Œäººä¸ºè®¾å®šçš„å¡«å……ï¼Œè¾ƒå°‘ä½¿ç”¨ã€‚ ï¼ˆ3ï¼‰æ¿€åŠ±å‡½æ•°ä¸€ä¸ªåˆé€‚çš„æ¿€åŠ±å‡½æ•°å¯ä»¥æœ‰æ•ˆåœ°æé«˜å·ç§¯ç¥ç»ç½‘ç»œçš„è¿è¡Œæ€§èƒ½ã€‚æ¿€æ´»å‡½æ•°åº”å½“å…·æœ‰çš„æ€§è´¨ï¼š 1ï¼‰å¯å¾®æ€§ï¼šå½“ä¼˜åŒ–æ–¹æ³•æ˜¯åŸºäºæ¢¯åº¦çš„æ—¶å€™ï¼Œè¿™ä¸ªæ€§è´¨æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ 2ï¼‰å•è°ƒæ€§ï¼šå½“æ¿€æ´»å‡½æ•°ä¸ºå•è°ƒå‡½æ•°æ—¶ï¼Œèƒ½å¤Ÿç¡®ä¿å•å±‚ç½‘ç»œä¸ºå‡¸å‡½æ•°ã€‚ 3ï¼‰è¾“å‡ºå€¼çš„èŒƒå›´ï¼šå½“æ¿€æ´»å‡½æ•°çš„è¾“å‡ºå€¼å—åˆ°é™åˆ¶æ—¶ï¼ŒåŸºäºæ¢¯åº¦çš„ä¼˜åŒ–æ–¹æ³•å°†æ›´åŠ ç¨³å®šï¼Œå› ä¸ºç‰¹å¾çš„è¡¨ç¤ºæ›´å—æœ‰é™æƒé‡çš„å½±å“ã€‚å½“æ¿€æ´»å‡½æ•°çš„è¾“å‡ºæ˜¯æ— é™æ—¶ï¼Œæ¨¡å‹çš„è®­ç»ƒå°†æ›´åŠ æ²¹æ•ˆç‡ï¼Œä½†åœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œé€šå¸¸éœ€è¦è¾ƒå°çš„å­¦ä¹ é€Ÿç‡ã€‚ç»å¸¸ä½¿ç”¨çš„éçº¿æ€§æ¿€æ´»å‡½æ•°æœ‰sigmidã€tanhã€Reluç­‰ç­‰ï¼Œå‰ä¸¤è€…sigmidä¸tanhåœ¨å…¨è¿æ¥å±‚ æ¯”è¾ƒå¸¸è§ï¼Œåè€…ReLUå¸¸è§äºå·ç§¯å±‚ã€‚ 2.æ± åŒ–å±‚æ± åŒ–å±‚æ˜¯å·ç§¯ç¥ç»ç½‘ç»œçš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒé€šè¿‡å‡å°‘å·ç§¯å±‚ä¹‹é—´çš„è¿æ¥æ•°é‡æ¥é™ä½è®¡ç®—çš„å›°éš¾åº¦ã€‚åŒ…æ‹¬ä»¥ä¸‹å‡ ç§æ± åŒ–ï¼šï¼ˆ1ï¼‰ä¸€èˆ¬æ± åŒ–(General Pooling)1ï¼‰mean-poolingï¼Œå³åªè¦æ±‚é‚»åŸŸä¸­ç‰¹å¾ç‚¹çš„å¹³å‡å€¼ï¼› 2ï¼‰max-poolingï¼Œå³åœ¨é‚»åŸŸä¸­æå–æœ€å¤§ç‰¹å¾ç‚¹ï¼›3ï¼‰Stochastic-poolingï¼Œä»‹äºä¸¤è€…ä¹‹é—´ï¼Œæ ¹æ®æ•°å€¼ç»™å‡ºåƒç´ çš„æ¦‚ç‡ï¼Œå¹¶æ ¹æ®æ¦‚ç‡è¿›è¡ŒäºŒæ¬¡é‡‡æ ·ã€‚ç‰¹å¾æå–çš„è¯¯å·®ä¸»è¦æ¥è‡ªä¸¤ä¸ªæ–¹é¢ï¼š 1ï¼‰é‚»åŸŸå¤§å°å—é™é€ æˆçš„ä¼°è®¡å€¼æ–¹å·®å¢å¤§ï¼› 2ï¼‰å·ç§¯å±‚å‚æ•°è¯¯å·®å¯¼è‡´ä¼°è®¡å‡å€¼çš„åç§»ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œmean-poolingèƒ½å‡å°ç¬¬ä¸€ç§è¯¯å·®å¹¶ä¿ç•™å›¾åƒçš„èƒŒæ™¯ä¿¡æ¯ï¼Œmax-poolingèƒ½å‡å°ç¬¬äºŒç±»çš„é”™è¯¯ï¼Œå¹¶ä¿ç•™æ›´å¤šçš„çº¹ç†ä¿¡æ¯ã€‚åœ¨å¹³å‡æ„ä¹‰ä¸Šï¼Œä¸mean-poolingè¿‘ä¼¼ï¼Œåœ¨å±€éƒ¨æ„ä¹‰ä¸Šï¼Œåˆ™æœä»max-poolingçš„å‡†åˆ™ã€‚å¦‚å›¾ä¸‹å›¾æ‰€ç¤ºï¼Œ ï¼ˆ2ï¼‰ç©ºé—´é‡‘å­—å¡”æ± åŒ–(Spatial pyramid pooling)ä¸€èˆ¬çš„å·ç§¯ç¥å°†ç½‘ç»œéƒ½éœ€è¦è¾“å…¥å›¾åƒçš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œè¿™æ˜¯å› ä¸ºå…¨è¿æ¥å±‚çš„è¾“å…¥éœ€è¦ä¸€ä¸ªå›ºå®šçš„ç»´åº¦ã€‚å‡ ä¹æ‰€æœ‰ä½œè€…æå‡ºäº†ç©ºé—´é‡‘å­—å¡”æ± åŒ–ï¼Œå…ˆè®©å›¾åƒè¿›è¡Œå·ç§¯ï¼Œç„¶åå˜æ¢ä¸ºè¦è¾“å…¥åˆ°å…¨è¿æ¥å±‚çš„ç»´åº¦ï¼Œè¿™æ ·å¯ä»¥æŠŠå·ç§¯ç¥ç»ç½‘ç»œæ‰©å±•åˆ°ä»»æ„å¤§å°çš„å›¾åƒã€‚ç©ºé—´é‡‘å­—å¡”æ± åŒ–å¯ä»¥æŠŠä»»ä½•å°ºåº¦çš„å·ç§¯ç‰¹å¾è½¬åŒ–æˆåŒä¸€ç»´ï¼Œè¿™ä¸ä»…å¯ä»¥è®©å·ç§¯ç¥ç»ç½‘ç»œå¤„ç†ä»»æ„å¤§å°çš„å›¾åƒï¼Œè¿˜èƒ½é¿å…è£å‰ªå’Œæ‰­æ›²æ“ä½œï¼Œè¿™å…·æœ‰é‡è¦æ„ä¹‰ã€‚ 3.å…¨è¿æ¥å±‚å·ç§¯ç¥ç»ç½‘ç»œä¸­çš„å…¨è¿æ¥å±‚ç­‰ä»·äºä¼ ç»Ÿå‰é¦ˆç¥ç»ç½‘ç»œä¸­çš„éšå«å±‚ã€‚å…¨è¿æ¥å±‚é€šå¸¸æ­å»ºåœ¨å·ç§¯ç¥ç»ç½‘ç»œéšå«å±‚çš„æœ€åéƒ¨åˆ†ï¼Œå¹¶åªå‘å…¶å®ƒå…¨è¿æ¥å±‚ä¼ é€’ä¿¡å·ã€‚ç‰¹å¾å›¾åœ¨å…¨è¿æ¥å±‚ä¸­ä¼šå¤±å»ä¸‰ç»´ç»“æ„ï¼Œè¢«å±•å¼€ä¸ºå‘é‡å¹¶é€šè¿‡æ¿€åŠ±å‡½æ•°ä¼ é€’è‡³ä¸‹ä¸€å±‚ã€‚ 1.2.3 è¾“å‡ºå±‚å·ç§¯ç¥ç»ç½‘ç»œä¸­è¾“å‡ºå±‚çš„ä¸Šæ¸¸é€šå¸¸æ˜¯å…¨è¿æ¥å±‚ï¼Œå› æ­¤å…¶ç»“æ„å’Œå·¥ä½œåŸç†ä¸ä¼ ç»Ÿå‰é¦ˆç¥ç»ç½‘ç»œä¸­çš„è¾“å‡ºå±‚ç›¸åŒã€‚å¯¹äºå›¾åƒåˆ†ç±»é—®é¢˜ï¼Œè¾“å‡ºå±‚ä½¿ç”¨é€»è¾‘å‡½æ•°æˆ–å½’ä¸€åŒ–æŒ‡æ•°å‡½æ•°è¾“å‡ºåˆ†ç±»æ ‡ç­¾ã€‚åœ¨ç‰©ä½“è¯†åˆ«é—®é¢˜ä¸­ï¼Œè¾“å‡ºå±‚å¯è®¾è®¡ä¸ºè¾“å‡ºç‰©ä½“çš„ä¸­å¿ƒæ ‡ã€å¤§å°å’Œåˆ†ç±»ã€‚åœ¨å›¾åƒè¯­ä¹‰åˆ†å‰²ä¸­ï¼Œè¾“å‡ºå±‚ç›´æ¥è¾“å‡ºæ¯ä¸ªåƒç´ çš„åˆ†ç±»ç»“æœã€‚ 1.3 å·ç§¯ç¥ç»ç½‘ç»œçš„å·ç§¯è¿‡ç¨‹å·ç§¯ç¥ç»ç½‘ç»œçš„ç»“æ„æœ‰å¾ˆå¤šç§ï¼Œä½†æ˜¯å…¶åŸºæœ¬ç»“æ„æ˜¯ç±»ä¼¼çš„ã€‚å¦‚ä¸‹å›¾ï¼Œå®ƒåŒ…å«ä¸‰ä¸ªä¸»è¦çš„å±‚â€”â€”å·ç§¯å±‚(convolutional layer)ã€æ± åŒ–å±‚(pooling layer)ã€å…¨è¿æ¥å±‚(fully-connected layer)ã€‚å›¾ä¸­çš„å·ç§¯ç½‘ç»œå·¥ä½œæµç¨‹å¦‚ä¸‹ï¼Œ è¾“å…¥å›¾ç‰‡æ˜¯åƒç´ æ˜¯32Ã—32çš„æ¥ç»„æˆè¾“å…¥å±‚ã€‚ç„¶åï¼Œè®¡ç®—æµç¨‹åœ¨å·ç§¯å’ŒæŠ½æ ·ä¹‹é—´äº¤æ›¿è¿›è¡Œï¼Œå¦‚ä¸‹æ‰€è¿°ï¼šç¬¬ä¸€éšè—å±‚è¿›è¡Œå·ç§¯çš„å·¥ä½œï¼Œå®ƒç”±6ä¸ªç‰¹å¾å›¾ç»„æˆï¼Œæ¯ä¸ªç‰¹å¾å›¾ç”±28Ã—28ä¸ªç¥ç»å…ƒç»„æˆï¼Œæ¯ä¸ªç¥ç»å…ƒæŒ‡å®š5Ã—5 çš„æ¥å—åŸŸã€‚ç¬¬äºŒéšè—å±‚å®ç°å­é‡‡æ ·å’Œå±€éƒ¨å¹³å‡ï¼Œå®ƒåŒæ ·ç”± 6ä¸ªç‰¹å¾å›¾ç»„æˆï¼Œä½†å…¶æ¯ä¸ªç‰¹å¾å›¾ç”±14Ã—14 ä¸ªç¥ç»å…ƒç»„æˆã€‚æ¯ä¸ªç¥ç»å…ƒå…·æœ‰2Ã—2 çš„æ¥å—åŸŸã€‚ç¬¬ä¸‰éšè—å±‚è¿›è¡Œç¬¬äºŒæ¬¡å·ç§¯ï¼Œå®ƒç”± 16ä¸ªç‰¹å¾å›¾ç»„æˆï¼Œæ¯ä¸ªç‰¹å¾å›¾ç”± 10Ã—10ä¸ªç¥ç»å…ƒç»„æˆã€‚éšè—å±‚ä¸­çš„æ¯ä¸ªç¥ç»å…ƒå¯ä»¥å…·æœ‰ä¸ä¸‹ä¸€éšè—å±‚çš„å¤šä¸ªç‰¹å¾å›¾ç›¸å…³è”çš„çªè§¦è¿æ¥ï¼Œå…¶æ“ä½œæ–¹å¼ç±»ä¼¼äºç¬¬ä¸€å±‚éšè—å±‚çš„å·ç§¯è¿‡ç¨‹ã€‚ç¬¬å››ä¸ªéšè—å±‚è¿›è¡Œç¬¬äºŒæ¬¡å­é‡‡æ ·å’Œå±€éƒ¨å¹³å‡è®¡ç®—ã€‚å®ƒç”± 16ä¸ªç‰¹å¾å›¾ç»„æˆï¼Œä½†æ¯ä¸ªç‰¹å¾å›¾ç”± 5Ã—5ä¸ªç¥ç»å…ƒæ„æˆï¼Œå®ƒä»¥ä¸ç¬¬ä¸€æ¬¡é‡‡æ ·ç›¸åŒçš„æ–¹å¼è¿›è¡Œå·¥ä½œã€‚ç¬¬äº”ä¸ªéšè—å±‚å®ç°äº†å·ç§¯çš„æœ€åé˜¶æ®µï¼Œå®ƒç”± 120ä¸ªç¥ç»å…ƒç»„æˆï¼Œæ¯ä¸ªç¥ç»å…ƒæŒ‡å®š5Ã—5 çš„æ¥å—åŸŸã€‚ç«¯éƒ¨æ˜¯ä¸ªå…¨è¿æ¥å±‚ï¼Œå¾—åˆ°è¾“å‡ºå‘é‡ã€‚å·ç§¯å’Œé‡‡æ ·ä¹‹é—´çš„è®¡ç®—å±‚çš„è¿ç»­äº¤æ›¿æ˜¯â€œåŒå°–å¡”â€çš„ç»“æœï¼Œå³åœ¨æ¯ä¸ªå·ç§¯æˆ–é‡‡æ ·å±‚ä¸­ï¼Œä¸å…ˆå‰çš„å±‚ç›¸æ¯”ï¼Œç‰¹å¾å›¾çš„æ•°ç›®éšç€ç©ºé—´åˆ†è¾¨ç‡çš„å‡å°è€Œå¢åŠ [17]ã€‚å·ç§¯å±‚ç ”ç©¶è¾“å…¥æ•°æ®çš„ç‰¹å¾ã€‚å·ç§¯å±‚ç”±å·ç§¯æ ¸(convolutional kernel)ç»„æˆï¼Œå·ç§¯æ ¸ç”¨æ¥è®¡ç®—ä¸åŒçš„ç‰¹å¾å›¾ï¼›æ¿€åŠ±å‡½æ•°(activation function)ç»™å·ç§¯ç¥ç»ç½‘ç»œå¼•å…¥äº†éçº¿æ€§ï¼Œå¸¸ç”¨çš„æœ‰sigmidã€tanhã€ ReLUå‡½æ•°ï¼›æ± åŒ–å±‚å‡å°‘äº†å·ç§¯å±‚è¾“å‡ºçš„ç‰¹å¾å‘é‡ï¼Œæ”¹è‰¯ç»“æœ(ä½¿ç»“æ„ä¸æ˜“è¿‡æ‹Ÿåˆ)ï¼Œå…¸å‹åº”ç”¨æœ‰average pooling å’Œ max poolingï¼›å…¨è¿æ¥å±‚å°†å·ç§¯å±‚å’Œæ± åŒ–å±‚ç»„åˆèµ·æ¥ä»¥åï¼Œç„¶åå¯ä»¥å½¢æˆå±‚æˆ–å¤šå±‚å…¨è¿æ¥å±‚ï¼Œä»è€Œå¯ä»¥å®Œæˆæ›´é«˜æ°´å¹³çš„ç‰¹å¾å–å¾—ã€‚ 2ã€è¿ç§»å­¦ä¹ ç›¸å…³åŸç†2.1 è¿ç§»å­¦ä¹ åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ‰€è°“çš„è¿ç§»å­¦ä¹ æ˜¯å°†ä¸€ä¸ªé—®é¢˜Aä¸Šè®­ç»ƒå¥½çš„æ¨¡å‹é€šè¿‡ç®€å•çš„è°ƒæ•´ä½¿å…¶é€‚åº”ä¸€ä¸ªæ–°çš„é—®é¢˜Bã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¾€å¾€æ˜¯å®Œæˆé—®é¢˜Açš„è®­ç»ƒå‡ºçš„æ¨¡å‹æœ‰æ›´å®Œå–„çš„æ•°æ®ï¼Œè€Œé—®é¢˜Bçš„æ•°æ®é‡åå°ã€‚è€Œè°ƒæ•´çš„è¿‡ç¨‹æ ¹æ®ç°å®æƒ…å†µå†³å®šï¼Œå¯ä»¥é€‰æ‹©ä¿ç•™å‰å‡ å±‚å·ç§¯å±‚çš„æƒé‡ï¼Œä»¥ä¿ç•™ä½çº§ç‰¹å¾çš„æå–ï¼›ä¹Ÿå¯ä»¥ä¿ç•™å…¨éƒ¨çš„æ¨¡å‹ï¼Œåªæ ¹æ®æ–°çš„ä»»åŠ¡æ”¹å˜å…¶fcå±‚ã€‚è¢«è¿ç§»çš„æ¨¡å‹å¾€å¾€æ˜¯ä½¿ç”¨å¤§é‡æ ·æœ¬è®­ç»ƒå‡ºæ¥çš„ï¼Œæ¯”å¦‚Googleæä¾›çš„Inception V3ç½‘ç»œæ¨¡å‹ä½¿ç”¨ImageNetæ•°æ®é›†è®­ç»ƒï¼Œè€ŒImageNetä¸­æœ‰120ä¸‡æ ‡æ³¨å›¾ç‰‡ï¼Œç„¶ååœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¾ˆéš¾æ”¶é›†åˆ°å¦‚æ­¤å¤šçš„æ ·æœ¬æ•°æ®ã€‚è€Œä¸”æ”¶é›†çš„è¿‡ç¨‹éœ€è¦æ¶ˆè€—å¤§é‡çš„äººåŠ›æ— åŠ›ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹æ¥è¯´ï¼Œé—®é¢˜Bçš„æ•°æ®é‡æ˜¯è¾ƒå°‘çš„ã€‚æ‰€ä»¥ï¼ŒåŒæ ·ä¸€ä¸ªæ¨¡å‹åœ¨ä½¿ç”¨å¤§æ ·æœ¬å¾ˆå¥½çš„è§£å†³äº†é—®é¢˜Aï¼Œé‚£ä¹ˆæœ‰ç†ç”±ç›¸ä¿¡è¯¥æ¨¡å‹ä¸­è®­ç»ƒå¤„çš„æƒé‡å‚æ•°èƒ½å¤Ÿå¾ˆå¥½çš„å®Œæˆç‰¹å¾æå–ä»»åŠ¡ã€‚è¿ç§»å­¦ä¹ å…·æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼šæ›´çŸ­çš„è®­ç»ƒæ—¶é—´ï¼Œæ›´å¿«çš„æ”¶æ•›é€Ÿåº¦ï¼Œæ›´ç²¾å‡†çš„æƒé‡å‚æ•°ã€‚ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹å¦‚æœä»»åŠ¡Bçš„æ•°æ®é‡æ˜¯è¶³å¤Ÿçš„ï¼Œé‚£ä¹ˆè¿ç§»æ¥çš„æ¨¡å‹æ•ˆæœä¼šä¸å¦‚è®­ç»ƒçš„åˆ°ï¼Œä½†æ˜¯æ­¤æ—¶èµ·ç å¯ä»¥å°†åº•å±‚çš„æƒé‡å‚æ•°ä½œä¸ºåˆå§‹å€¼æ¥é‡æ–°è®­ç»ƒã€‚ 2.2TensorFlowTensorFlowæ˜¯è°·æ­ŒåŸºäºDistBeliefè¿›è¡Œç ”å‘çš„ç¬¬äºŒä»£äººå·¥æ™ºèƒ½å­¦ä¹ ç³»ç»Ÿã€‚Tensor(å¼ é‡)æ„å‘³ç€Nç»´æ•°ç»„ï¼ŒFlow(æµ)æ„å‘³ç€åŸºäºæ•°æ®æµå›¾çš„è®¡ç®—ï¼ŒTensorFlowä¸ºå¼ é‡ä»æµå›¾çš„ä¸€ç«¯æµåŠ¨åˆ°å¦ä¸€ç«¯è®¡ç®—è¿‡ç¨‹ã€‚TensorFlowæ˜¯å°†å¤æ‚çš„æ•°æ®ä¼ é€’åˆ°äººå·¥æ™ºèƒ½ç¥ç»ç½‘ç»œè¿›è¡Œå¤„ç†å’Œåˆ†æçš„ç³»ç»Ÿã€‚TensorFlow è¡¨è¾¾äº†é«˜å±‚æ¬¡çš„æœºå™¨å­¦ä¹ è®¡ç®—ï¼Œå¤§å¹…ç®€åŒ–äº†ç¬¬ä¸€ä»£ç³»ç»Ÿï¼Œå¹¶ä¸”å…·å¤‡æ›´å¥½çš„çµæ´»æ€§å’Œå¯å»¶å±•æ€§ã€‚TensorFlowä¸€å¤§äº®ç‚¹æ˜¯æ”¯æŒå¼‚æ„è®¾å¤‡åˆ†å¸ƒå¼è®¡ç®—ï¼Œå®ƒèƒ½å¤Ÿåœ¨å„ä¸ªå¹³å°ä¸Šè‡ªåŠ¨è¿è¡Œæ¨¡å‹ï¼Œä»æ‰‹æœºã€å•ä¸ªCPU / GPUåˆ°æˆç™¾ä¸ŠåƒGPUå¡ç»„æˆçš„åˆ†å¸ƒå¼ç³»ã€‚TensorFlowæ”¯æŒCNNã€RNNå’ŒLSTMç®—æ³•ï¼Œè¿™éƒ½æ˜¯ç›®å‰åœ¨Imageï¼ŒSpeechå’ŒNLPæœ€æµè¡Œçš„æ·±åº¦ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚TensorFlowå¯è¢«ç”¨äºåƒæœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„è®¸å¤šé¢†åŸŸï¼Œå¦‚è¯­éŸ³è¯†åˆ«æˆ–è€…æ˜¯å›¾åƒå¤„ç†ï¼Œä»¥åŠå¯¹æ·±åº¦å­¦ä¹ çš„åŸºç¡€è®¾æ–½çš„å„ä¸ªæ–¹é¢è¿›è¡Œæ”¹è¿›ã€‚å®ƒèƒ½å¤Ÿè¿è¡Œåœ¨å°åˆ°ä¸€ä¸ªåªèƒ½ç”µè¯æˆ–æ•°ä»¥ç™¾ä¸‡è®¡çš„CENä¸Šã€‚TensorFlowå°†æ˜¯å®Œå…¨å¼€æºçš„ï¼Œå¯ä»¥è¢«ä»»ä½•äººä½¿ç”¨ã€‚è¿™ä¹Ÿæ˜¯é€‰æ‹©TensorFlowè¿™ä¸ªå¹³å°çš„ä¸»è¦åŸå› ã€‚ ï¼ˆ1ï¼‰æ”¯æŒå¤šç§ç¡¬ä»¶çš„å¹³å°ä¾‹å¦‚ï¼Œå®ƒæ”¯æŒCPUã€GPUæ··åˆæ•°æ®ä¸­å¿ƒçš„è®­ç»ƒå¹³å°ï¼Œå¹¶ä¸”è¿˜æ”¯æŒæ•°æ®ä¸­å¿ƒçš„è®­ç»ƒæ¨¡å‹ï¼Œå®ƒç›¸å¯¹æ–¹ä¾¿åœ°éƒ¨ç½²åˆ°ä¸åŒçš„ç§»åŠ¨ç«¯åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒç”±è°·æ­Œè‡ªä¸»å¼€å‘çš„TPUå¤„ç†å™¨ã€‚è¿™ç§å¤šç¡¬ä»¶æ”¯æŒå¹³å°ä¼šå¤§å¤§ç»™ç”¨æˆ·å¸¦æ¥æ–¹ä¾¿ã€‚ ï¼ˆ2ï¼‰æ”¯æŒå¤šç§å¼€å‘ç¯å¢ƒ æ”¯æŒå„ç§ç¡¬ä»¶çš„å¹³å°æ˜¯åŸºç¡€ï¼Œä¹Ÿæ˜¯TensorFlowå§‹ç»ˆèƒ½å¤Ÿå¸®åŠ©å°½å¯èƒ½å¤šçš„å¼€å‘äººå‘˜åˆ©ç”¨æ·±åº¦å­¦ä¹ æŠ€æœ¯å¹¶æœ€ç»ˆå—ç›Šäºå¹¿å¤§ç”¨æˆ·çš„åŸå› ã€‚åŸºäºè¿™ä¸€æ€æƒ³ï¼ŒTensorFlowä¸€ç›´éƒ½éå¸¸é‡è§†å„ç§ç¨‹åºå‘˜å¼€å‘ç¯å¢ƒã€‚ä¾‹å¦‚ï¼Œå¼€å‘äººå‘˜å¯ä»¥åœ¨å„å¼å„æ ·çš„ã€ä½äºä¸»è¦çš„ä½ç½®çš„å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨TensorFlowç¯å¢ƒã€‚ç›®å‰TensorFlowä»å¤„äºå¿«é€Ÿå¼€å‘è¿­ä»£ä¸­ï¼Œæœ‰å¤§é‡æ–°åŠŸèƒ½åŠæ€§èƒ½ä¼˜åŒ–åœ¨æ¬¡æŒç»­ç ”å‘ã€‚ 2.3VGGå·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹VGGå…¨ç§°æ˜¯Visual Geometry Groupå±äºç‰›æ´¥å¤§å­¦ç§‘å­¦å·¥ç¨‹ç³»ï¼Œå…¶å‘å¸ƒäº†ä¸€äº›åˆ—ä»¥VGGå¼€å¤´çš„å·ç§¯ç½‘ç»œæ¨¡å‹ï¼Œå¯ä»¥åº”ç”¨åœ¨äººè„¸è¯†åˆ«ã€å›¾åƒåˆ†ç±»ç­‰æ–¹é¢ï¼Œåˆ†åˆ«ä»VGG16ï½VGG19[20]ã€‚VGGç ”ç©¶å·ç§¯ç½‘ç»œæ·±åº¦çš„åˆè¡·æ˜¯æƒ³ææ¸…æ¥šå·ç§¯ç½‘ç»œæ·±åº¦æ˜¯å¦‚ä½•å½±å“å¤§è§„æ¨¡å›¾åƒåˆ†ç±»ä¸è¯†åˆ«çš„ç²¾åº¦å’Œå‡†ç¡®ç‡çš„ï¼Œæœ€åˆæ˜¯VGG-16å·ç§°éå¸¸æ·±çš„å·ç§¯ç½‘ç»œå…¨ç§°ä¸º(GG-Very-Deep-16 CNN)ï¼ŒVGGåœ¨åŠ æ·±ç½‘ç»œå±‚æ•°åŒæ—¶ä¸ºäº†é¿å…å‚æ•°è¿‡å¤šï¼Œåœ¨æ‰€æœ‰å±‚éƒ½é‡‡ç”¨3x3çš„å°å·ç§¯æ ¸ï¼Œå·ç§¯å±‚æ­¥é•¿è¢«è®¾ç½®ä¸º1ã€‚VGGçš„è¾“å…¥è¢«è®¾ç½®ä¸º224x244å¤§å°çš„RGBå›¾åƒï¼Œåœ¨è®­ç»ƒé›†å›¾åƒä¸Šå¯¹æ‰€æœ‰å›¾åƒè®¡ç®—RGBå‡å€¼ï¼Œç„¶åæŠŠå›¾åƒä½œä¸ºè¾“å…¥ä¼ å…¥VGGå·ç§¯ç½‘ç»œï¼Œä½¿ç”¨3x3æˆ–è€…1x1çš„filterï¼Œå·ç§¯æ­¥é•¿è¢«å›ºå®š1ã€‚VGGå…¨è¿æ¥å±‚æœ‰3å±‚ï¼Œæ ¹æ®å·ç§¯å±‚+å…¨è¿æ¥å±‚æ€»æ•°ç›®çš„ä¸åŒå¯ä»¥ä»VGG11 ï½ VGG19ï¼Œæœ€å°‘çš„VGG11æœ‰8ä¸ªå·ç§¯å±‚ä¸3ä¸ªå…¨è¿æ¥å±‚ï¼Œæœ€å¤šçš„VGG19æœ‰16ä¸ªå·ç§¯å±‚+3ä¸ªå…¨è¿æ¥å±‚ï¼Œæ­¤å¤–VGGç½‘ç»œå¹¶ä¸æ˜¯åœ¨æ¯ä¸ªå·ç§¯å±‚åé¢è·Ÿä¸Šä¸€ä¸ªæ± åŒ–å±‚ï¼Œè¿˜æ˜¯æ€»æ•°5ä¸ªæ± åŒ–å±‚ï¼Œåˆ†å¸ƒåœ¨ä¸åŒçš„å·ç§¯å±‚ä¹‹ä¸‹ï¼Œä¸‹å›¾æ˜¯VGG11 ï½GVV19çš„ç»“æ„å›¾ï¼šåœ¨å›¾ä¸­ï¼ŒAåˆ—æ˜¯æœ€åŸºæœ¬çš„æ¨¡å‹ï¼Œæœ‰8ä¸ªå·ç§¯å±‚ï¼Œ3ä¸ªå…¨è¿æ¥å±‚ï¼Œä¸€å…±11å±‚ã€‚Båˆ—æ˜¯åœ¨Aåˆ—çš„åŸºç¡€ä¸Šï¼Œåœ¨stage1å’Œstage2åŸºç¡€ä¸Šåˆ†åˆ«å¢åŠ äº†ä¸€å±‚33å·ç§¯å±‚ï¼Œä¸€å…±13å±‚ã€‚Cåˆ—æ˜¯åœ¨Bçš„åŸºç¡€ä¸Šï¼Œåœ¨stage3,stage4å’Œstage5åŸºç¡€ä¸Šåˆ†åˆ«å¢åŠ äº†ä¸€å±‚11çš„å·ç§¯å±‚ã€‚ä¸€å…±16å±‚ã€‚Dåˆ—æ˜¯åœ¨Bçš„åŸºç¡€ä¸Šï¼Œåœ¨stage3,stage4å’Œstage5åŸºç¡€ä¸Šåˆ†åˆ«å¢åŠ äº†ä¸€å±‚33çš„å·ç§¯å±‚ï¼Œä¸€å…±16å±‚ã€‚Eå±‚æ˜¯åœ¨Dçš„åŸºç¡€ä¸Šï¼Œåœ¨stage3,stage4å’Œstage5åŸºç¡€ä¸Šåˆ†åˆ«å¢åŠ 33çš„å·ç§¯å±‚ï¼Œä¸€å…±19å±‚ã€‚æ¨¡å‹Eå°±æ˜¯VGG19ç½‘ç»œã€‚ 3ã€é€šè¿‡VGGå®ç°é£æ ¼è¿ç§»3.1 å›¾åƒé£æ ¼è¿ç§»çš„åŸç†VGGNETæ˜¯ä¸€ç§å›¾åƒè¯†åˆ«æ¨¡å‹ï¼Œå®ƒä¹Ÿæ‹¥æœ‰è€…å·ç§¯å±‚å’Œå…¨è¿æ¥å±‚ã€‚å¯ä»¥è¿™æ ·ç†è§£VGGçš„ç»“æ„ï¼šå‰é¢çš„å·ç§¯å±‚æ˜¯ä»å›¾åƒä¸­æå–â€œç‰¹å¾â€ï¼Œè€Œåé¢çš„å…¨è¿æ¥å±‚æŠŠå›¾ç‰‡çš„â€œç‰¹å¾â€è½¬æ¢ä¸ºç±»åˆ«æ¦‚ç‡ã€‚å…¶ä¸­VGGNETä¸­çš„æµ…å±‚ï¼ˆconv1_1,conv1_2 ï¼‰ï¼Œæå–çš„ç‰¹å¾å¾€å¾€æ˜¯æ¯”è¾ƒç®€å•çš„ï¼ˆæ¯”å¦‚æå–æ£€æµ‹ç‚¹ã€çº¿ã€äº®åº¦ï¼‰ï¼ŒVGGNETä¸­çš„æ·±å±‚ï¼ˆcæ¯”å¦‚onv5_1,conv5_2ï¼‰ï¼Œæå–çš„ç‰¹å¾å¾€å¾€æ¯”è¾ƒå¤æ‚ï¼ˆå¦‚æ˜¯å¦å­˜åœ¨äººè„¸ã€æŸç§ç‰¹å®šç‰©ä½“ï¼‰ã€‚VGGNETçš„æœ¬æ„æ˜¯è¾“å…¥å›¾åƒï¼Œæå–ç‰¹å¾ï¼Œç„¶åè¾“å‡ºå›¾åƒç±»åˆ«ã€‚å›¾åƒé£æ ¼è¿ç§»æ°å¥½ä¸å…¶ç›¸åï¼Œè¾“å…¥ç‰¹å¾ï¼Œä¹‹åè¾“å‡ºå¯¹åº”è¿™ç§ç‰¹å¾çš„å›¾ç‰‡ã€‚ä¸¤ç§è¿‡ç¨‹çš„å¯¹æ¯”å›¾ç‰‡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå…·ä½“æ¥è¯´ï¼Œé£æ ¼è¿ç§»ä½¿ç”¨å·ç§¯å±‚çš„ä¸­é—´ç‰¹å¾è¿˜åŸå‡ºå¯¹åº”è¿™ç§ç‰¹å¾çš„åŸå§‹å›¾åƒã€‚å…·ä½“è¿‡ç¨‹å°±æ˜¯ï¼šå…ˆé€‰å–ä¸€å‰¯åŸå§‹å›¾åƒï¼Œç»è¿‡VGGNETè®¡ç®—åå¾—åˆ°å„ä¸ªå·ç§¯å±‚çš„ç‰¹å¾ã€‚ä¹‹åï¼Œæ ¹æ®è¿™äº›å·ç§¯å±‚çš„ç‰¹å¾ï¼Œè¿˜åŸå‡ºå¯¹åº”è¿™ç§ç‰¹å¾çš„åŸå§‹å›¾åƒ.ç ”ç©¶å‘ç°ï¼šæµ…å±‚çš„è¿˜åŸæ•ˆæœå¾€å¾€æ¯”è¾ƒå¥½ï¼Œå·ç§¯ç‰¹å¾åŸºæœ¬ä¿ç•™äº†æ‰€æœ‰åŸå§‹å›¾åƒä¸­å½¢çŠ¶ã€ä½ç½®ã€é¢œè‰²ã€çº¹ç†ç­‰ä¿¡æ¯ï¼›æ·±å±‚å¯¹åº”çš„è¿˜åŸå›¾åƒä¸¢å¤±äº†éƒ¨åˆ†é¢œè‰²å’Œçº¹ç†ä¿¡æ¯ï¼Œä½†å¤§ä½“ä¿ç•™åŸå§‹å›¾åƒä¸­ç‰©ä½“çš„å½¢çŠ¶å’Œä½ç½®ã€‚ 3.2 ä»£ä»·å‡½æ•°è¦æ„å»ºä¸€ä¸ªç¥ç»é£æ ¼è¿ç§»ç³»ç»Ÿï¼Œé¦–å…ˆéœ€è¦ä¸ºç”Ÿæˆçš„å›¾åƒå®šä¹‰ä¸€ä¸ªä»£ä»·å‡½æ•°ï¼Œé€šè¿‡æœ€å°åŒ–ä»£ä»·å‡½æ•°ï¼Œå¯ä»¥å¤§å¤§ç¼©çŸ­å›¾ç‰‡ç”Ÿæˆæ‰€éœ€è¦çš„æ—¶é—´ã€‚ä¸ºäº†å®ç°ç¥ç»é£æ ¼è¿ç§»ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªå…³äºGçš„ä»£ä»·å‡½æ•°ï¼ŒJç”¨æ¥è¯„åˆ¤æŸä¸ªç”Ÿæˆå›¾åƒçš„å¥½åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•å»æœ€å°åŒ–J(G)ï¼Œä»¥ä¾¿äºç”Ÿæˆè¿™ä¸ªå›¾åƒã€‚é‚£ä¹ˆå¦‚ä½•å»åˆ¤æ–­ç”Ÿæˆå›¾åƒçš„å¥½åï¼Œåœ¨è¿™é‡ŒæŠŠè¿™ä¸ªä»£ä»·å‡½æ•°å®šä¹‰ä¸ºä¸¤ä¸ªéƒ¨åˆ†ã€‚Jcontent(C,G) ç¬¬ä¸€éƒ¨åˆ†è¢«ç§°ä½œå†…å®¹ä»£ä»·ï¼Œè¿™æ˜¯ä¸€ä¸ªå…³äºå†…å®¹å›¾ç‰‡å’Œç”Ÿæˆå›¾ç‰‡çš„å‡½æ•°ï¼Œå®ƒæ˜¯ç”¨æ¥åº¦é‡ç”Ÿæˆå›¾ç‰‡Gçš„å†…å®¹ä¸å†…å®¹å›¾ç‰‡Cçš„å†…å®¹æœ‰å¤šç›¸ä¼¼ã€‚Jstyle(S,G)ç„¶åä¼šæŠŠç»“æœåŠ ä¸Šä¸€ä¸ªé£æ ¼ä»£ä»·å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å…³äºSå’ŒGçš„å‡½æ•°ï¼Œç”¨æ¥åº¦é‡å›¾ç‰‡Gçš„é£æ ¼å’Œå›¾ç‰‡Sçš„é£æ ¼çš„ç›¸ä¼¼åº¦ã€‚J(G)=Î±Jcontent(C,G)+Î²Jstyle(S,G) æœ€åç”¨ä¸¤ä¸ªè¶…å‚æ•°Î±å’ŒÎ²æ¥æ¥ç¡®å®šå†…å®¹ä»£ä»·å’Œé£æ ¼ä»£ä»·ï¼Œä¸¤è€…ä¹‹é—´çš„æƒé‡ç”¨ä¸¤ä¸ªè¶…å‚æ•°æ¥ç¡®å®šã€‚ 3.3 å†…å®¹ä»£ä»·å‡½æ•°é£æ ¼è¿ç§»ç½‘ç»œçš„ä»£ä»·å‡½æ•°æœ‰ä¸€ä¸ªå†…å®¹ä»£ä»·éƒ¨åˆ†ï¼Œè¿˜æœ‰ä¸€ä¸ªé£æ ¼ä»£ä»·éƒ¨åˆ†ã€‚ é¦–å…ˆå®šä¹‰å†…å®¹ä»£ä»·éƒ¨åˆ†ã€‚ç”¨éšå«å±‚mæ¥è®¡ç®—å†…å®¹ä»£ä»·ï¼Œå¦‚æœmæ˜¯ä¸ªå¾ˆå°çš„æ•°ï¼Œæ¯”å¦‚ç”¨éšå«å±‚ 1ï¼Œè¿™ä¸ªä»£ä»·å‡½æ•°å°±ä¼šä½¿ç”Ÿæˆå›¾ç‰‡åƒç´ ä¸Šéå¸¸æ¥è¿‘å†…å®¹å›¾ç‰‡ã€‚ç„¶è€Œå¦‚æœä½¿ç”¨å¾ˆæ·±çš„å±‚ï¼Œé‚£ä¹ˆå¯èƒ½åœ¨å†…å®¹å›¾ç‰‡é‡Œé¢æœ‰ä¸€ä¸ªå…·ä½“çš„ç‰©ä½“ï¼Œåœ¨ç”Ÿæˆçš„å›¾ç‰‡é‡Œå°±ä¼šå­˜åœ¨è¿™ä¸ªç‰©ä½“ã€‚æ¯”å¦‚æ˜¯ä¸€åªå°çŒ«ï¼Œé‚£ä¹ˆåœ¨ç”Ÿæˆçš„å›¾ç‰‡é‡Œå°±ä¸€å®šä¼šæœ‰ä¸€ä¸ªå°çŒ«ã€‚æ‰€ä»¥åœ¨å®é™…ä¸­ï¼Œè¿™ä¸ªå±‚måœ¨ç½‘ç»œä¸­æ—¢ä¸ä¼šé€‰çš„å¤ªæµ…ä¹Ÿä¸ä¼šé€‰çš„å¤ªæ·±ã€‚é€šå¸¸ğ‘šä¼šé€‰æ‹©åœ¨ç½‘ç»œçš„ä¸­é—´å±‚ï¼Œæ—¢ä¸å¤ªæµ…ä¹Ÿä¸å¾ˆæ·±ï¼Œç„¶åç”¨ä¸€ä¸ªé¢„è®­ç»ƒçš„å·ç§¯æ¨¡å‹ï¼Œæœ¬ç¯‡è®ºæ–‡ä½¿ç”¨çš„æ˜¯ VGG ç½‘ç»œã€‚ ä¹‹åéœ€è¦è¡¡é‡å‡å¦‚æœ‰ä¸€ä¸ªå†…å®¹å›¾ç‰‡å’Œä¸€ä¸ªç”Ÿæˆå›¾ç‰‡ä»–ä»¬åœ¨å†…å®¹ä¸Šçš„ç›¸ä¼¼åº¦ï¼Œä»¤è¿™ä¸ªä»£è¡¨è¿™ä¸¤ä¸ªå›¾ç‰‡Î±^([L][C])å’ŒÎ±^([L][G])çš„lå±‚çš„æ¿€æ´»å‡½æ•°å€¼ã€‚å¦‚æœè¿™ä¸¤ä¸ªæ¿€æ´»å€¼ç›¸ä¼¼ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ä¸¤ä¸ªå›¾ç‰‡çš„å†…å®¹ç›¸ä¼¼ã€‚ ä¸ºä¸¤ä¸ªæ¿€æ´»å€¼ä¸åŒæˆ–è€…ç›¸ä¼¼çš„ç¨‹åº¦ï¼Œå–lå±‚çš„éšå«å•å…ƒçš„æ¿€æ´»å€¼ï¼ŒæŒ‰å…ƒç´ ç›¸å‡ï¼Œå†…å®¹å›¾ç‰‡çš„æ¿€æ´»å€¼ä¸ç”Ÿæˆå›¾ç‰‡ç›¸æ¯”è¾ƒï¼Œç„¶åå–å¹³æ–¹ï¼Œä¹Ÿå¯ä»¥åœ¨å‰é¢åŠ ä¸Šå½’ä¸€åŒ–æˆ–è€…ä¸åŠ ï¼Œæ¯”å¦‚1/2æˆ–è€…å…¶ä»–çš„ï¼Œéƒ½å½±å“ä¸å¤§ï¼Œå› ä¸ºè¿™éƒ½å¯ä»¥ç”±è¿™ä¸ªè¶…å‚æ•°Î±æ¥è°ƒæ•´ã€‚ 3.4 é£æ ¼ä»£ä»·å‡½æ•°å›¾åƒçš„é£æ ¼å¯ä»¥ç”¨ä½¿ç”¨å›¾åƒçš„å·ç§¯å±‚ç‰¹å¾çš„GramçŸ©é˜µæ¥è¿›è¡Œè¡¨ç¤ºã€‚åœ¨çº¿æ€§ä»£æ•°ä¸­è¿™ç§çŸ©é˜µè¢«ç§°ä¸ºGramçŸ©é˜µï¼Œåœ¨è¿™é‡Œå¯ä»¥ç§°ä¹‹ä¸ºé£æ ¼çŸ©é˜µã€‚é£æ ¼çŸ©é˜µæ˜¯ä¸€ç»„å‘é‡çš„å†…ç§¯å¯¹ç§°çŸ©é˜µï¼Œæ¯”å¦‚å‘é‡ç»„çš„GramçŸ©é˜µæ˜¯å–å†…ç§¯å³æ¬§å‡ é‡Œå¾—ç©ºé—´ä¸Šçš„æ ‡å‡†å†…ç§¯ï¼Œå³ å‡è®¾å·ç§¯å±‚çš„è¾“å‡ºä¸ºF_ij^lï¼Œé‚£ä¹ˆè¿™ä¸ªå·ç§¯ç‰¹å¾å¯¹åº”çš„GramçŸ©é˜µçš„ç¬¬iè¡Œç¬¬jä¸ªå…ƒç´ å®šä¹‰ä¸ºè®¾åœ¨ç¬¬lå±‚ä¸­ï¼Œå·ç§¯ç‰¹å¾çš„é€šé“æ•°ä¸ºN_l,å·ç§¯çš„é«˜ã€å®½ä¹˜ç§¯æ•°ä¸ºM_l,é‚£ä¹ˆF_ij^læ»¡è¶³ lâ‰¤iâ‰¤N_lï¼Œlâ‰¤jâ‰¤M_lGramçŸ©é˜µåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥ä½“ç°å›¾ç‰‡çš„é£æ ¼ã€‚å¤šå±‚çš„é£æ ¼æŸå¤±æ˜¯å•å±‚é£æ ¼æŸå¤±çš„åŠ æƒç´¯åŠ ã€‚ 3.5 æ¨¡å‹è®­ç»ƒè¿‡ç¨‹é¦–å…ˆï¼Œä½¿ç”¨VGGä¸­çš„ä¸€äº›å±‚çš„è¾“å‡ºæ¥è¡¨ç¤ºå›¾ç‰‡çš„å†…å®¹ç‰¹å¾å’Œé£æ ¼ç‰¹å¾ã€‚ä½¿ç”¨[â€˜conv4_2â€™,â€™conv5_2â€™]è¡¨ç¤ºå†…å®¹ç‰¹å¾ï¼Œä½¿ç”¨[â€˜conv1_1â€™,â€™conv2_1â€™,â€™conv3_1â€™,â€™conv4_1â€™]è¡¨ç¤ºé£æ ¼ç‰¹å¾ã€‚å°†å†…å®¹å›¾ç‰‡è¾“å…¥ç½‘ç»œï¼Œè®¡ç®—å†…å®¹å›¾ç‰‡åœ¨ç½‘ç»œæŒ‡å®šå±‚ä¸Šçš„è¾“å‡ºå€¼ã€‚ è®¡ç®—å†…å®¹æŸå¤±ã€‚å¯ä»¥è¿™æ ·å®šä¹‰å†…å®¹æŸå¤±ï¼šå†…å®¹å›¾ç‰‡åœ¨æŒ‡å®šå±‚ä¸Šæå–å‡ºçš„ç‰¹å¾çŸ©é˜µï¼Œä¸å™ªå£°å›¾ç‰‡åœ¨å¯¹åº”å±‚ä¸Šçš„ç‰¹å¾çŸ©é˜µçš„å·®å€¼çš„L2èŒƒæ•°ã€‚å³æ±‚ä¸¤ä¸¤ä¹‹é—´çš„åƒç´ å·®å€¼çš„å¹³æ–¹ã€‚å¯¹åº”æ¯ä¸€å±‚çš„å†…å®¹æŸå¤±å‡½æ•°ï¼šå…¶ä¸­ï¼ŒXæ˜¯å™ªå£°å›¾ç‰‡çš„ç‰¹å¾çŸ©é˜µï¼ŒPæ˜¯å†…å®¹å›¾ç‰‡çš„ç‰¹å¾çŸ©é˜µã€‚Mæ˜¯Pçš„é•¿*å®½ï¼ŒNæ˜¯ä¿¡é“æ•°ã€‚æœ€ç»ˆçš„å†…å®¹æŸå¤±ä¸ºï¼Œæ¯ä¸€å±‚çš„å†…å®¹æŸå¤±åŠ æƒå’Œï¼Œå†å¯¹å±‚æ•°å–å¹³å‡ã€‚å°†é£æ ¼å›¾ç‰‡è¾“å…¥ç½‘ç»œï¼Œè®¡ç®—é£æ ¼å›¾ç‰‡åœ¨ç½‘ç»œæŒ‡å®šå±‚ä¸Šçš„è¾“å‡ºå€¼ã€‚ è®¡ç®—é£æ ¼æŸå¤±ã€‚ä½¿ç”¨é£æ ¼å›¾åƒåœ¨æŒ‡å®šå±‚ä¸Šçš„ç‰¹å¾çŸ©é˜µçš„GRAMçŸ©é˜µæ¥è¡¡é‡å…¶é£æ ¼ï¼Œé£æ ¼æŸå¤±å¯ä»¥å®šä¹‰ä¸ºé£æ ¼å›¾åƒå’Œå™ªéŸ³å›¾åƒç‰¹å¾çŸ©é˜µçš„æ ¼è±å§†çŸ©é˜µçš„å·®å€¼çš„L2èŒƒæ•°ã€‚ å¯¹äºæ¯ä¸€å±‚çš„é£æ ¼æŸå¤±å‡½æ•°ï¼šå…¶ä¸­Mæ˜¯ç‰¹å¾çŸ©é˜µçš„é•¿*å®½ï¼ŒNæ˜¯ç‰¹å¾çŸ©é˜µçš„ä¿¡é“æ•°ã€‚Gä¸ºå™ªéŸ³å›¾åƒç‰¹å¾çš„GramçŸ©é˜µï¼ŒAä¸ºé£æ ¼å›¾ç‰‡ç‰¹å¾çš„GRAMçŸ©é˜µã€‚æœ€ç»ˆçš„é£æ ¼æŸå¤±ä¸ºï¼Œæ¯ä¸€å±‚çš„é£æ ¼æŸå¤±åŠ æƒå’Œï¼Œå†å¯¹å±‚æ•°å–å¹³å‡ã€‚ å‡½æ•°ä¸ºå†…å®¹æŸå¤±å’Œé£æ ¼æŸå¤±çš„åŠ æƒå’Œï¼šå½“è®­ç»ƒå¼€å§‹æ—¶ï¼Œæ ¹æ®å†…å®¹å›¾ç‰‡å’Œå™ªå£°ï¼Œç”Ÿæˆä¸€å¼ å™ªå£°å›¾ç‰‡ã€‚å¹¶å°†å™ªå£°å›¾ç‰‡ä¼ é€ç»™ç½‘ç»œï¼Œè®¡ç®—lossï¼Œå†æ ¹æ®lossè°ƒæ•´å™ªå£°å›¾ç‰‡ã€‚å°†è°ƒæ•´åçš„å›¾ç‰‡å‘ç»™ç½‘ç»œï¼Œé‡æ–°è®¡ç®—lossï¼Œå†è°ƒæ•´ï¼Œå†è®¡ç®—ï¼Œç›´åˆ°è¾¾åˆ°æŒ‡å®šè¿­ä»£æ¬¡æ•°ï¼Œè¿™æ—¶ï¼Œå™ªå£°å›¾ç‰‡å·²å…¼å…·å†…å®¹å›¾ç‰‡çš„å†…å®¹å’Œé£æ ¼å›¾ç‰‡çš„é£æ ¼ï¼Œè¿›è¡Œä¿å­˜å³å¯ï¼Œå…¶è®­ç»ƒè¿‡ç¨‹å¦‚å›¾ä¸‹æ‰€ç¤ºï¼Œè®­ç»ƒé¡ºåºä¾æ¬¡ä»å·¦å‘å³ã€‚ åŸç†æ€»ç»“ï¼šæ„Ÿè°¢èƒ½ç¿»åˆ°è¿™çš„åŒå­¦ä»¬ï¼Œè¿™ä¸€ç¯‡åªæ˜¯ä¸ºäº†è®©å¤§å®¶äº†è§£åˆ°ä¸€äº›ç›¸å…³çŸ¥è¯†ï¼Œæ¯•ç«Ÿæ“ä½œç®€å•ï¼Œä¸»è¦çš„æ˜¯ç®—æ³•æ€æƒ³ã€‚ä¸‹ä¸€ç¯‡å°±æ˜¯ä¸ä»£ç ç›¸å…³çš„éƒ¨åˆ†äº†ï¼Œå¯ä»¥å¼€å§‹æ‰“å¼€å»ºçš„å·¥ç¨‹ï¼Œå†™ä»£ç äº†ï¼å·ç§¯ç¥ç»ç½‘ç»œï¼šï¼ˆä¸‰ï¼‰é£æ ¼è¿ç§»â€”â€”ä»£ç éƒ¨åˆ†","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://ailous.top/categories/äººå·¥æ™ºèƒ½/"}],"tags":[{"name":"å·ç§¯ç¥ç»ç½‘ç»œ","slug":"å·ç§¯ç¥ç»ç½‘ç»œ","permalink":"http://ailous.top/tags/å·ç§¯ç¥ç»ç½‘ç»œ/"},{"name":"é£æ ¼è¿ç§»","slug":"é£æ ¼è¿ç§»","permalink":"http://ailous.top/tags/é£æ ¼è¿ç§»/"}],"keywords":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://ailous.top/categories/äººå·¥æ™ºèƒ½/"}]},{"title":"é£æ ¼è¿ç§»â€”â€”ç¯å¢ƒé…ç½®","slug":"å·ç§¯ç¥ç»ç½‘ç»œï¼šï¼ˆä¸€ï¼‰é£æ ¼è¿ç§»â€”â€”ç¯å¢ƒé…ç½®","date":"2018-10-27T05:47:40.000Z","updated":"2020-05-26T23:35:38.374Z","comments":true,"path":"2018/10/27/juan-ji-shen-jing-wang-luo-yi-feng-ge-qian-yi-huan-jing-pei-zhi/","link":"","permalink":"http://ailous.top/2018/10/27/juan-ji-shen-jing-wang-luo-yi-feng-ge-qian-yi-huan-jing-pei-zhi/","excerpt":"","text":"å·ç§¯ç¥ç»ç½‘ç»œï¼šï¼ˆä¸€ï¼‰é£æ ¼è¿ç§»â€”â€”ç¯å¢ƒé…ç½®å¼•è¨€æœ¬æ–‡ä¸»è¦åœ¨windowsç¯å¢ƒä¸‹æ­å»ºpythonç¯å¢ƒï¼Œç”¨pythonä»é›¶å…¥æ‰‹æ­å»ºä¸€ä¸ªç®€å•çš„é£æ ¼è¿ç§»æ¨¡å‹ã€‚è‹¥ä¸ºmacosï¼Œlinuxå¯ä»¥å‚è€ƒå…¶ä»–åšå®¢æ­å»ºç¯å¢ƒï¼Œå†æ­å»ºè¯¥æ¨¡å‹ã€‚&nbsp;è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼šhttps://blog.csdn.net/weixin_41108515/article/details/103636284&nbsp; ç¬¬ä¸€æ­¥ï¼šæ­å»ºpythonç¯å¢ƒï¼šæ–¹æ³•ä¸€ : ç›´è£…pythonç¯å¢ƒï¼ˆåæœŸä¸»è¦ä½¿ç”¨è¿™ä¸€ç¯å¢ƒï¼Œæ–¹ä¾¿ä¸€äº›ä¸ç†Ÿæ‚‰anacondaçš„åŒå­¦ï¼‰ç›´æ¥ä½¿ç”¨ç”µè„‘é»˜è®¤ç¯å¢ƒï¼Œå³ç”µè„‘ç›´æ¥å®‰è£…pythonç¯å¢ƒï¼Œï¼ˆè¿™é‡Œæ¨èä½¿ç”¨python3.6ç‰ˆæœ¬ï¼Œ3.7åŠä»¥ä¸Šç‰ˆæœ¬ç›®å‰ä¸æ”¯æŒï¼‰ä¸‹è½½åœ°å€ï¼šhttps://www.python.org/ftp/python/3.6.8/python-3.6.8-amd64.exeå¦‚å›¾ç¤ºå®‰è£…install Nowå³å¯,æ³¨æ„æ·»åŠ pathä»¥åŠå®‰è£…è·¯å¾„ï¼ŒåæœŸä½¿ç”¨pycharmæ‰¾ç¼–è¯‘ç¯å¢ƒä¼šä½¿ç”¨åˆ°ã€‚æ³¨ï¼šé»˜è®¤è·¯å¾„C:\\users\\ç”¨æˆ·å\\Appdata\\local\\Programs\\Python\\Python36 ä¹Ÿå¯ä»¥ä½¿ç”¨Customize installationæ¥æ›´æ¢è·¯å¾„ã€‚å®‰è£…å®Œæˆåï¼Œè¿›å…¥cmdç•Œé¢ï¼Œè¾“å…¥pythonï¼Œå¦‚å›¾å‡ºç°æ­¤ç•Œé¢å³å¯ã€‚ æ–¹æ³•äºŒ ï¼šä½¿ç”¨anacondaæ­å»ºç¯å¢ƒ:å› ä¸ºanacondaå®˜æ–¹ç½‘ç«™ä¸‹ä¸‹è½½è¾ƒæ…¢ï¼Œè¿™é‡Œæ¨èä½¿ç”¨ æ¸…åé•œåƒæ¥ä¸‹è½½ã€‚æ¸…åé•œåƒä¸‹è½½åœ°å€https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-5.2.0-Windows-x86_64.exeå¦‚å›¾æ‰€ç¤ºå®‰è£…anacondaï¼Œè¿™é‡Œå…ˆç”¨çš„æ˜¯å®˜æ–¹3.7çš„åŒ…ï¼šæ³¨ï¼šanacondaå®˜æ–¹å½“å‰æœ€æ–°ç‰ˆä¸ºåŸºäºpython3.7versionï¼Œè¿™ä¸ªå¹¶ä¸æ„å‘³ç€æ­å»ºçš„pythonç¯å¢ƒç‰ˆæœ¬å°±å›ºå®šä¸º3.7ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æ˜¯ä¸æ¨èä½¿ç”¨ä¸‹é¢ä¼šè¯´æ˜åŸå› ã€‚æ³¨ï¼šå­˜åœ¨é—®é¢˜ï¼š1ã€ä¸‹è½½å¤ªæ…¢ã€‚2ã€3.7â€”versionéœ€é¢å¤–å¯¹ç¯å¢ƒæ›´æ”¹ï¼Œè¿™é‡Œåªå¯¹3.7ä»‹ç»å®‰è£…æ­¥éª¤ï¼Œä¸æä¾›ä¿®æ”¹ï¼Œæ¸…åé•œåƒæ— é—®é¢˜å®‰è£…æ­¥éª¤ç›¸åŒã€‚ å®‰è£…æ­¥éª¤ï¼š ç›®å½•è¿˜æ˜¯è‡ªå·±é€‰å–ä¹Ÿå¯ä»¥é»˜è®¤ï¼Œä½†æ˜¯å¿…é¡»è®°ä½ä¾¿äºåæœŸç¼–è¯‘ç¯å¢ƒé€‰æ‹©ã€‚è¿™é‡Œæ˜¯æŒ‡æ˜¯å¦å°†anacondaé‡Œçš„pythonä½œä¸ºç”µè„‘é»˜è®¤pythonç¯å¢ƒã€‚&emsp;&emsp;å®‰è£…å®Œæˆåï¼Œé€‰æ‹©Anaconda Navigator æ‰“å¼€ï¼Œæ¥ä¸‹æ¥é€‰æ‹©Environments -&gt;createï¼Œ:ç”Ÿæˆå¦‚ä¸‹ç•Œé¢ï¼šè¿™é‡Œæ˜¯3.7ç‰ˆæœ¬çš„é—®é¢˜ï¼Œåˆ›å»ºæ–°ç¯å¢ƒå¹¶ä¸ä¼šå‡ºç°å…¶ä»–pythonç‰ˆæœ¬ï¼Œè¿˜éœ€è¦é…ç½®å…¶ä»–ä¿¡æ¯ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œä½¿ç”¨æ¸…åé•œåƒå®‰è£…åå¦‚ä¸‹ï¼Œå³ä¸ºæ­£ç¡®å®Œæˆå®‰è£…ï¼šæ¥ä¸‹æ¥å¼€å§‹æ­å»ºç¯å¢ƒï¼Œç»™ç¯å¢ƒå£°æ˜ä¸€ä¸ªNameï¼Œè¿™é‡Œå«åštensorflowWorkã€‚packagesé€‰æ‹©python3.6ã€‚ ç¬¬ä¸€æ­¥ï¼Œæ€»ç»“anacondaé‡Œçš„é»˜è®¤rootå…¶å®å°±æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨çš„ï¼Œä½†æ˜¯ä¸ºäº†ä¾¿äºåé¢æ“ä½œè¿›è¡Œä»¥åŠä½¿ç”¨ç†è§£æ‰æ·»åŠ æ–°çš„ç¯å¢ƒã€‚æ— è®ºæ˜¯æ–¹æ³•ä¸€çš„å®‰è£…åœ¨é»˜è®¤ç¯å¢ƒä¸‹ï¼Œè¿˜æ˜¯æ–¹æ³•äºŒå®‰è£…åœ¨anacondaç¯å¢ƒä¸‹ï¼Œè¿™ä¸¤è€…å¹¶ä¸å†²çªï¼Œåªä¸è¿‡æ˜¯è¿è¡Œç¨‹åºæ—¶ï¼Œæ˜¯æƒ³ç”¨å“ªä¸€ä¸ªä½œä¸ºç¼–è¯‘ç¯å¢ƒç½¢äº†ã€‚å°±åƒä½ è¦åˆ°ä¸€ä¸ªåœ°æ–¹å»ï¼Œä¿®äº†ä¸¤æ¡è·¯ï¼Œè¿™ä¸¤æ¡è·¯éƒ½èƒ½åˆ°è¾¾ï¼Œä½ è¦è¿è¡Œè¿™ä¸ªç¨‹åºä½ å¯ä»¥èµ°è¿™æ¡è·¯ï¼Œä¹Ÿå¯ä»¥èµ°é‚£æ¡ï¼Œä»–ä»¬ç›¸äº’ç‹¬ç«‹å¹¶ä¸ä¼šç›¸äº’å½±å“ã€‚è€Œå¯¼åŒ…ç›¸å½“äºä½ æƒ³èµ°è¿™ä¸€æ¡è·¯ï¼Œä½†æ˜¯è¿™ä¸€æ¡è·¯æœ‰ç‚¹çª„ï¼Œä½ çš„ä»£ç èµ°ä¸è¿‡å»ï¼Œä¸ºäº†èƒ½å¤Ÿè®©ä½ çš„ä»£ç è¿‡å»ï¼Œä½ éœ€è¦ç»™è¿™ä¸ªè·¯æ‹“å®½ï¼Œè¿™ä¸ªåŒ…å°±æ˜¯æ‰©å®½çš„ææ–™ï¼Œå¯¹åº”çš„ä»£ç å¯¹åº”å¯¹åº”çš„åŒ…ã€‚&nbsp; ç¬¬äºŒæ­¥ï¼Œå®‰è£…pycharmè¿™ä¸ªåœ¨pycharmå®˜ç½‘ä¸Šä¸‹è½½å³å¯,å¦‚å›¾ç¤ºå®‰è£…å³å¯ã€‚ å®‰è£…å®Œæˆã€‚ ç¬¬ä¸‰æ­¥ï¼Œå®‰è£…å¿…éœ€åŒ…è¿™é‡Œå®‰è£…çš„æ˜¯tensorflowå’Œopencvï¼ŒpilåŒ…ï¼Œä¸ä¸€å®šå…¨éƒ¨ç”¨åˆ°ï¼Œå› ä¸ºè¿™é‡Œæ¨èçš„å‡ ä¸ªç¯å¢ƒå„æœ‰ä¸åŒï¼Œæ‰€ä»¥å…¨éƒ¨å®‰è£…ä¸Šï¼Œå…¶ä»–åŒ…é€šè¿‡pycharm ä¸­çš„ã€ALT+SHIFT+ENTERã€‘å³å¯å®‰è£…ï¼Œå¦‚è¿˜æœ‰ç¼ºå¤±è¯·è‡ªè¡Œç™¾åº¦ã€‚ æ–¹æ³•ä¸€ï¼šç›´è£…pythonç¯å¢ƒé»˜è®¤ç¯å¢ƒä¸‹åªéœ€è¿›å…¥cmdç•Œé¢ï¼Œè¾“å…¥å‘½ä»¤å³å¯ï¼Œè‹¥æ˜¯å®‰è£…ç›´è£…pythonç¯å¢ƒåˆå®‰è£…tensorflowçš„ï¼Œåˆ™éœ€è¿›å…¥cmdè¾“å…¥pythonï¼šè‹¥ä¸ºä¸‹å›¾ï¼šç¬¬äºŒè¡Œä¸­å‡ºç°anacondaã€‚åˆ™éœ€ä¿®æ”¹é»˜è®¤pythonç¯å¢ƒã€‚è‹¥ä¸ºä¸‹å›¾ï¼Œç¬¬äºŒè¡Œä¸­ä¸æ˜¯anacondaï¼Œåˆ™ç»§ç»­æ“ä½œå³å¯ã€‚ 3.1.1 å®‰è£…tensorflowåŒ…tensorflowå¯ä»¥åœ¨ç³»ç»ŸCPUå’ŒGPUä¸Šæ‰§è¡Œï¼ŒAVX2å’ŒCUDAä¸¤ç§ï¼Œè¿™é‡Œæ¨èåœ¨githubï¼šhttps://github.com/fo40225/tä¸ensorflow-windows-wheelä¸Šä¸‹è½½ï¼Œå¯¹äºä¸åŒç‰ˆæœ¬çš„pythonç¯å¢ƒæœ‰ä¸åŒçš„whlæ–‡ä»¶å¯ä»¥ä¸‹è½½ã€‚https://github.com/fo40225/tensorflow-windows-wheel/raw/master/1.4.0/py36/CPU/avx2/tensorflow-1.4.0-cp36-cp36m-win_amd64.whlä¸‹è½½å®Œæˆåï¼Œæ‰¾åˆ°ä¸‹è½½ä½ç½®ç‚¹å‡»ç•Œé¢ï¼ŒæŒ‰ä½shiftå³å‡»é¼ æ ‡å³é”®ï¼Œé€‰æ‹©åœ¨æ­¤å¤„æ‰“å¼€Powershellçª—å£ã€‚ è¾“å…¥ ï¼š pip install .\\tensorflow-1.4.0-cp36-cp36m-win_amd64.whl è¿è¡Œå®Œå³å¯ï¼Œè‹¥æ˜¯æç¤ºpipç‰ˆæœ¬æœ‰æ›´æ–°ï¼Œæ›´ä¸æ›´æ–°éƒ½å¯ã€‚ python -m pip install â€“upgrade pip 3.1.2 å®‰è£…opencvåŒ…opencvåœ¨ä»£ç ä¸­ä½¿ç”¨æ—¶ï¼šimport cv2opencvè¾ƒtensorflowç®€å•ï¼Œåªéœ€è¾“å…¥ä»£ç å³å¯è¿è¡Œï¼š pip install opencv-python 3.1.2 å®‰è£…PILï¼ˆPython Imaging Libraryï¼‰åŒ…PILå®‰è£…å¹¶ä¸æ˜¯é€šè¿‡ç›´æ¥é”®å…¥pip install PIL è€Œæ˜¯é€šè¿‡ï¼š pip install pillow æ–¹æ³•ä¸€æ€»ç»“ï¼šè¿™é‡Œä½¿ç”¨çš„Powershellçª—å£å’Œcmdç•Œé¢ä½¿ç”¨æ–¹æ³•ç›¸åŒï¼Œæ­¤å¤„å‘½ä»¤åœ¨cmdæ‰§è¡Œäº¦å¯ã€‚&nbsp; æ–¹æ³•äºŒï¼šanacondaç¯å¢ƒè¿™é‡Œä½¿ç”¨ä¹‹å‰ç¬¬ä¸€æ­¥åœ¨anacondaä¸‹æ­å»ºçš„Nameä¸ºtensorflowWorkç¯å¢ƒï¼Œè¿™ä¸‰è€…æ–¹æ³•ä¸€è‡´ï¼Œè¿™é‡Œåªä¸¾tensorflowçš„ä¾‹ï¼Œopencvå’ŒPILæ­¥éª¤ç›¸åŒã€‚ç‚¹å‡»ä¸Šæ–¹çš„é€‰æ‹©æ¡†è®¾ç½®ä¸ºallï¼Œç„¶åè¿›è¡Œæœç´¢tensorflwé€‰æ‹©tensorflowï¼Œç‚¹å‡»applyä¼šç”Ÿæˆä¸€ç³»åˆ—çš„åŒ…åï¼Œapplyå³å¯ã€‚éšåè¿›è¡Œå®‰è£…ï¼Œç­‰å¾…å®Œæˆã€‚å…¶ä½™å„åŒ…åŒæ ·æ“ä½œï¼Œè¿™é‡Œä¸èµ˜è¿°äº†ã€‚ ç¬¬å››æ­¥ï¼Œå»ºç«‹é£æ ¼è¿ç§»å·¥ç¨‹åœ¨pycharmä¸­é€‰æ‹©ï¼šfile-&gt;New project è¿™é‡Œè¦æ³¨æ„çš„æ˜¯Base interpreter ï¼Œä¸€èˆ¬é»˜è®¤çš„æ˜¯ç³»ç»Ÿä¸‹çš„é»˜è®¤pythonï¼Œå³ç›´è£…çš„æ–¹æ³•ä¸‹é»˜è®¤ä¸ºç›´è£…çš„é‚£ä¸€ä¸ªï¼Œè‹¥æ˜¯è£…äº†anacondaç¯å¢ƒåˆ™éœ€é€‰æ‹©é»˜è®¤ç¯å¢ƒï¼Œå°±æ˜¯ä¹‹å‰è¦é€‰æ‹©å¦ä¸€æ¡è·¯çš„é—®é¢˜ã€‚ æ–¹æ³•ä¸€ï¼šåœ¨åˆ›å»ºé¡¹ç›®æ˜¯ç›´æ¥é€‰æ‹©anacondaä¸‹çš„pythonï¼š æ–¹æ³•äºŒï¼šåœ¨é¡¹ç›®åˆ›å»ºå®Œæˆåå†é€‰æ‹©è·¯å¾„ä¸ºï¼šFile-&gt;Settings-&gt;projectï¼šé¡¹ç›®åï¼Œå¦‚å›¾ç‚¹å‡»é½¿è½®â€”â€”Addã€‚åœ¨Base interpreterä¸‹é€‰æ‹©anacondaä¸­pythonè·¯å¾„å³å¯ã€‚è‡³æ­¤æ‰€æœ‰ç¯å¢ƒé…ç½®å®Œæ¯•ã€‚ ç¬¬äº”æ­¥ï¼Œå†™é£æ ¼è¿ç§»ä»£ç è¿™é‡Œä¸»è¦å‚ç½‘å€çš„ä¸ºhttp://zh.gluon.ai/chapter_computer-vision/neural-style.htmlä¼šåœ¨ä¸‹ä¸€ç¯‡åšå®¢https://blog.csdn.net/weixin_41108515/article/details/103650964é‡Œè¯¦ç»†è§£é‡Šè¿‡ç¨‹ã€‚","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://ailous.top/categories/äººå·¥æ™ºèƒ½/"}],"tags":[{"name":"å·ç§¯ç¥ç»ç½‘ç»œ","slug":"å·ç§¯ç¥ç»ç½‘ç»œ","permalink":"http://ailous.top/tags/å·ç§¯ç¥ç»ç½‘ç»œ/"},{"name":"é£æ ¼è¿ç§»","slug":"é£æ ¼è¿ç§»","permalink":"http://ailous.top/tags/é£æ ¼è¿ç§»/"}],"keywords":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://ailous.top/categories/äººå·¥æ™ºèƒ½/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”è±†ç“£è¯»ä¹¦æ•°æ®æŠ“å–â€”â€”REï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰","slug":"ç½‘ç»œçˆ¬è™«â€”â€”è±†ç“£è¯»ä¹¦æ•°æ®æŠ“å–â€”â€”REï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰","date":"2018-06-09T05:47:40.000Z","updated":"2020-05-27T07:45:07.822Z","comments":true,"path":"2018/06/09/wang-luo-pa-chong-dou-ban-du-shu-shu-ju-zhua-qu-re-zheng-ze-biao-da-shi/","link":"","permalink":"http://ailous.top/2018/06/09/wang-luo-pa-chong-dou-ban-du-shu-shu-ju-zhua-qu-re-zheng-ze-biao-da-shi/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”è±†ç“£è¯»ä¹¦æ•°æ®æŠ“å–â€”â€”REï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰ç›®æ ‡ç½‘å€ï¼šhttps://book.douban.com/ ç›®æ ‡æ•°æ®ï¼šï¼ˆ1ï¼‰ä¹¦åï¼ˆ2ï¼‰ä¹¦çš„é“¾æ¥åœ°å€ï¼ˆ3ï¼‰ä½œè€…ï¼ˆ4ï¼‰å‘è¡Œæ—¶é—´ï¼ˆ5ï¼‰å‡ºç‰ˆç¤¾åˆ†æç½‘é¡µç»“æ„ï¼Œé€šè¿‡è·å–ç½‘é¡µæºä»£ç ï¼Œä½¿ç”¨reåº“è§£æç½‘é¡µç»“æ„ï¼Œå®Œæˆè±†ç“£è¯»ä¹¦é¡¹ç›®ä¸­ç›®æ ‡æ•°æ®çš„çˆ¬å–ã€‚ æºç import requests import re def getcode(url): url = url headers = { 'User-Agent':'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.25 Safari/537.36 Core/1.70.3756.400 QQBrowser/10.5.4039.400' } response = requests.get(url,headers=headers) response.encoding = 'utf_8' code = response.text return code def parse_page(code): ulist = [] pattern = re.compile('.*?.*?(.*?).*?(.*?).*?(.*?)',re.S) items = re.findall(pattern,code) # print(items) for item in items: ulist.append([item[1],item[0].strip(),item[2].strip(),item[3].strip(),item[4].strip()]) return (ulist) def main(): ulist = [] url = \"https://book.douban.com/\" code = getcode(url) ulist = parse_page(code) print(len(ulist)) print() for i in range(len(ulist)): print(ulist[i]) main() è¾“å‡ºå¦‚ä¸‹ï¼š","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"REï¼ˆæ­£åˆ™è¡¨è¾¾å¼","slug":"REï¼ˆæ­£åˆ™è¡¨è¾¾å¼","permalink":"http://ailous.top/tags/REï¼ˆæ­£åˆ™è¡¨è¾¾å¼/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]},{"title":"ç½‘ç»œçˆ¬è™«â€”â€”çŒ«çœ¼ç”µå½±æ•°æ®æŠ“å–â€”â€”REï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰","slug":"ç½‘ç»œçˆ¬è™«â€”â€”çŒ«çœ¼ç”µå½±æ•°æ®æŠ“å–â€”â€”REï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰","date":"2018-05-29T05:47:40.000Z","updated":"2020-05-27T07:44:42.861Z","comments":true,"path":"2018/05/29/wang-luo-pa-chong-mao-yan-dian-ying-shu-ju-zhua-qu-re-zheng-ze-biao-da-shi/","link":"","permalink":"http://ailous.top/2018/05/29/wang-luo-pa-chong-mao-yan-dian-ying-shu-ju-zhua-qu-re-zheng-ze-biao-da-shi/","excerpt":"","text":"ç½‘ç»œçˆ¬è™«â€”â€”çŒ«çœ¼ç”µå½±æ•°æ®æŠ“å–â€”â€”REï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰çŒ«çœ¼ç”µå½±æ¦œå•ç½‘å€ï¼šhttps://maoyan.com/board/4 ç›®æ ‡æ•°æ®æè¿°ï¼šï¼ˆ1ï¼‰æ’å ï¼ˆ2ï¼‰ç”µå½±åç§° ï¼ˆ3ï¼‰ä¸»æ¼” ï¼ˆ4ï¼‰ä¸Šæ˜ æ—¶é—´ ï¼ˆ5ï¼‰è¯„åˆ†ä»»åŠ¡è¦æ±‚ ï¼ˆ1ï¼‰ä½¿ç”¨requestsåº“å®ç°è¯¥ç½‘ç«™ç½‘é¡µæºä»£ç çš„è·å–ï¼› ï¼ˆ2ï¼‰ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯¹è·å–çš„æºä»£ç è¿›è¡Œè§£æï¼Œå¹¶æˆåŠŸæ‰¾åˆ°ç›®æ ‡æ•°æ®æ‰€åœ¨çš„ç‰¹å®šæ ‡ç­¾ï¼Œè¿›è¡Œç½‘é¡µç»“æ„çš„è§£æï¼› ï¼ˆ3ï¼‰å®šä¹‰å‡½æ•°ï¼Œå°†è·å–çš„ç›®æ ‡æ•°æ®æ‰“å°è¾“å‡ºï¼Œæœ‰èƒ½åŠ›çš„åŒå­¦å¯ä»¥è¯•ç€å°†ç»“æœå†™å…¥æ–‡ä»¶ä¸­ã€‚ ï¼ˆ4ï¼‰ä½¿ç”¨æ¡†æ¶å¼ç»“æ„ï¼Œé€šè¿‡å‚æ•°ä¼ é€’å®ç°æ•´ä¸ªç‰¹å®šæ•°æ®çš„çˆ¬å–ã€‚ å¯ä»¥ä½¿ç”¨ç”Ÿæˆå™¨ï¼Œå°†ç›®æ ‡æ•°æ®è·å–åæ”¾åˆ°å­—å…¸ä¸­è¿”å›ï¼ŒåŒæ—¶ï¼Œæ³¨æ„è§‚å¯Ÿåˆ†é¡µæ—¶urlçš„å˜åŒ–ï¼Œä»¥ä¾¿è·å–æ•´ä¸ªçš„æ’è¡Œæ¦œæ•°æ®ã€‚å»ºè®®é€šè¿‡forå¾ªç¯ä¼ é€’å˜åŒ–å‚æ•°å®ç°ã€‚ æºç import json import requests from requests.exceptions import RequestException import re import time def get_one_page(url): try: headers={'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36'} response=requests.get(\"https://maoyan.com/board/4\",headers = headers) if response.status_code == 200: return response.text return None except RequestException: return None def parse_one_page(html): pattern= re.compile('.*?board-index.*?>(\\d+).*?data-src=\"(.*?)\".*?name\">(.*?).*?star\">(.*?).*?releasetime\">(.*?)' + '.*?integer\">(.*?).*?fraction\">(.*?).*?',re.S) items = re.findall(pattern,html) for item in items: yield{ 'index': item[0], 'image': item[1], 'title': item[2], 'actor': item[3].strip()[3:], 'time': item[4].strip()[5:], 'score': item[5] + item[6] } def write_to_file(content): with open('result.txt', 'a' , encoding='utf-8') as f: f.write(json.dumps(content, ensure_ascii=False) + '\\n') def main(offset): url = 'https://maoyan.com/board/4' html=get_one_page(url) for item in parse_one_page(html): print(item) write_to_file(item) if __name__ == '__main__': for i in range(10): main(offset=i * 10) time.sleep(1) è¾“å‡ºå¦‚ä¸‹","categories":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}],"tags":[{"name":"REï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰","slug":"REï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰","permalink":"http://ailous.top/tags/REï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰/"}],"keywords":[{"name":"ç½‘ç»œçˆ¬è™«","slug":"ç½‘ç»œçˆ¬è™«","permalink":"http://ailous.top/categories/ç½‘ç»œçˆ¬è™«/"}]}]}